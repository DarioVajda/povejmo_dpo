Running translations for model 1: cjvt/GaMS-9B-Instruct
Translate file: /ceph/hpc/data/s24o01-42-users/translation_optimization/get_translations/translate_generic.py
cpu-bind=MASK - ixh, task  0  0 [2248042]: mask 0x30000000000000000000000000003 set
Collecting vllm==0.9.2
  Downloading vllm-0.9.2-cp38-abi3-manylinux1_x86_64.whl.metadata (15 kB)
Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2024.11.6)
Requirement already satisfied: cachetools in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (6.1.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (7.0.0)
Requirement already satisfied: sentencepiece in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.2.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.26.4)
Requirement already satisfied: requests>=2.26.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.32.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.67.1)
Requirement already satisfied: blake3 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.0.5)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (9.0.0)
Requirement already satisfied: transformers>=4.51.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.52.4)
Requirement already satisfied: huggingface-hub>=0.33.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub[hf_xet]>=0.33.0->vllm==0.9.2) (0.33.0)
Requirement already satisfied: tokenizers>=0.21.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.21.1)
Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (5.29.5)
Requirement already satisfied: fastapi>=0.115.0 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (0.115.12)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.12.13)
Requirement already satisfied: openai<=1.90.0,>=1.52.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.88.0)
Requirement already satisfied: pydantic>=2.10 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.11.7)
Requirement already satisfied: prometheus_client>=0.18.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.22.1)
Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (11.2.1)
Requirement already satisfied: prometheus-fastapi-instrumentator>=7.0.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (7.1.0)
Requirement already satisfied: tiktoken>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.9.0)
Requirement already satisfied: lm-format-enforcer<0.11,>=0.10.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.10.11)
Requirement already satisfied: llguidance<0.8.0,>=0.7.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.7.29)
Requirement already satisfied: outlines==0.1.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.1.11)
Requirement already satisfied: lark==1.2.2 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.2.2)
Requirement already satisfied: xgrammar==0.1.19 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.1.19)
Requirement already satisfied: typing_extensions>=4.10 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.14.0)
Requirement already satisfied: filelock>=3.16.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.18.0)
Requirement already satisfied: partial-json-parser in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.2.1.1.post5)
Requirement already satisfied: pyzmq>=25.0.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (27.0.0)
Requirement already satisfied: msgspec in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.19.0)
Requirement already satisfied: gguf>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.17.0)
Requirement already satisfied: mistral_common>=1.6.2 in /usr/local/lib/python3.10/dist-packages (from mistral_common[opencv]>=1.6.2->vllm==0.9.2) (1.6.2)
Requirement already satisfied: opencv-python-headless>=4.11.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.11.0.86)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (6.0.2)
Requirement already satisfied: einops in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.8.1)
Collecting compressed-tensors==0.10.2 (from vllm==0.9.2)
  Downloading compressed_tensors-0.10.2-py3-none-any.whl.metadata (7.0 kB)
Requirement already satisfied: depyf==0.18.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.18.0)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.1.1)
Requirement already satisfied: watchfiles in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.1.0)
Requirement already satisfied: python-json-logger in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.3.0)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.15.3)
Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.11.1.4)
Collecting pybase64 (from vllm==0.9.2)
  Downloading pybase64-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.4 kB)
Requirement already satisfied: numba==0.61.2 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.61.2)
Requirement already satisfied: ray!=2.44.*,>=2.43.0 in /usr/local/lib/python3.10/dist-packages (from ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (2.47.0)
Requirement already satisfied: torch==2.7.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.7.0)
Requirement already satisfied: torchaudio==2.7.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.7.0)
Requirement already satisfied: torchvision==0.22.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.22.0)
Requirement already satisfied: xformers==0.0.30 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.0.30)
Requirement already satisfied: astor in /usr/local/lib/python3.10/dist-packages (from depyf==0.18.0->vllm==0.9.2) (0.8.1)
Requirement already satisfied: dill in /usr/local/lib/python3.10/dist-packages (from depyf==0.18.0->vllm==0.9.2) (0.3.4)
Requirement already satisfied: llvmlite<0.45,>=0.44.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba==0.61.2->vllm==0.9.2) (0.44.0)
Requirement already satisfied: interegular in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (3.1.6)
Requirement already satisfied: nest_asyncio in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (1.6.0)
Requirement already satisfied: diskcache in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (5.6.3)
Requirement already satisfied: referencing in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.36.2)
Requirement already satisfied: jsonschema in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (4.24.0)
Requirement already satisfied: pycountry in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (24.6.1)
Requirement already satisfied: airportsdata in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (20250523)
Requirement already satisfied: outlines_core==0.1.26 in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.1.26)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (1.14.0)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (3.4.2)
Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (2025.3.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.6.80 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.80)
Requirement already satisfied: nvidia-cudnn-cu12==9.5.1.17 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (9.5.1.17)
Requirement already satisfied: nvidia-cublas-cu12==12.6.4.1 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.0.4 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (11.3.0.4)
Requirement already satisfied: nvidia-curand-cu12==10.3.7.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (10.3.7.77)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.1.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (11.7.1.2)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.4.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.5.4.2)
Requirement already satisfied: nvidia-cusparselt-cu12==0.6.3 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (0.6.3)
Requirement already satisfied: nvidia-nccl-cu12==2.26.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (2.26.2)
Requirement already satisfied: nvidia-nvtx-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.6.85 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.85)
Requirement already satisfied: nvidia-cufile-cu12==1.11.1.6 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (1.11.1.6)
Requirement already satisfied: triton==3.3.0 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (3.3.0)
Requirement already satisfied: setuptools>=40.8.0 in /usr/lib/python3/dist-packages (from triton==3.3.0->torch==2.7.0->vllm==0.9.2) (59.6.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from lm-format-enforcer<0.11,>=0.10.11->vllm==0.9.2) (25.0)
Requirement already satisfied: anyio<5,>=3.5.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (4.9.0)
Requirement already satisfied: distro<2,>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.9.0)
Requirement already satisfied: httpx<1,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.27.2)
Requirement already satisfied: jiter<1,>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.10.0)
Requirement already satisfied: sniffio in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.3.1)
Requirement already satisfied: exceptiongroup>=1.0.2 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.3.0)
Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (3.10)
Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (2025.6.15)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.10/dist-packages (from httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.0.9)
Requirement already satisfied: h11>=0.16 in /usr/local/lib/python3.10/dist-packages (from httpcore==1.*->httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.16.0)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (0.4.1)
Requirement already satisfied: starlette<0.47.0,>=0.40.0 in /usr/local/lib/python3.10/dist-packages (from fastapi>=0.115.0->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.46.2)
Requirement already satisfied: fastapi-cli>=0.0.5 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.0.7)
Requirement already satisfied: python-multipart>=0.0.18 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (0.0.20)
Requirement already satisfied: email-validator>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (2.2.0)
Requirement already satisfied: uvicorn>=0.12.0 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.34.3)
Requirement already satisfied: dnspython>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from email-validator>=2.0.0->fastapi[standard]>=0.115.0->vllm==0.9.2) (2.7.0)
Requirement already satisfied: typer>=0.12.3 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.16.0)
Requirement already satisfied: rich-toolkit>=0.11.1 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.14.7)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.33.0->huggingface-hub[hf_xet]>=0.33.0->vllm==0.9.2) (1.1.4)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->outlines==0.1.11->vllm==0.9.2) (3.0.2)
Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (25.3.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (2025.4.1)
Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (0.25.1)
Requirement already satisfied: click>=7.0 in /usr/local/lib/python3.10/dist-packages (from ray!=2.44.*,>=2.43.0->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (8.2.1)
Requirement already satisfied: msgpack<2.0.0,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ray!=2.44.*,>=2.43.0->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (1.1.1)
Requirement already satisfied: cupy-cuda12x in /usr/local/lib/python3.10/dist-packages (from ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (13.4.1)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26.0->vllm==0.9.2) (3.4.2)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26.0->vllm==0.9.2) (1.26.20)
Requirement already satisfied: rich>=13.7.1 in /usr/local/lib/python3.10/dist-packages (from rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (14.0.0)
Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (2.19.1)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py>=2.2.0->rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.1.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy>=1.13.3->torch==2.7.0->vllm==0.9.2) (1.3.0)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from transformers>=4.51.1->vllm==0.9.2) (0.5.3)
Requirement already satisfied: shellingham>=1.3.0 in /usr/local/lib/python3.10/dist-packages (from typer>=0.12.3->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (1.5.4)
Requirement already satisfied: httptools>=0.6.3 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.6.4)
Requirement already satisfied: python-dotenv>=0.13 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (1.1.0)
Requirement already satisfied: uvloop>=0.15.1 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.21.0)
Requirement already satisfied: websockets>=10.4 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (15.0.1)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (2.6.1)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.3.2)
Requirement already satisfied: async-timeout<6.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (5.0.1)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (6.4.4)
Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.20.1)
Requirement already satisfied: fastrlock>=0.5 in /usr/local/lib/python3.10/dist-packages (from cupy-cuda12x->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (0.8.3)
Downloading vllm-0.9.2-cp38-abi3-manylinux1_x86_64.whl (383.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 383.4/383.4 MB 78.6 MB/s eta 0:00:00
Downloading compressed_tensors-0.10.2-py3-none-any.whl (169 kB)
Downloading pybase64-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (68 kB)
Installing collected packages: pybase64, compressed-tensors, vllm
  Attempting uninstall: compressed-tensors
    Found existing installation: compressed-tensors 0.10.1
    Uninstalling compressed-tensors-0.10.1:
      Successfully uninstalled compressed-tensors-0.10.1
  Attempting uninstall: vllm
    Found existing installation: vllm 0.9.1
    Uninstalling vllm-0.9.1:
      Successfully uninstalled vllm-0.9.1

Successfully installed compressed-tensors-0.10.2 pybase64-1.4.1 vllm-0.9.2
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
INFO 07-16 16:11:47 [__init__.py:244] Automatically detected platform cuda.
Loading data ...
Selecting examples ...
Number of examples: 100
Using GaMSTaskAdapter for model: cjvt/GaMS-9B-Instruct
Using Hugging Face model ID: cjvt/GaMS-9B-Instruct
INFO 07-16 16:11:59 [config.py:841] This model supports multiple tasks: {'classify', 'reward', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 07-16 16:11:59 [config.py:1472] Using max model len 8192
INFO 07-16 16:11:59 [config.py:2285] Chunked prefill is enabled with max_num_batched_tokens=16384.
The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
INFO 07-16 16:12:01 [core.py:526] Waiting for init message from front-end.
INFO 07-16 16:12:01 [core.py:69] Initializing a V1 LLM engine (v0.9.2) with config: model='cjvt/GaMS-9B-Instruct', speculative_config=None, tokenizer='cjvt/GaMS-9B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=42, served_model_name=cjvt/GaMS-9B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":512,"local_cache_dir":null}
INFO 07-16 16:12:02 [parallel_state.py:1076] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
WARNING 07-16 16:12:02 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
INFO 07-16 16:12:02 [gpu_model_runner.py:1770] Starting to load model cjvt/GaMS-9B-Instruct...
INFO 07-16 16:12:03 [gpu_model_runner.py:1775] Loading model from scratch...
INFO 07-16 16:12:03 [cuda.py:284] Using Flash Attention backend on V1 engine.
INFO 07-16 16:12:04 [weight_utils.py:292] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:02<00:06,  2.30s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:05<00:05,  2.70s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:08<00:02,  2.84s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.88s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.81s/it]

INFO 07-16 16:12:15 [default_loader.py:272] Loading weights took 11.34 seconds
INFO 07-16 16:12:16 [gpu_model_runner.py:1801] Model loading took 17.2181 GiB and 12.489339 seconds
INFO 07-16 16:12:24 [backends.py:506] vLLM's torch.compile cache is disabled.
INFO 07-16 16:12:24 [backends.py:519] Dynamo bytecode transform time: 8.15 s
INFO 07-16 16:12:26 [backends.py:181] Cache the graph of shape None for later use
INFO 07-16 16:12:54 [backends.py:193] Compiling a graph for general shape takes 30.08 s
INFO 07-16 16:13:14 [monitor.py:34] torch.compile takes 38.22 s in total
INFO 07-16 16:13:15 [gpu_worker.py:232] Available KV cache memory: 44.45 GiB
INFO 07-16 16:13:15 [kv_cache_utils.py:873] GPU KV cache size: 138,720 tokens
INFO 07-16 16:13:15 [kv_cache_utils.py:877] Maximum concurrency for 8,192 tokens per request: 16.92x
Capturing CUDA graph shapes:   0%|          | 0/67 [00:00<?, ?it/s]Capturing CUDA graph shapes:   1%|▏         | 1/67 [00:00<00:31,  2.11it/s]Capturing CUDA graph shapes:   3%|▎         | 2/67 [00:00<00:30,  2.12it/s]Capturing CUDA graph shapes:   4%|▍         | 3/67 [00:01<00:30,  2.13it/s]Capturing CUDA graph shapes:   6%|▌         | 4/67 [00:01<00:29,  2.11it/s]Capturing CUDA graph shapes:   7%|▋         | 5/67 [00:02<00:29,  2.14it/s]Capturing CUDA graph shapes:   9%|▉         | 6/67 [00:02<00:28,  2.12it/s]Capturing CUDA graph shapes:  10%|█         | 7/67 [00:03<00:28,  2.14it/s]Capturing CUDA graph shapes:  12%|█▏        | 8/67 [00:03<00:27,  2.12it/s]Capturing CUDA graph shapes:  13%|█▎        | 9/67 [00:04<00:27,  2.09it/s]Capturing CUDA graph shapes:  15%|█▍        | 10/67 [00:04<00:27,  2.08it/s]Capturing CUDA graph shapes:  16%|█▋        | 11/67 [00:05<00:27,  2.07it/s]Capturing CUDA graph shapes:  18%|█▊        | 12/67 [00:05<00:26,  2.08it/s]Capturing CUDA graph shapes:  19%|█▉        | 13/67 [00:06<00:26,  2.06it/s]Capturing CUDA graph shapes:  21%|██        | 14/67 [00:06<00:25,  2.05it/s]Capturing CUDA graph shapes:  22%|██▏       | 15/67 [00:07<00:25,  2.06it/s]Capturing CUDA graph shapes:  24%|██▍       | 16/67 [00:07<00:24,  2.06it/s]Capturing CUDA graph shapes:  25%|██▌       | 17/67 [00:08<00:24,  2.06it/s]Capturing CUDA graph shapes:  27%|██▋       | 18/67 [00:08<00:24,  1.98it/s]Capturing CUDA graph shapes:  28%|██▊       | 19/67 [00:09<00:24,  1.95it/s]Capturing CUDA graph shapes:  30%|██▉       | 20/67 [00:09<00:23,  1.98it/s]Capturing CUDA graph shapes:  31%|███▏      | 21/67 [00:10<00:22,  2.01it/s]Capturing CUDA graph shapes:  33%|███▎      | 22/67 [00:10<00:22,  2.01it/s]Capturing CUDA graph shapes:  34%|███▍      | 23/67 [00:11<00:21,  2.01it/s]Capturing CUDA graph shapes:  36%|███▌      | 24/67 [00:11<00:21,  2.03it/s]Capturing CUDA graph shapes:  37%|███▋      | 25/67 [00:12<00:20,  2.03it/s]Capturing CUDA graph shapes:  39%|███▉      | 26/67 [00:12<00:20,  2.01it/s]Capturing CUDA graph shapes:  40%|████      | 27/67 [00:13<00:19,  2.02it/s]Capturing CUDA graph shapes:  42%|████▏     | 28/67 [00:13<00:19,  2.04it/s]Capturing CUDA graph shapes:  43%|████▎     | 29/67 [00:14<00:18,  2.03it/s]Capturing CUDA graph shapes:  45%|████▍     | 30/67 [00:14<00:18,  2.03it/s]Capturing CUDA graph shapes:  46%|████▋     | 31/67 [00:15<00:17,  2.03it/s]Capturing CUDA graph shapes:  48%|████▊     | 32/67 [00:15<00:17,  2.06it/s]Capturing CUDA graph shapes:  49%|████▉     | 33/67 [00:16<00:16,  2.06it/s]Capturing CUDA graph shapes:  51%|█████     | 34/67 [00:16<00:16,  2.03it/s]Capturing CUDA graph shapes:  52%|█████▏    | 35/67 [00:17<00:15,  2.03it/s]Capturing CUDA graph shapes:  54%|█████▎    | 36/67 [00:17<00:15,  2.04it/s]Capturing CUDA graph shapes:  55%|█████▌    | 37/67 [00:18<00:14,  2.04it/s]Capturing CUDA graph shapes:  57%|█████▋    | 38/67 [00:18<00:14,  2.04it/s]Capturing CUDA graph shapes:  58%|█████▊    | 39/67 [00:19<00:13,  2.05it/s]Capturing CUDA graph shapes:  60%|█████▉    | 40/67 [00:19<00:13,  2.05it/s]Capturing CUDA graph shapes:  61%|██████    | 41/67 [00:20<00:12,  2.02it/s]Capturing CUDA graph shapes:  63%|██████▎   | 42/67 [00:20<00:12,  2.03it/s]Capturing CUDA graph shapes:  64%|██████▍   | 43/67 [00:20<00:11,  2.04it/s]Capturing CUDA graph shapes:  66%|██████▌   | 44/67 [00:21<00:11,  2.05it/s]Capturing CUDA graph shapes:  67%|██████▋   | 45/67 [00:21<00:10,  2.05it/s]Capturing CUDA graph shapes:  69%|██████▊   | 46/67 [00:22<00:10,  2.05it/s]Capturing CUDA graph shapes:  70%|███████   | 47/67 [00:22<00:09,  2.05it/s]Capturing CUDA graph shapes:  72%|███████▏  | 48/67 [00:23<00:09,  2.04it/s]Capturing CUDA graph shapes:  73%|███████▎  | 49/67 [00:23<00:08,  2.04it/s]Capturing CUDA graph shapes:  75%|███████▍  | 50/67 [00:24<00:08,  2.04it/s]Capturing CUDA graph shapes:  76%|███████▌  | 51/67 [00:24<00:07,  2.01it/s]Capturing CUDA graph shapes:  78%|███████▊  | 52/67 [00:25<00:07,  2.02it/s]Capturing CUDA graph shapes:  79%|███████▉  | 53/67 [00:25<00:06,  2.02it/s]Capturing CUDA graph shapes:  81%|████████  | 54/67 [00:26<00:06,  2.02it/s]Capturing CUDA graph shapes:  82%|████████▏ | 55/67 [00:26<00:06,  2.00it/s]Capturing CUDA graph shapes:  84%|████████▎ | 56/67 [00:27<00:05,  2.01it/s]Capturing CUDA graph shapes:  85%|████████▌ | 57/67 [00:27<00:04,  2.01it/s]Capturing CUDA graph shapes:  87%|████████▋ | 58/67 [00:28<00:04,  2.01it/s]Capturing CUDA graph shapes:  88%|████████▊ | 59/67 [00:28<00:04,  1.92it/s]Capturing CUDA graph shapes:  90%|████████▉ | 60/67 [00:29<00:03,  1.94it/s]Capturing CUDA graph shapes:  91%|█████████ | 61/67 [00:29<00:03,  1.96it/s]Capturing CUDA graph shapes:  93%|█████████▎| 62/67 [00:30<00:02,  1.98it/s]Capturing CUDA graph shapes:  94%|█████████▍| 63/67 [00:30<00:02,  1.99it/s]Capturing CUDA graph shapes:  96%|█████████▌| 64/67 [00:31<00:01,  2.01it/s]Capturing CUDA graph shapes:  97%|█████████▋| 65/67 [00:31<00:00,  2.02it/s]Capturing CUDA graph shapes:  99%|█████████▊| 66/67 [00:32<00:00,  2.03it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:32<00:00,  2.04it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:32<00:00,  2.03it/s]
INFO 07-16 16:13:48 [gpu_model_runner.py:2326] Graph capturing finished in 33 secs, took 0.80 GiB
INFO 07-16 16:13:48 [core.py:172] init engine (profile, create kv cache, warmup model) took 92.74 seconds
Preparing prompts ...
Map (num_proc=8):   0%|          | 0/100 [00:00<?, ? examples/s]Map (num_proc=8):  13%|█▎        | 13/100 [00:02<00:16,  5.31 examples/s]Map (num_proc=8):  26%|██▌       | 26/100 [00:03<00:08,  9.11 examples/s]Map (num_proc=8):  39%|███▉      | 39/100 [00:03<00:04, 12.40 examples/s]Map (num_proc=8):  50%|█████     | 50/100 [00:04<00:03, 13.42 examples/s]Map (num_proc=8):  64%|██████▍   | 64/100 [00:04<00:01, 19.57 examples/s]Map (num_proc=8):  76%|███████▌  | 76/100 [00:05<00:01, 21.04 examples/s]Map (num_proc=8):  88%|████████▊ | 88/100 [00:06<00:00, 17.94 examples/s]Map (num_proc=8): 100%|██████████| 100/100 [00:06<00:00, 21.66 examples/s]Map (num_proc=8): 100%|██████████| 100/100 [00:06<00:00, 15.60 examples/s]
Filter (num_proc=8):   0%|          | 0/100 [00:00<?, ? examples/s]Filter (num_proc=8):  39%|███▉      | 39/100 [00:00<00:00, 138.75 examples/s]Filter (num_proc=8): 100%|██████████| 100/100 [00:00<00:00, 257.46 examples/s]
Number of prompts: 95
Running translations ...
Adding requests:   0%|          | 0/95 [00:00<?, ?it/s]Adding requests:  81%|████████  | 77/95 [00:00<00:00, 767.84it/s]Adding requests: 100%|██████████| 95/95 [00:00<00:00, 799.32it/s]
Processed prompts:   0%|          | 0/95 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/95 [00:02<03:42,  2.37s/it, est. speed input: 760.88 toks/s, output: 18.15 toks/s]Processed prompts:   2%|▏         | 2/95 [00:02<01:42,  1.10s/it, est. speed input: 725.17 toks/s, output: 37.23 toks/s]Processed prompts:   3%|▎         | 3/95 [00:02<00:59,  1.55it/s, est. speed input: 724.21 toks/s, output: 58.49 toks/s]Processed prompts:   6%|▋         | 6/95 [00:02<00:24,  3.59it/s, est. speed input: 739.87 toks/s, output: 119.37 toks/s]Processed prompts:   8%|▊         | 8/95 [00:03<00:19,  4.47it/s, est. speed input: 731.39 toks/s, output: 159.09 toks/s]Processed prompts:   9%|▉         | 9/95 [00:03<00:18,  4.71it/s, est. speed input: 719.48 toks/s, output: 178.40 toks/s]Processed prompts:  12%|█▏        | 11/95 [00:03<00:13,  6.42it/s, est. speed input: 751.60 toks/s, output: 226.55 toks/s]Processed prompts:  14%|█▎        | 13/95 [00:03<00:10,  8.09it/s, est. speed input: 778.11 toks/s, output: 275.12 toks/s]Processed prompts:  17%|█▋        | 16/95 [00:03<00:07, 10.97it/s, est. speed input: 842.03 toks/s, output: 350.85 toks/s]Processed prompts:  19%|█▉        | 18/95 [00:03<00:06, 12.58it/s, est. speed input: 881.44 toks/s, output: 400.54 toks/s]Processed prompts:  21%|██        | 20/95 [00:04<00:06, 10.81it/s, est. speed input: 905.40 toks/s, output: 436.09 toks/s]Processed prompts:  23%|██▎       | 22/95 [00:04<00:06, 11.96it/s, est. speed input: 940.48 toks/s, output: 486.24 toks/s]Processed prompts:  26%|██▋       | 25/95 [00:04<00:04, 14.81it/s, est. speed input: 1002.74 toks/s, output: 566.96 toks/s]Processed prompts:  28%|██▊       | 27/95 [00:04<00:05, 12.91it/s, est. speed input: 1018.05 toks/s, output: 605.89 toks/s]Processed prompts:  31%|███       | 29/95 [00:04<00:05, 11.41it/s, est. speed input: 1024.76 toks/s, output: 642.36 toks/s]Processed prompts:  33%|███▎      | 31/95 [00:05<00:05, 10.84it/s, est. speed input: 1047.64 toks/s, output: 682.91 toks/s]Processed prompts:  35%|███▍      | 33/95 [00:05<00:06,  9.58it/s, est. speed input: 1057.29 toks/s, output: 716.27 toks/s]Processed prompts:  38%|███▊      | 36/95 [00:05<00:04, 12.44it/s, est. speed input: 1134.46 toks/s, output: 803.45 toks/s]Processed prompts:  40%|████      | 38/95 [00:06<00:09,  6.03it/s, est. speed input: 1048.67 toks/s, output: 771.49 toks/s]Processed prompts:  43%|████▎     | 41/95 [00:06<00:06,  8.15it/s, est. speed input: 1137.43 toks/s, output: 864.19 toks/s]Processed prompts:  45%|████▌     | 43/95 [00:06<00:07,  6.97it/s, est. speed input: 1144.40 toks/s, output: 888.14 toks/s]Processed prompts:  48%|████▊     | 46/95 [00:06<00:05,  8.66it/s, est. speed input: 1256.63 toks/s, output: 976.00 toks/s]Processed prompts:  51%|█████     | 48/95 [00:08<00:12,  3.87it/s, est. speed input: 1110.22 toks/s, output: 896.36 toks/s]Processed prompts:  52%|█████▏    | 49/95 [00:08<00:14,  3.17it/s, est. speed input: 1075.26 toks/s, output: 874.32 toks/s]Processed prompts:  53%|█████▎    | 50/95 [00:09<00:15,  2.85it/s, est. speed input: 1060.99 toks/s, output: 868.60 toks/s]Processed prompts:  54%|█████▎    | 51/95 [00:09<00:13,  3.20it/s, est. speed input: 1071.73 toks/s, output: 895.88 toks/s]Processed prompts:  57%|█████▋    | 54/95 [00:10<00:12,  3.40it/s, est. speed input: 1102.90 toks/s, output: 946.24 toks/s]Processed prompts:  58%|█████▊    | 55/95 [00:11<00:14,  2.76it/s, est. speed input: 1092.66 toks/s, output: 932.75 toks/s]Processed prompts:  59%|█████▉    | 56/95 [00:11<00:13,  2.92it/s, est. speed input: 1105.88 toks/s, output: 954.28 toks/s]Processed prompts:  61%|██████    | 58/95 [00:11<00:09,  3.82it/s, est. speed input: 1150.25 toks/s, output: 1020.41 toks/s]Processed prompts:  63%|██████▎   | 60/95 [00:12<00:08,  4.27it/s, est. speed input: 1196.99 toks/s, output: 1075.67 toks/s]Processed prompts:  66%|██████▋   | 63/95 [00:12<00:05,  6.02it/s, est. speed input: 1288.78 toks/s, output: 1186.89 toks/s]Processed prompts:  67%|██████▋   | 64/95 [00:12<00:06,  4.72it/s, est. speed input: 1286.43 toks/s, output: 1190.34 toks/s]Processed prompts:  68%|██████▊   | 65/95 [00:13<00:08,  3.67it/s, est. speed input: 1270.85 toks/s, output: 1188.11 toks/s]Processed prompts:  69%|██████▉   | 66/95 [00:14<00:12,  2.28it/s, est. speed input: 1219.46 toks/s, output: 1147.44 toks/s]Processed prompts:  71%|███████   | 67/95 [00:14<00:13,  2.07it/s, est. speed input: 1216.75 toks/s, output: 1145.66 toks/s]Processed prompts:  72%|███████▏  | 68/95 [00:15<00:14,  1.93it/s, est. speed input: 1204.88 toks/s, output: 1145.77 toks/s]Processed prompts:  74%|███████▎  | 70/95 [00:15<00:08,  2.86it/s, est. speed input: 1282.23 toks/s, output: 1221.65 toks/s]Processed prompts:  75%|███████▍  | 71/95 [00:16<00:09,  2.54it/s, est. speed input: 1275.64 toks/s, output: 1228.01 toks/s]Processed prompts:  76%|███████▌  | 72/95 [00:16<00:10,  2.23it/s, est. speed input: 1267.25 toks/s, output: 1230.94 toks/s]Processed prompts:  77%|███████▋  | 73/95 [00:17<00:12,  1.82it/s, est. speed input: 1245.53 toks/s, output: 1220.36 toks/s]Processed prompts:  78%|███████▊  | 74/95 [00:18<00:10,  1.98it/s, est. speed input: 1267.23 toks/s, output: 1242.10 toks/s]Processed prompts:  79%|███████▉  | 75/95 [00:18<00:10,  1.85it/s, est. speed input: 1268.98 toks/s, output: 1248.59 toks/s]Processed prompts:  80%|████████  | 76/95 [00:20<00:14,  1.29it/s, est. speed input: 1229.29 toks/s, output: 1212.81 toks/s]Processed prompts:  81%|████████  | 77/95 [00:24<00:34,  1.93s/it, est. speed input: 1043.47 toks/s, output: 1029.52 toks/s]Processed prompts:  82%|████████▏ | 78/95 [00:28<00:40,  2.37s/it, est. speed input: 967.66 toks/s, output: 954.63 toks/s]  Processed prompts:  83%|████████▎ | 79/95 [00:29<00:30,  1.92s/it, est. speed input: 982.09 toks/s, output: 977.66 toks/s]Processed prompts:  84%|████████▍ | 80/95 [00:29<00:22,  1.48s/it, est. speed input: 1003.96 toks/s, output: 1013.94 toks/s]Processed prompts:  85%|████████▌ | 81/95 [00:29<00:14,  1.07s/it, est. speed input: 1038.43 toks/s, output: 1060.60 toks/s]Processed prompts:  86%|████████▋ | 82/95 [00:31<00:17,  1.35s/it, est. speed input: 1016.15 toks/s, output: 1044.12 toks/s]Processed prompts:  87%|████████▋ | 83/95 [00:35<00:26,  2.18s/it, est. speed input: 952.30 toks/s, output: 975.84 toks/s]  Processed prompts:  88%|████████▊ | 84/95 [00:36<00:20,  1.85s/it, est. speed input: 964.22 toks/s, output: 999.86 toks/s]Processed prompts:  89%|████████▉ | 85/95 [00:37<00:13,  1.37s/it, est. speed input: 1012.15 toks/s, output: 1046.51 toks/s]Processed prompts:  91%|█████████ | 86/95 [00:37<00:09,  1.07s/it, est. speed input: 1042.69 toks/s, output: 1088.73 toks/s]Processed prompts:  92%|█████████▏| 87/95 [00:39<00:11,  1.42s/it, est. speed input: 1023.87 toks/s, output: 1080.62 toks/s]Processed prompts:  93%|█████████▎| 88/95 [00:41<00:10,  1.56s/it, est. speed input: 1032.15 toks/s, output: 1085.80 toks/s]Processed prompts:  94%|█████████▎| 89/95 [00:42<00:07,  1.27s/it, est. speed input: 1052.07 toks/s, output: 1124.99 toks/s]Processed prompts:  95%|█████████▍| 90/95 [00:43<00:05,  1.14s/it, est. speed input: 1070.59 toks/s, output: 1157.98 toks/s]Processed prompts:  96%|█████████▌| 91/95 [00:44<00:05,  1.29s/it, est. speed input: 1071.63 toks/s, output: 1170.42 toks/s]Processed prompts:  97%|█████████▋| 92/95 [00:49<00:06,  2.31s/it, est. speed input: 1014.72 toks/s, output: 1117.52 toks/s]Processed prompts:  98%|█████████▊| 93/95 [01:09<00:15,  7.53s/it, est. speed input: 762.84 toks/s, output: 865.23 toks/s]  Processed prompts:  99%|█████████▉| 94/95 [01:25<00:10, 10.28s/it, est. speed input: 638.32 toks/s, output: 768.30 toks/s]Processed prompts: 100%|██████████| 95/95 [01:44<00:00, 12.75s/it, est. speed input: 527.50 toks/s, output: 708.23 toks/s]Processed prompts: 100%|██████████| 95/95 [01:44<00:00, 12.75s/it, est. speed input: 527.50 toks/s, output: 708.23 toks/s]Processed prompts: 100%|██████████| 95/95 [01:44<00:00,  1.10s/it, est. speed input: 527.50 toks/s, output: 708.23 toks/s]
Processing translations ...
Map:   0%|          | 0/95 [00:00<?, ? examples/s]Map: 100%|██████████| 95/95 [00:00<00:00, 8537.61 examples/s]
Saving translations to /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations/translation_1_0.jsonl
  0%|          | 0/95 [00:00<?, ?it/s]100%|██████████| 95/95 [00:00<00:00, 9716.38it/s]
Done!
Finished translations for model 1
Running translations for model 2: utter-project/EuroLLM-9B-Instruct
Translate file: /ceph/hpc/data/s24o01-42-users/translation_optimization/get_translations/translate_generic.py
cpu-bind=MASK - ixh, task  0  0 [2254849]: mask 0x30000000000000000000000000003 set
Collecting vllm==0.9.2
  Downloading vllm-0.9.2-cp38-abi3-manylinux1_x86_64.whl.metadata (15 kB)
Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2024.11.6)
Requirement already satisfied: cachetools in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (6.1.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (7.0.0)
Requirement already satisfied: sentencepiece in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.2.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.26.4)
Requirement already satisfied: requests>=2.26.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.32.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.67.1)
Requirement already satisfied: blake3 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.0.5)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (9.0.0)
Requirement already satisfied: transformers>=4.51.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.52.4)
Requirement already satisfied: huggingface-hub>=0.33.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub[hf_xet]>=0.33.0->vllm==0.9.2) (0.33.0)
Requirement already satisfied: tokenizers>=0.21.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.21.1)
Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (5.29.5)
Requirement already satisfied: fastapi>=0.115.0 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (0.115.12)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.12.13)
Requirement already satisfied: openai<=1.90.0,>=1.52.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.88.0)
Requirement already satisfied: pydantic>=2.10 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.11.7)
Requirement already satisfied: prometheus_client>=0.18.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.22.1)
Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (11.2.1)
Requirement already satisfied: prometheus-fastapi-instrumentator>=7.0.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (7.1.0)
Requirement already satisfied: tiktoken>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.9.0)
Requirement already satisfied: lm-format-enforcer<0.11,>=0.10.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.10.11)
Requirement already satisfied: llguidance<0.8.0,>=0.7.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.7.29)
Requirement already satisfied: outlines==0.1.11 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.1.11)
Requirement already satisfied: lark==1.2.2 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.2.2)
Requirement already satisfied: xgrammar==0.1.19 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.1.19)
Requirement already satisfied: typing_extensions>=4.10 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.14.0)
Requirement already satisfied: filelock>=3.16.1 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.18.0)
Requirement already satisfied: partial-json-parser in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.2.1.1.post5)
Requirement already satisfied: pyzmq>=25.0.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (27.0.0)
Requirement already satisfied: msgspec in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.19.0)
Requirement already satisfied: gguf>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.17.0)
Requirement already satisfied: mistral_common>=1.6.2 in /usr/local/lib/python3.10/dist-packages (from mistral_common[opencv]>=1.6.2->vllm==0.9.2) (1.6.2)
Requirement already satisfied: opencv-python-headless>=4.11.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (4.11.0.86)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (6.0.2)
Requirement already satisfied: einops in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.8.1)
Collecting compressed-tensors==0.10.2 (from vllm==0.9.2)
  Downloading compressed_tensors-0.10.2-py3-none-any.whl.metadata (7.0 kB)
Requirement already satisfied: depyf==0.18.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.18.0)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.1.1)
Requirement already satisfied: watchfiles in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.1.0)
Requirement already satisfied: python-json-logger in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (3.3.0)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.15.3)
Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (1.11.1.4)
Collecting pybase64 (from vllm==0.9.2)
  Downloading pybase64-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.4 kB)
Requirement already satisfied: numba==0.61.2 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.61.2)
Requirement already satisfied: ray!=2.44.*,>=2.43.0 in /usr/local/lib/python3.10/dist-packages (from ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (2.47.0)
Requirement already satisfied: torch==2.7.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.7.0)
Requirement already satisfied: torchaudio==2.7.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (2.7.0)
Requirement already satisfied: torchvision==0.22.0 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.22.0)
Requirement already satisfied: xformers==0.0.30 in /usr/local/lib/python3.10/dist-packages (from vllm==0.9.2) (0.0.30)
Requirement already satisfied: astor in /usr/local/lib/python3.10/dist-packages (from depyf==0.18.0->vllm==0.9.2) (0.8.1)
Requirement already satisfied: dill in /usr/local/lib/python3.10/dist-packages (from depyf==0.18.0->vllm==0.9.2) (0.3.4)
Requirement already satisfied: llvmlite<0.45,>=0.44.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba==0.61.2->vllm==0.9.2) (0.44.0)
Requirement already satisfied: interegular in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (3.1.6)
Requirement already satisfied: nest_asyncio in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (1.6.0)
Requirement already satisfied: diskcache in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (5.6.3)
Requirement already satisfied: referencing in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.36.2)
Requirement already satisfied: jsonschema in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (4.24.0)
Requirement already satisfied: pycountry in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (24.6.1)
Requirement already satisfied: airportsdata in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (20250523)
Requirement already satisfied: outlines_core==0.1.26 in /usr/local/lib/python3.10/dist-packages (from outlines==0.1.11->vllm==0.9.2) (0.1.26)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (1.14.0)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (3.4.2)
Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (2025.3.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.6.80 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.80)
Requirement already satisfied: nvidia-cudnn-cu12==9.5.1.17 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (9.5.1.17)
Requirement already satisfied: nvidia-cublas-cu12==12.6.4.1 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.0.4 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (11.3.0.4)
Requirement already satisfied: nvidia-curand-cu12==10.3.7.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (10.3.7.77)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.1.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (11.7.1.2)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.4.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.5.4.2)
Requirement already satisfied: nvidia-cusparselt-cu12==0.6.3 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (0.6.3)
Requirement already satisfied: nvidia-nccl-cu12==2.26.2 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (2.26.2)
Requirement already satisfied: nvidia-nvtx-cu12==12.6.77 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.77)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.6.85 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (12.6.85)
Requirement already satisfied: nvidia-cufile-cu12==1.11.1.6 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (1.11.1.6)
Requirement already satisfied: triton==3.3.0 in /usr/local/lib/python3.10/dist-packages (from torch==2.7.0->vllm==0.9.2) (3.3.0)
Requirement already satisfied: setuptools>=40.8.0 in /usr/lib/python3/dist-packages (from triton==3.3.0->torch==2.7.0->vllm==0.9.2) (59.6.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from lm-format-enforcer<0.11,>=0.10.11->vllm==0.9.2) (25.0)
Requirement already satisfied: anyio<5,>=3.5.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (4.9.0)
Requirement already satisfied: distro<2,>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.9.0)
Requirement already satisfied: httpx<1,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.27.2)
Requirement already satisfied: jiter<1,>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.10.0)
Requirement already satisfied: sniffio in /usr/local/lib/python3.10/dist-packages (from openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.3.1)
Requirement already satisfied: exceptiongroup>=1.0.2 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.3.0)
Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (3.10)
Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (2025.6.15)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.10/dist-packages (from httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (1.0.9)
Requirement already satisfied: h11>=0.16 in /usr/local/lib/python3.10/dist-packages (from httpcore==1.*->httpx<1,>=0.23.0->openai<=1.90.0,>=1.52.0->vllm==0.9.2) (0.16.0)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (2.33.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.10->vllm==0.9.2) (0.4.1)
Requirement already satisfied: starlette<0.47.0,>=0.40.0 in /usr/local/lib/python3.10/dist-packages (from fastapi>=0.115.0->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.46.2)
Requirement already satisfied: fastapi-cli>=0.0.5 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.0.7)
Requirement already satisfied: python-multipart>=0.0.18 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (0.0.20)
Requirement already satisfied: email-validator>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from fastapi[standard]>=0.115.0->vllm==0.9.2) (2.2.0)
Requirement already satisfied: uvicorn>=0.12.0 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.34.3)
Requirement already satisfied: dnspython>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from email-validator>=2.0.0->fastapi[standard]>=0.115.0->vllm==0.9.2) (2.7.0)
Requirement already satisfied: typer>=0.12.3 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.16.0)
Requirement already satisfied: rich-toolkit>=0.11.1 in /usr/local/lib/python3.10/dist-packages (from fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.14.7)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.33.0->huggingface-hub[hf_xet]>=0.33.0->vllm==0.9.2) (1.1.4)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->outlines==0.1.11->vllm==0.9.2) (3.0.2)
Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (25.3.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (2025.4.1)
Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema->outlines==0.1.11->vllm==0.9.2) (0.25.1)
Requirement already satisfied: click>=7.0 in /usr/local/lib/python3.10/dist-packages (from ray!=2.44.*,>=2.43.0->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (8.2.1)
Requirement already satisfied: msgpack<2.0.0,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ray!=2.44.*,>=2.43.0->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (1.1.1)
Requirement already satisfied: cupy-cuda12x in /usr/local/lib/python3.10/dist-packages (from ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (13.4.1)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26.0->vllm==0.9.2) (3.4.2)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26.0->vllm==0.9.2) (1.26.20)
Requirement already satisfied: rich>=13.7.1 in /usr/local/lib/python3.10/dist-packages (from rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (14.0.0)
Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (2.19.1)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py>=2.2.0->rich>=13.7.1->rich-toolkit>=0.11.1->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.1.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy>=1.13.3->torch==2.7.0->vllm==0.9.2) (1.3.0)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from transformers>=4.51.1->vllm==0.9.2) (0.5.3)
Requirement already satisfied: shellingham>=1.3.0 in /usr/local/lib/python3.10/dist-packages (from typer>=0.12.3->fastapi-cli>=0.0.5->fastapi-cli[standard]>=0.0.5; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (1.5.4)
Requirement already satisfied: httptools>=0.6.3 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.6.4)
Requirement already satisfied: python-dotenv>=0.13 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (1.1.0)
Requirement already satisfied: uvloop>=0.15.1 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (0.21.0)
Requirement already satisfied: websockets>=10.4 in /usr/local/lib/python3.10/dist-packages (from uvicorn[standard]>=0.12.0; extra == "standard"->fastapi[standard]>=0.115.0->vllm==0.9.2) (15.0.1)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (2.6.1)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.3.2)
Requirement already satisfied: async-timeout<6.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (5.0.1)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (6.4.4)
Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->vllm==0.9.2) (1.20.1)
Requirement already satisfied: fastrlock>=0.5 in /usr/local/lib/python3.10/dist-packages (from cupy-cuda12x->ray[cgraph]!=2.44.*,>=2.43.0->vllm==0.9.2) (0.8.3)
Downloading vllm-0.9.2-cp38-abi3-manylinux1_x86_64.whl (383.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 383.4/383.4 MB 85.9 MB/s eta 0:00:00
Downloading compressed_tensors-0.10.2-py3-none-any.whl (169 kB)
Downloading pybase64-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (68 kB)
Installing collected packages: pybase64, compressed-tensors, vllm
  Attempting uninstall: compressed-tensors
    Found existing installation: compressed-tensors 0.10.1
    Uninstalling compressed-tensors-0.10.1:
      Successfully uninstalled compressed-tensors-0.10.1
  Attempting uninstall: vllm
    Found existing installation: vllm 0.9.1
    Uninstalling vllm-0.9.1:
      Successfully uninstalled vllm-0.9.1

Successfully installed compressed-tensors-0.10.2 pybase64-1.4.1 vllm-0.9.2
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
INFO 07-16 16:16:22 [__init__.py:244] Automatically detected platform cuda.
Loading data ...
Selecting examples ...
Number of examples: 100
Using EuroLLMTaskAdapter for model: utter-project/EuroLLM-9B-Instruct
Using Hugging Face model ID: utter-project/EuroLLM-9B-Instruct
INFO 07-16 16:16:34 [config.py:841] This model supports multiple tasks: {'classify', 'reward', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 07-16 16:16:34 [config.py:1472] Using max model len 4096
INFO 07-16 16:16:34 [config.py:2285] Chunked prefill is enabled with max_num_batched_tokens=16384.
INFO 07-16 16:16:36 [core.py:526] Waiting for init message from front-end.
INFO 07-16 16:16:36 [core.py:69] Initializing a V1 LLM engine (v0.9.2) with config: model='utter-project/EuroLLM-9B-Instruct', speculative_config=None, tokenizer='utter-project/EuroLLM-9B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=42, served_model_name=utter-project/EuroLLM-9B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":512,"local_cache_dir":null}
INFO 07-16 16:16:38 [parallel_state.py:1076] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
WARNING 07-16 16:16:38 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
INFO 07-16 16:16:38 [gpu_model_runner.py:1770] Starting to load model utter-project/EuroLLM-9B-Instruct...
INFO 07-16 16:16:38 [gpu_model_runner.py:1775] Loading model from scratch...
INFO 07-16 16:16:38 [cuda.py:284] Using Flash Attention backend on V1 engine.
INFO 07-16 16:16:39 [weight_utils.py:292] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:09,  3.21s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:06<00:06,  3.32s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:08<00:02,  2.80s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.92s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.97s/it]

INFO 07-16 16:16:51 [default_loader.py:272] Loading weights took 11.96 seconds
INFO 07-16 16:16:52 [gpu_model_runner.py:1801] Model loading took 17.0486 GiB and 13.355811 seconds
INFO 07-16 16:16:59 [backends.py:506] vLLM's torch.compile cache is disabled.
INFO 07-16 16:16:59 [backends.py:519] Dynamo bytecode transform time: 6.56 s
INFO 07-16 16:17:01 [backends.py:181] Cache the graph of shape None for later use
INFO 07-16 16:17:25 [backends.py:193] Compiling a graph for general shape takes 25.22 s
INFO 07-16 16:17:37 [monitor.py:34] torch.compile takes 31.79 s in total
INFO 07-16 16:17:38 [gpu_worker.py:232] Available KV cache memory: 49.24 GiB
INFO 07-16 16:17:39 [kv_cache_utils.py:716] GPU KV cache size: 307,344 tokens
INFO 07-16 16:17:39 [kv_cache_utils.py:720] Maximum concurrency for 4,096 tokens per request: 75.04x
Capturing CUDA graph shapes:   0%|          | 0/67 [00:00<?, ?it/s]Capturing CUDA graph shapes:   1%|▏         | 1/67 [00:00<00:30,  2.15it/s]Capturing CUDA graph shapes:   3%|▎         | 2/67 [00:00<00:29,  2.20it/s]Capturing CUDA graph shapes:   4%|▍         | 3/67 [00:01<00:29,  2.20it/s]Capturing CUDA graph shapes:   6%|▌         | 4/67 [00:01<00:28,  2.19it/s]Capturing CUDA graph shapes:   7%|▋         | 5/67 [00:02<00:28,  2.19it/s]Capturing CUDA graph shapes:   9%|▉         | 6/67 [00:02<00:27,  2.19it/s]Capturing CUDA graph shapes:  10%|█         | 7/67 [00:03<00:27,  2.19it/s]Capturing CUDA graph shapes:  12%|█▏        | 8/67 [00:03<00:26,  2.19it/s]Capturing CUDA graph shapes:  13%|█▎        | 9/67 [00:04<00:26,  2.19it/s]Capturing CUDA graph shapes:  15%|█▍        | 10/67 [00:04<00:25,  2.20it/s]Capturing CUDA graph shapes:  16%|█▋        | 11/67 [00:05<00:25,  2.19it/s]Capturing CUDA graph shapes:  18%|█▊        | 12/67 [00:05<00:26,  2.11it/s]Capturing CUDA graph shapes:  19%|█▉        | 13/67 [00:05<00:25,  2.13it/s]Capturing CUDA graph shapes:  21%|██        | 14/67 [00:06<00:24,  2.14it/s]Capturing CUDA graph shapes:  22%|██▏       | 15/67 [00:06<00:24,  2.16it/s]Capturing CUDA graph shapes:  24%|██▍       | 16/67 [00:07<00:23,  2.15it/s]Capturing CUDA graph shapes:  25%|██▌       | 17/67 [00:07<00:23,  2.15it/s]Capturing CUDA graph shapes:  27%|██▋       | 18/67 [00:08<00:22,  2.19it/s]Capturing CUDA graph shapes:  28%|██▊       | 19/67 [00:08<00:21,  2.19it/s]Capturing CUDA graph shapes:  30%|██▉       | 20/67 [00:09<00:21,  2.19it/s]Capturing CUDA graph shapes:  31%|███▏      | 21/67 [00:09<00:21,  2.19it/s]Capturing CUDA graph shapes:  33%|███▎      | 22/67 [00:10<00:20,  2.19it/s]Capturing CUDA graph shapes:  34%|███▍      | 23/67 [00:10<00:20,  2.17it/s]Capturing CUDA graph shapes:  36%|███▌      | 24/67 [00:11<00:19,  2.17it/s]Capturing CUDA graph shapes:  37%|███▋      | 25/67 [00:11<00:19,  2.18it/s]Capturing CUDA graph shapes:  39%|███▉      | 26/67 [00:11<00:18,  2.17it/s]Capturing CUDA graph shapes:  40%|████      | 27/67 [00:12<00:18,  2.18it/s]Capturing CUDA graph shapes:  42%|████▏     | 28/67 [00:12<00:19,  2.03it/s]Capturing CUDA graph shapes:  43%|████▎     | 29/67 [00:13<00:18,  2.06it/s]Capturing CUDA graph shapes:  45%|████▍     | 30/67 [00:13<00:17,  2.07it/s]Capturing CUDA graph shapes:  46%|████▋     | 31/67 [00:14<00:17,  2.07it/s]Capturing CUDA graph shapes:  48%|████▊     | 32/67 [00:14<00:16,  2.10it/s]Capturing CUDA graph shapes:  49%|████▉     | 33/67 [00:15<00:16,  2.01it/s]Capturing CUDA graph shapes:  51%|█████     | 34/67 [00:15<00:16,  1.98it/s]Capturing CUDA graph shapes:  52%|█████▏    | 35/67 [00:16<00:15,  2.04it/s]Capturing CUDA graph shapes:  54%|█████▎    | 36/67 [00:16<00:14,  2.07it/s]Capturing CUDA graph shapes:  55%|█████▌    | 37/67 [00:17<00:14,  2.05it/s]Capturing CUDA graph shapes:  57%|█████▋    | 38/67 [00:17<00:14,  2.06it/s]Capturing CUDA graph shapes:  58%|█████▊    | 39/67 [00:18<00:13,  2.08it/s]Capturing CUDA graph shapes:  60%|█████▉    | 40/67 [00:18<00:12,  2.09it/s]Capturing CUDA graph shapes:  61%|██████    | 41/67 [00:19<00:12,  2.11it/s]Capturing CUDA graph shapes:  63%|██████▎   | 42/67 [00:19<00:11,  2.13it/s]Capturing CUDA graph shapes:  64%|██████▍   | 43/67 [00:20<00:11,  2.11it/s]Capturing CUDA graph shapes:  66%|██████▌   | 44/67 [00:20<00:10,  2.12it/s]Capturing CUDA graph shapes:  67%|██████▋   | 45/67 [00:21<00:10,  2.13it/s]Capturing CUDA graph shapes:  69%|██████▊   | 46/67 [00:21<00:09,  2.14it/s]Capturing CUDA graph shapes:  70%|███████   | 47/67 [00:22<00:09,  2.12it/s]Capturing CUDA graph shapes:  72%|███████▏  | 48/67 [00:22<00:09,  2.09it/s]Capturing CUDA graph shapes:  73%|███████▎  | 49/67 [00:23<00:08,  2.08it/s]Capturing CUDA graph shapes:  75%|███████▍  | 50/67 [00:23<00:08,  2.07it/s]Capturing CUDA graph shapes:  76%|███████▌  | 51/67 [00:24<00:07,  2.07it/s]Capturing CUDA graph shapes:  78%|███████▊  | 52/67 [00:24<00:07,  2.07it/s]Capturing CUDA graph shapes:  79%|███████▉  | 53/67 [00:24<00:06,  2.08it/s]Capturing CUDA graph shapes:  81%|████████  | 54/67 [00:25<00:06,  2.07it/s]Capturing CUDA graph shapes:  82%|████████▏ | 55/67 [00:25<00:05,  2.08it/s]Capturing CUDA graph shapes:  84%|████████▎ | 56/67 [00:26<00:05,  2.10it/s]Capturing CUDA graph shapes:  85%|████████▌ | 57/67 [00:26<00:04,  2.10it/s]Capturing CUDA graph shapes:  87%|████████▋ | 58/67 [00:27<00:04,  2.10it/s]Capturing CUDA graph shapes:  88%|████████▊ | 59/67 [00:27<00:03,  2.09it/s]Capturing CUDA graph shapes:  90%|████████▉ | 60/67 [00:28<00:03,  2.08it/s]Capturing CUDA graph shapes:  91%|█████████ | 61/67 [00:28<00:02,  2.09it/s]Capturing CUDA graph shapes:  93%|█████████▎| 62/67 [00:29<00:02,  2.09it/s]Capturing CUDA graph shapes:  94%|█████████▍| 63/67 [00:29<00:01,  2.10it/s]Capturing CUDA graph shapes:  96%|█████████▌| 64/67 [00:30<00:01,  2.11it/s]Capturing CUDA graph shapes:  97%|█████████▋| 65/67 [00:30<00:00,  2.12it/s]Capturing CUDA graph shapes:  99%|█████████▊| 66/67 [00:31<00:00,  2.13it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:31<00:00,  2.12it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:31<00:00,  2.12it/s]
INFO 07-16 16:18:10 [gpu_model_runner.py:2326] Graph capturing finished in 32 secs, took 0.80 GiB
INFO 07-16 16:18:10 [core.py:172] init engine (profile, create kv cache, warmup model) took 78.66 seconds
Preparing prompts ...
Map (num_proc=8):   0%|          | 0/100 [00:00<?, ? examples/s]Map (num_proc=8):   7%|▋         | 7/100 [00:08<01:50,  1.19s/ examples]Map (num_proc=8):  37%|███▋      | 37/100 [00:08<00:10,  5.90 examples/s]Map (num_proc=8):  61%|██████    | 61/100 [00:08<00:03, 10.78 examples/s]Map (num_proc=8): 100%|██████████| 100/100 [00:08<00:00, 22.45 examples/s]Map (num_proc=8): 100%|██████████| 100/100 [00:08<00:00, 11.20 examples/s]
Filter (num_proc=8):   0%|          | 0/100 [00:00<?, ? examples/s]Filter (num_proc=8):  76%|███████▌  | 76/100 [00:00<00:00, 727.78 examples/s]Filter (num_proc=8): 100%|██████████| 100/100 [00:00<00:00, 556.64 examples/s]
Number of prompts: 95
Running translations ...
Adding requests:   0%|          | 0/95 [00:00<?, ?it/s]Adding requests:  83%|████████▎ | 79/95 [00:00<00:00, 787.22it/s]Adding requests: 100%|██████████| 95/95 [00:00<00:00, 784.42it/s]
Processed prompts:   0%|          | 0/95 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/95 [00:02<03:34,  2.28s/it, est. speed input: 32.94 toks/s, output: 21.96 toks/s]Processed prompts:   2%|▏         | 2/95 [00:02<01:32,  1.00it/s, est. speed input: 64.63 toks/s, output: 44.48 toks/s]Processed prompts:   4%|▍         | 4/95 [00:02<00:40,  2.26it/s, est. speed input: 124.02 toks/s, output: 94.07 toks/s]Processed prompts:   6%|▋         | 6/95 [00:02<00:23,  3.78it/s, est. speed input: 189.23 toks/s, output: 147.95 toks/s]Processed prompts:   8%|▊         | 8/95 [00:02<00:15,  5.49it/s, est. speed input: 253.11 toks/s, output: 204.10 toks/s]Processed prompts:  11%|█         | 10/95 [00:03<00:13,  6.53it/s, est. speed input: 313.13 toks/s, output: 254.68 toks/s]Processed prompts:  13%|█▎        | 12/95 [00:03<00:09,  8.43it/s, est. speed input: 375.69 toks/s, output: 314.13 toks/s]Processed prompts:  17%|█▋        | 16/95 [00:03<00:05, 13.44it/s, est. speed input: 521.54 toks/s, output: 443.59 toks/s]Processed prompts:  21%|██        | 20/95 [00:03<00:04, 17.98it/s, est. speed input: 703.99 toks/s, output: 574.30 toks/s]Processed prompts:  24%|██▍       | 23/95 [00:03<00:04, 17.27it/s, est. speed input: 790.02 toks/s, output: 655.74 toks/s]Processed prompts:  27%|██▋       | 26/95 [00:03<00:03, 19.14it/s, est. speed input: 885.14 toks/s, output: 750.83 toks/s]Processed prompts:  31%|███       | 29/95 [00:03<00:03, 20.81it/s, est. speed input: 1613.57 toks/s, output: 847.71 toks/s]Processed prompts:  34%|███▎      | 32/95 [00:04<00:03, 18.31it/s, est. speed input: 2173.58 toks/s, output: 926.71 toks/s]Processed prompts:  37%|███▋      | 35/95 [00:04<00:04, 13.21it/s, est. speed input: 2130.93 toks/s, output: 978.87 toks/s]Processed prompts:  39%|███▉      | 37/95 [00:04<00:04, 13.48it/s, est. speed input: 2725.61 toks/s, output: 1039.84 toks/s]Processed prompts:  44%|████▍     | 42/95 [00:04<00:03, 15.85it/s, est. speed input: 2869.81 toks/s, output: 1211.60 toks/s]Processed prompts:  46%|████▋     | 44/95 [00:05<00:03, 13.09it/s, est. speed input: 2806.49 toks/s, output: 1246.22 toks/s]Processed prompts:  48%|████▊     | 46/95 [00:05<00:05,  8.44it/s, est. speed input: 2644.19 toks/s, output: 1223.08 toks/s]Processed prompts:  51%|█████     | 48/95 [00:05<00:05,  9.00it/s, est. speed input: 2657.34 toks/s, output: 1287.63 toks/s]Processed prompts:  53%|█████▎    | 50/95 [00:06<00:05,  7.57it/s, est. speed input: 2582.05 toks/s, output: 1310.82 toks/s]Processed prompts:  54%|█████▎    | 51/95 [00:06<00:05,  7.55it/s, est. speed input: 2569.30 toks/s, output: 1336.39 toks/s]Processed prompts:  56%|█████▌    | 53/95 [00:07<00:09,  4.54it/s, est. speed input: 2383.32 toks/s, output: 1283.18 toks/s]Processed prompts:  57%|█████▋    | 54/95 [00:08<00:14,  2.84it/s, est. speed input: 2155.12 toks/s, output: 1189.99 toks/s]Processed prompts:  58%|█████▊    | 55/95 [00:08<00:12,  3.25it/s, est. speed input: 2172.26 toks/s, output: 1229.12 toks/s]Processed prompts:  60%|██████    | 57/95 [00:08<00:08,  4.58it/s, est. speed input: 2255.92 toks/s, output: 1326.62 toks/s]Processed prompts:  61%|██████    | 58/95 [00:08<00:08,  4.56it/s, est. speed input: 2253.84 toks/s, output: 1351.34 toks/s]Processed prompts:  63%|██████▎   | 60/95 [00:08<00:06,  5.59it/s, est. speed input: 2299.00 toks/s, output: 1435.48 toks/s]Processed prompts:  65%|██████▌   | 62/95 [00:09<00:05,  5.87it/s, est. speed input: 2318.36 toks/s, output: 1504.67 toks/s]Processed prompts:  66%|██████▋   | 63/95 [00:09<00:06,  4.86it/s, est. speed input: 2295.89 toks/s, output: 1510.26 toks/s]Processed prompts:  67%|██████▋   | 64/95 [00:09<00:06,  5.15it/s, est. speed input: 2313.06 toks/s, output: 1547.43 toks/s]Processed prompts:  68%|██████▊   | 65/95 [00:09<00:06,  4.86it/s, est. speed input: 2309.39 toks/s, output: 1570.94 toks/s]Processed prompts:  69%|██████▉   | 66/95 [00:10<00:07,  3.68it/s, est. speed input: 2266.95 toks/s, output: 1562.52 toks/s]Processed prompts:  71%|███████   | 67/95 [00:10<00:06,  4.21it/s, est. speed input: 2299.67 toks/s, output: 1604.00 toks/s]Processed prompts:  72%|███████▏  | 68/95 [00:10<00:07,  3.48it/s, est. speed input: 2268.25 toks/s, output: 1605.52 toks/s]Processed prompts:  73%|███████▎  | 69/95 [00:11<00:08,  3.23it/s, est. speed input: 2249.09 toks/s, output: 1617.05 toks/s]Processed prompts:  74%|███████▎  | 70/95 [00:11<00:06,  3.96it/s, est. speed input: 2287.10 toks/s, output: 1665.34 toks/s]Processed prompts:  75%|███████▍  | 71/95 [00:11<00:05,  4.23it/s, est. speed input: 2303.91 toks/s, output: 1701.05 toks/s]Processed prompts:  76%|███████▌  | 72/95 [00:11<00:04,  4.60it/s, est. speed input: 2321.49 toks/s, output: 1740.67 toks/s]Processed prompts:  77%|███████▋  | 73/95 [00:12<00:07,  3.02it/s, est. speed input: 2272.58 toks/s, output: 1721.11 toks/s]Processed prompts:  78%|███████▊  | 74/95 [00:13<00:11,  1.83it/s, est. speed input: 2154.50 toks/s, output: 1651.95 toks/s]Processed prompts:  79%|███████▉  | 75/95 [00:13<00:08,  2.37it/s, est. speed input: 2188.80 toks/s, output: 1703.12 toks/s]Processed prompts:  81%|████████  | 77/95 [00:14<00:09,  1.96it/s, est. speed input: 2119.68 toks/s, output: 1690.37 toks/s]Processed prompts:  82%|████████▏ | 78/95 [00:15<00:09,  1.82it/s, est. speed input: 2089.67 toks/s, output: 1684.88 toks/s]Processed prompts:  83%|████████▎ | 79/95 [00:16<00:11,  1.40it/s, est. speed input: 2001.75 toks/s, output: 1635.26 toks/s]Processed prompts:  85%|████████▌ | 81/95 [00:18<00:12,  1.10it/s, est. speed input: 1882.55 toks/s, output: 1564.11 toks/s]Processed prompts:  86%|████████▋ | 82/95 [00:19<00:10,  1.24it/s, est. speed input: 1900.22 toks/s, output: 1597.39 toks/s]Processed prompts:  87%|████████▋ | 83/95 [00:20<00:11,  1.07it/s, est. speed input: 1844.12 toks/s, output: 1567.32 toks/s]Processed prompts:  89%|████████▉ | 85/95 [00:21<00:06,  1.44it/s, est. speed input: 1934.01 toks/s, output: 1659.29 toks/s]Processed prompts:  91%|█████████ | 86/95 [00:22<00:06,  1.32it/s, est. speed input: 1958.58 toks/s, output: 1660.16 toks/s]Processed prompts:  92%|█████████▏| 87/95 [00:23<00:06,  1.18it/s, est. speed input: 1929.40 toks/s, output: 1655.03 toks/s]Processed prompts:  93%|█████████▎| 88/95 [00:24<00:06,  1.04it/s, est. speed input: 1895.75 toks/s, output: 1645.34 toks/s]Processed prompts:  94%|█████████▎| 89/95 [00:25<00:05,  1.18it/s, est. speed input: 1941.44 toks/s, output: 1686.01 toks/s]Processed prompts:  96%|█████████▌| 91/95 [00:25<00:02,  1.63it/s, est. speed input: 2030.79 toks/s, output: 1795.32 toks/s]Processed prompts:  97%|█████████▋| 92/95 [00:26<00:01,  1.79it/s, est. speed input: 2066.06 toks/s, output: 1845.74 toks/s]Processed prompts:  99%|█████████▉| 94/95 [00:26<00:00,  2.29it/s, est. speed input: 2179.42 toks/s, output: 1963.36 toks/s]Processed prompts: 100%|██████████| 95/95 [00:28<00:00,  1.48it/s, est. speed input: 2128.72 toks/s, output: 1938.33 toks/s]Processed prompts: 100%|██████████| 95/95 [00:28<00:00,  1.48it/s, est. speed input: 2128.72 toks/s, output: 1938.33 toks/s]Processed prompts: 100%|██████████| 95/95 [00:28<00:00,  3.35it/s, est. speed input: 2128.72 toks/s, output: 1938.33 toks/s]
Processing translations ...
Map:   0%|          | 0/95 [00:00<?, ? examples/s]Map: 100%|██████████| 95/95 [00:00<00:00, 9677.67 examples/s]
Saving translations to /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations/translation_2_0.jsonl
  0%|          | 0/95 [00:00<?, ?it/s]100%|██████████| 95/95 [00:00<00:00, 10364.12it/s]
Done!
Finished translations for model 2
Starting COMET scoring
cpu-bind=MASK - ixh, task  0  0 [2261572]: mask 0x30000000000000000000000000003 set
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Collecting unbabel-comet>=2.1.0
  Downloading unbabel_comet-2.2.6-py3-none-any.whl.metadata (19 kB)
Collecting entmax<2.0,>=1.1 (from unbabel-comet>=2.1.0)
  Downloading entmax-1.3-py3-none-any.whl.metadata (348 bytes)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (0.27.0)
Collecting jsonargparse==3.13.1 (from unbabel-comet>=2.1.0)
  Downloading jsonargparse-3.13.1-py3-none-any.whl.metadata (55 kB)
Requirement already satisfied: numpy<2.0.0,>=1.20.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (1.26.4)
Requirement already satisfied: pandas>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.2.2)
Collecting protobuf<5.0.0,>=4.24.4 (from unbabel-comet>=2.1.0)
  Downloading protobuf-4.25.8-cp37-abi3-manylinux2014_x86_64.whl.metadata (541 bytes)
Requirement already satisfied: pytorch-lightning<3.0.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.5.0.post0)
Requirement already satisfied: sacrebleu<3.0.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.4.3)
Requirement already satisfied: scipy<2.0.0,>=1.5.4 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (1.14.0)
Requirement already satisfied: sentencepiece<0.3.0,>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (0.2.0)
Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.5.0a0+e000cf0ad9.nv24.10)
Collecting torchmetrics<0.11.0,>=0.10.2 (from unbabel-comet>=2.1.0)
  Downloading torchmetrics-0.10.3-py3-none-any.whl.metadata (15 kB)
Requirement already satisfied: transformers<5.0,>=4.17 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (4.45.1)
Requirement already satisfied: PyYAML>=3.13 in /usr/local/lib/python3.10/dist-packages (from jsonargparse==3.13.1->unbabel-comet>=2.1.0) (6.0.2)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.16.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2024.6.1)
Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (23.2)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2.32.3)
Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (4.67.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (4.12.2)
Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2023.4)
Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2024.1)
Requirement already satisfied: lightning-utilities>=0.10.0 in /usr/local/lib/python3.10/dist-packages/lightning_utilities-0.11.7-py3.10.egg (from pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.11.7)
Requirement already satisfied: portalocker in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (3.0.0)
Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (2024.9.11)
Requirement already satisfied: tabulate>=0.8.9 in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.9.0)
Requirement already satisfied: colorama in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.4.6)
Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (5.3.0)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.6.0->unbabel-comet>=2.1.0) (1.3.0)
Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers<5.0,>=4.17->unbabel-comet>=2.1.0) (0.4.5)
Requirement already satisfied: tokenizers<0.21,>=0.20 in /usr/local/lib/python3.10/dist-packages (from transformers<5.0,>=4.17->unbabel-comet>=2.1.0) (0.20.3)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (3.10.5)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from lightning-utilities>=0.10.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (70.3.0)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas>=1.4.1->unbabel-comet>=2.1.0) (1.16.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->unbabel-comet>=2.1.0) (2.1.5)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.4.0)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (1.26.20)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2024.8.30)
Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (2.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.3.1)
Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (24.2.0)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.4.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (6.0.5)
Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.9.4)
Requirement already satisfied: async-timeout<5.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (4.0.3)
Downloading unbabel_comet-2.2.6-py3-none-any.whl (90 kB)
Downloading jsonargparse-3.13.1-py3-none-any.whl (101 kB)
Downloading entmax-1.3-py3-none-any.whl (13 kB)
Downloading protobuf-4.25.8-cp37-abi3-manylinux2014_x86_64.whl (294 kB)
Downloading torchmetrics-0.10.3-py3-none-any.whl (529 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 529.7/529.7 kB 16.5 MB/s eta 0:00:00
Installing collected packages: protobuf, jsonargparse, torchmetrics, entmax, unbabel-comet
  Attempting uninstall: protobuf
    Found existing installation: protobuf 3.20.3
    Uninstalling protobuf-3.20.3:
      Successfully uninstalled protobuf-3.20.3
  Attempting uninstall: torchmetrics
    Found existing installation: torchmetrics 1.6.0
    Uninstalling torchmetrics-1.6.0:
      Successfully uninstalled torchmetrics-1.6.0
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow-metadata 1.16.1 requires protobuf<4.21,>=3.20.3; python_version < "3.11", but you have protobuf 4.25.8 which is incompatible.
tensorrt-llm 0.15.0.dev2024110500 requires pynvml>=11.5.0, but you have pynvml 11.4.1 which is incompatible.
Successfully installed entmax-1.3 jsonargparse-3.13.1 protobuf-4.25.8 torchmetrics-0.10.3 unbabel-comet-2.2.6
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.

[notice] A new release of pip is available: 24.2 -> 25.1.1
[notice] To update, run: python -m pip install --upgrade pip
Fetching 5 files:   0%|          | 0/5 [00:00<?, ?it/s]Fetching 5 files:  20%|██        | 1/5 [00:00<00:01,  3.39it/s]Fetching 5 files:  40%|████      | 2/5 [00:00<00:00,  4.25it/s]Fetching 5 files:  80%|████████  | 4/5 [00:11<00:03,  3.67s/it]Fetching 5 files: 100%|██████████| 5/5 [00:11<00:00,  2.38s/it]
Lightning automatically upgraded your loaded checkpoint from v1.8.2 to v2.5.0.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../../../shared/workspace/povejmo/huggingface_cache/hub/models--Unbabel--wmt22-cometkiwi-da/snapshots/1ad785194e391eebc6c53e2d0776cada8f83179a/checkpoints/model.ckpt`
/usr/local/lib/python3.10/dist-packages/transformers/tokenization_utils_base.py:1617: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be deprecated in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Encoder model frozen.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
Model path: /shared/workspace/povejmo/huggingface_cache/hub/models--Unbabel--wmt22-cometkiwi-da/snapshots/1ad785194e391eebc6c53e2d0776cada8f83179a/checkpoints/model.ckpt
Predicting: 0it [00:00, ?it/s]Predicting:   0%|          | 0/12 [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/12 [00:00<?, ?it/s]Predicting DataLoader 0:   8%|▊         | 1/12 [00:00<00:02,  3.93it/s]Predicting DataLoader 0:  17%|█▋        | 2/12 [00:00<00:01,  7.41it/s]Predicting DataLoader 0:  25%|██▌       | 3/12 [00:00<00:00, 10.63it/s]Predicting DataLoader 0:  33%|███▎      | 4/12 [00:00<00:00, 13.52it/s]Predicting DataLoader 0:  42%|████▏     | 5/12 [00:00<00:00, 16.06it/s]Predicting DataLoader 0:  50%|█████     | 6/12 [00:00<00:00, 18.11it/s]Predicting DataLoader 0:  58%|█████▊    | 7/12 [00:00<00:00, 19.93it/s]Predicting DataLoader 0:  67%|██████▋   | 8/12 [00:00<00:00, 21.54it/s]Predicting DataLoader 0:  75%|███████▌  | 9/12 [00:00<00:00, 23.13it/s]Predicting DataLoader 0:  83%|████████▎ | 10/12 [00:00<00:00, 24.31it/s]Predicting DataLoader 0:  92%|█████████▏| 11/12 [00:00<00:00, 25.68it/s]Predicting DataLoader 0: 100%|██████████| 12/12 [00:00<00:00, 26.80it/s]Predicting DataLoader 0: 100%|██████████| 12/12 [00:00<00:00, 26.16it/s]
Dataset score: 0.6933988420586837
COMET scoring done
Starting COMET scoring
cpu-bind=MASK - ixh, task  0  0 [2264428]: mask 0x30000000000000000000000000003 set
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Collecting unbabel-comet>=2.1.0
  Downloading unbabel_comet-2.2.6-py3-none-any.whl.metadata (19 kB)
Collecting entmax<2.0,>=1.1 (from unbabel-comet>=2.1.0)
  Downloading entmax-1.3-py3-none-any.whl.metadata (348 bytes)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (0.27.0)
Collecting jsonargparse==3.13.1 (from unbabel-comet>=2.1.0)
  Downloading jsonargparse-3.13.1-py3-none-any.whl.metadata (55 kB)
Requirement already satisfied: numpy<2.0.0,>=1.20.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (1.26.4)
Requirement already satisfied: pandas>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.2.2)
Collecting protobuf<5.0.0,>=4.24.4 (from unbabel-comet>=2.1.0)
  Downloading protobuf-4.25.8-cp37-abi3-manylinux2014_x86_64.whl.metadata (541 bytes)
Requirement already satisfied: pytorch-lightning<3.0.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.5.0.post0)
Requirement already satisfied: sacrebleu<3.0.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.4.3)
Requirement already satisfied: scipy<2.0.0,>=1.5.4 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (1.14.0)
Requirement already satisfied: sentencepiece<0.3.0,>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (0.2.0)
Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (2.5.0a0+e000cf0ad9.nv24.10)
Collecting torchmetrics<0.11.0,>=0.10.2 (from unbabel-comet>=2.1.0)
  Downloading torchmetrics-0.10.3-py3-none-any.whl.metadata (15 kB)
Requirement already satisfied: transformers<5.0,>=4.17 in /usr/local/lib/python3.10/dist-packages (from unbabel-comet>=2.1.0) (4.45.1)
Requirement already satisfied: PyYAML>=3.13 in /usr/local/lib/python3.10/dist-packages (from jsonargparse==3.13.1->unbabel-comet>=2.1.0) (6.0.2)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.16.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2024.6.1)
Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (23.2)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2.32.3)
Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (4.67.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (4.12.2)
Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2023.4)
Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.1->unbabel-comet>=2.1.0) (2024.1)
Requirement already satisfied: lightning-utilities>=0.10.0 in /usr/local/lib/python3.10/dist-packages/lightning_utilities-0.11.7-py3.10.egg (from pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.11.7)
Requirement already satisfied: portalocker in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (3.0.0)
Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (2024.9.11)
Requirement already satisfied: tabulate>=0.8.9 in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.9.0)
Requirement already satisfied: colorama in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (0.4.6)
Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from sacrebleu<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (5.3.0)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->unbabel-comet>=2.1.0) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.6.0->unbabel-comet>=2.1.0) (1.3.0)
Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers<5.0,>=4.17->unbabel-comet>=2.1.0) (0.4.5)
Requirement already satisfied: tokenizers<0.21,>=0.20 in /usr/local/lib/python3.10/dist-packages (from transformers<5.0,>=4.17->unbabel-comet>=2.1.0) (0.20.3)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (3.10.5)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from lightning-utilities>=0.10.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (70.3.0)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas>=1.4.1->unbabel-comet>=2.1.0) (1.16.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->unbabel-comet>=2.1.0) (2.1.5)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.4.0)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (1.26.20)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub<1.0,>=0.19.3->unbabel-comet>=2.1.0) (2024.8.30)
Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (2.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.3.1)
Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (24.2.0)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.4.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (6.0.5)
Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (1.9.4)
Requirement already satisfied: async-timeout<5.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2022.5.0->pytorch-lightning<3.0.0,>=2.0.0->unbabel-comet>=2.1.0) (4.0.3)
Downloading unbabel_comet-2.2.6-py3-none-any.whl (90 kB)
Downloading jsonargparse-3.13.1-py3-none-any.whl (101 kB)
Downloading entmax-1.3-py3-none-any.whl (13 kB)
Downloading protobuf-4.25.8-cp37-abi3-manylinux2014_x86_64.whl (294 kB)
Downloading torchmetrics-0.10.3-py3-none-any.whl (529 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 529.7/529.7 kB 16.1 MB/s eta 0:00:00
Installing collected packages: protobuf, jsonargparse, torchmetrics, entmax, unbabel-comet
  Attempting uninstall: protobuf
    Found existing installation: protobuf 3.20.3
    Uninstalling protobuf-3.20.3:
      Successfully uninstalled protobuf-3.20.3
  Attempting uninstall: torchmetrics
    Found existing installation: torchmetrics 1.6.0
    Uninstalling torchmetrics-1.6.0:
      Successfully uninstalled torchmetrics-1.6.0
Successfully installed entmax-1.3 jsonargparse-3.13.1 protobuf-4.25.8 torchmetrics-0.10.3 unbabel-comet-2.2.6
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow-metadata 1.16.1 requires protobuf<4.21,>=3.20.3; python_version < "3.11", but you have protobuf 4.25.8 which is incompatible.
tensorrt-llm 0.15.0.dev2024110500 requires pynvml>=11.5.0, but you have pynvml 11.4.1 which is incompatible.
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.

[notice] A new release of pip is available: 24.2 -> 25.1.1
[notice] To update, run: python -m pip install --upgrade pip
Fetching 5 files:   0%|          | 0/5 [00:00<?, ?it/s]Fetching 5 files:  20%|██        | 1/5 [00:00<00:02,  1.99it/s]Fetching 5 files:  80%|████████  | 4/5 [00:12<00:03,  3.47s/it]Fetching 5 files: 100%|██████████| 5/5 [00:12<00:00,  2.60s/it]
Lightning automatically upgraded your loaded checkpoint from v1.8.2 to v2.5.0.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../../../shared/workspace/povejmo/huggingface_cache/hub/models--Unbabel--wmt22-cometkiwi-da/snapshots/1ad785194e391eebc6c53e2d0776cada8f83179a/checkpoints/model.ckpt`
/usr/local/lib/python3.10/dist-packages/transformers/tokenization_utils_base.py:1617: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be deprecated in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Encoder model frozen.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
Model path: /shared/workspace/povejmo/huggingface_cache/hub/models--Unbabel--wmt22-cometkiwi-da/snapshots/1ad785194e391eebc6c53e2d0776cada8f83179a/checkpoints/model.ckpt
Predicting: 0it [00:00, ?it/s]Predicting:   0%|          | 0/12 [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/12 [00:00<?, ?it/s]Predicting DataLoader 0:   8%|▊         | 1/12 [00:00<00:02,  4.05it/s]Predicting DataLoader 0:  17%|█▋        | 2/12 [00:00<00:01,  7.62it/s]Predicting DataLoader 0:  25%|██▌       | 3/12 [00:00<00:00, 10.92it/s]Predicting DataLoader 0:  33%|███▎      | 4/12 [00:00<00:00, 13.83it/s]Predicting DataLoader 0:  42%|████▏     | 5/12 [00:00<00:00, 16.38it/s]Predicting DataLoader 0:  50%|█████     | 6/12 [00:00<00:00, 18.59it/s]Predicting DataLoader 0:  58%|█████▊    | 7/12 [00:00<00:00, 20.39it/s]Predicting DataLoader 0:  67%|██████▋   | 8/12 [00:00<00:00, 21.93it/s]Predicting DataLoader 0:  75%|███████▌  | 9/12 [00:00<00:00, 23.40it/s]Predicting DataLoader 0:  83%|████████▎ | 10/12 [00:00<00:00, 24.82it/s]Predicting DataLoader 0:  92%|█████████▏| 11/12 [00:00<00:00, 26.15it/s]Predicting DataLoader 0: 100%|██████████| 12/12 [00:00<00:00, 27.20it/s]Predicting DataLoader 0: 100%|██████████| 12/12 [00:00<00:00, 26.54it/s]
Dataset score: 0.707927112516604
COMET scoring done
cpu-bind=MASK - ixh, task  0  0 [2267117]: mask 0x30000000000000000000000000003 set
from argparse import ArgumentParser
from nemo_curator import ScoreFilter
from nemo_curator.datasets import DocumentDataset
from nemo_curator.filters import FastTextLangId
from nemo_curator.utils.distributed_utils import get_client, read_data
from nemo_curator.utils.file_utils import get_all_files_paths_under, separate_by_metadata
from nemo_curator.utils.script_utils import ArgumentHelper
import pandas as pd
import json
running main...
cuDF Spilling is enabled
Prepared client
------------------------------------------------------------
Performing language identification on the data at path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_1_0.jsonl
------------------------------------------------------------
Input data path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_1_0.jsonl
Output data path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_1_id0
Reading files:  ['/ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_1_0.jsonl']
Reading 1 files with blocksize=None / files_per_partition=1
from argparse import ArgumentParser
from nemo_curator import ScoreFilter
from nemo_curator.datasets import DocumentDataset
from nemo_curator.filters import FastTextLangId
from nemo_curator.utils.distributed_utils import get_client, read_data
from nemo_curator.utils.file_utils import get_all_files_paths_under, separate_by_metadata
from nemo_curator.utils.script_utils import ArgumentHelper
import pandas as pd
import json
cpu-bind=MASK - ixh, task  0  0 [2270140]: mask 0x30000000000000000000000000003 set
from argparse import ArgumentParser
from nemo_curator import ScoreFilter
from nemo_curator.datasets import DocumentDataset
from nemo_curator.filters import FastTextLangId
from nemo_curator.utils.distributed_utils import get_client, read_data
from nemo_curator.utils.file_utils import get_all_files_paths_under, separate_by_metadata
from nemo_curator.utils.script_utils import ArgumentHelper
import pandas as pd
import json
running main...
cuDF Spilling is enabled
Prepared client
------------------------------------------------------------
Performing language identification on the data at path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_2_0.jsonl
------------------------------------------------------------
Input data path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_2_0.jsonl
Output data path: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_2_id0
Reading files:  ['/ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/translations_with_scores/translation_2_0.jsonl']
Reading 1 files with blocksize=None / files_per_partition=1
from argparse import ArgumentParser
from nemo_curator import ScoreFilter
from nemo_curator.datasets import DocumentDataset
from nemo_curator.filters import FastTextLangId
from nemo_curator.utils.distributed_utils import get_client, read_data
from nemo_curator.utils.file_utils import get_all_files_paths_under, separate_by_metadata
from nemo_curator.utils.script_utils import ArgumentHelper
import pandas as pd
import json
cpu-bind=MASK - ixh, task  0  0 [2273554]: mask 0x30000000000000000000000000003 set
************************************************************
Processing data with id 1
************************************************************
------------------------------
Loading data from: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_1_id0
------------------------------
(91, 9)
Slovene Count: 72
Non-Slovene Count: 15
2 percentile:  0.593840003658658
5 percentile:  0.790038661082288
10 percentile:  0.8508625486922649
90 percentile:  1.0903790087463556
95 percentile:  1.2080596606458676
98 percentile:  1.5375526271027238
------------------------------
Loading data from: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_2_id0
------------------------------
(91, 9)
Slovene Count: 84
Non-Slovene Count: 7
2 percentile:  0.08368245768899057
5 percentile:  0.572955112771143
10 percentile:  0.7591385331781141
90 percentile:  1.1006944444444444
95 percentile:  1.1374270557029178
98 percentile:  1.160442396313364
------------------------------

IDs match: 88
Fields of the joined dataframe:
 - Prompt_1
 - comet_score_1
 - id
 - sl_translation_1
 - language_1
 - relative_length_1
 - Prompt_2
 - comet_score_2
 - sl_translation_2
 - text
 - title
 - url
 - language_2
 - relative_length_2
Shape of the joined dataframe: (88, 14)
Paired data saved to: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/paired_data/paired_data_id0.jsonl
************************************************************
Processing data with id 2
************************************************************
------------------------------
Loading data from: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_1_id0
------------------------------
(91, 9)
Slovene Count: 72
Non-Slovene Count: 15
2 percentile:  0.593840003658658
5 percentile:  0.790038661082288
10 percentile:  0.8508625486922649
90 percentile:  1.0903790087463556
95 percentile:  1.2080596606458676
98 percentile:  1.5375526271027238
------------------------------
Loading data from: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/language_id/language_id_2_id0
------------------------------
(91, 9)
Slovene Count: 84
Non-Slovene Count: 7
2 percentile:  0.08368245768899057
5 percentile:  0.572955112771143
10 percentile:  0.7591385331781141
90 percentile:  1.1006944444444444
95 percentile:  1.1374270557029178
98 percentile:  1.160442396313364
------------------------------

IDs match: 88
Fields of the joined dataframe:
 - Prompt_1
 - comet_score_1
 - id
 - sl_translation_1
 - language_1
 - relative_length_1
 - Prompt_2
 - comet_score_2
 - sl_translation_2
 - text
 - title
 - url
 - language_2
 - relative_length_2
Shape of the joined dataframe: (88, 14)
Paired data saved to: /ceph/hpc/data/s24o01-42-users/translation_optimization/data_pipeline/full_test/paired_data/paired_data_id0.jsonl
cpu-bind=MASK - ixh, task  0  0 [2274632]: mask 0x30000000000000000000000000003 set
/ceph/hpc/data/s24o01-42-users/translation_optimization/language_identification/../preference_data/generic_scripts/bad_format_examples.py:69: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  gams_data["sl_translation_2"] = gams_data["sl_translation_1"].apply(add_bad_start)
/ceph/hpc/data/s24o01-42-users/translation_optimization/language_identification/../preference_data/generic_scripts/bad_format_examples.py:81: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  eurollm_data["sl_translation_1"] = eurollm_data["sl_translation_2"].apply(add_bad_start)
Shape of the data: (88, 14)
Shape of the data with both translations in Slovene: (67, 14)
Shape of the data with translations longer than the threshold: (62, 14)
--------------------------------------------------
Shape of the gams_data data: (2, 14)
Shape of the eurollm_data data: (7, 14)
--------------------------------------------------
Shape of the gams_data data after formatting: (2, 6)
 - prompt
 - chosen_score
 - chosen
 - rejected_score
 - rejected
 - src
Shape of the eurollm_data data after formatting: (7, 6)
 - prompt
 - rejected_score
 - rejected
 - chosen_score
 - chosen
 - src
cpu-bind=MASK - ixh, task  0  0 [2275428]: mask 0x30000000000000000000000000003 set
Shape of the data: (88, 14)
Shape of the gams_sl data: (4, 4)
 - prompt
 - chosen
 - rejected
 - src
Shape of the eurollm_sl data: (13, 4)
 - prompt
 - rejected
 - chosen
 - src
Shape of the bad_lang_examples data: (17, 4)
cpu-bind=MASK - ixh, task  0  0 [2276563]: mask 0x30000000000000000000000000003 set
Shape of the data: (88, 14)
Shape of the data with both translations in Slovene: (67, 14)
Shape of the data with translations longer than the threshold: (62, 14)
--------------------------------------------------
Shape of the gams_better data: (6, 14)
Shape of the eurollm_better data: (3, 14)
--------------------------------------------------
Shape of the gams_better data after formatting: (6, 6)
 - prompt
 - chosen_score
 - chosen
 - rejected_score
 - rejected
 - src
Shape of the eurollm_better data after formatting: (3, 6)
 - prompt
 - rejected_score
 - rejected
 - chosen_score
 - chosen
 - src
cpu-bind=MASK - ixh, task  0  0 [2277138]: mask 0x30000000000000000000000000003 set
Shape of all data: (88, 14)
Shape of the data with both translations in Slovene: (67, 14)
Shape of the gams_better data: (0, 4)
 - prompt
 - chosen
 - rejected
 - src
Shape of the eurollm_better data: (2, 4)
 - prompt
 - rejected
 - chosen
 - src
Shape of the short_examples data: (2, 4)
