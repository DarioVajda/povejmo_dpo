  0%|          | 0/1257 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 17%|█▋        | 209/1257 [12:36<52:27,  3.00s//usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.7079, 'grad_norm': 44.11615753173828, 'learning_rate': 8.61244019138756e-09, 'rewards/chosen': -0.005897140596061945, 'rewards/rejected': 0.01591339148581028, 'rewards/accuracies': 0.25, 'rewards/margins': -0.02186126634478569, 'logps/chosen': -107.32499694824219, 'logps/rejected': -118.19999694824219, 'logits/chosen': -6.865624904632568, 'logits/rejected': -6.871874809265137, 'epoch': 0.02}
{'loss': 0.6907, 'grad_norm': 37.13799285888672, 'learning_rate': 1.818181818181818e-08, 'rewards/chosen': -0.0021942139137536287, 'rewards/rejected': -0.011845397762954235, 'rewards/accuracies': 0.4124999940395355, 'rewards/margins': 0.009616089053452015, 'logps/chosen': -78.25, 'logps/rejected': -86.0999984741211, 'logits/chosen': -6.925000190734863, 'logits/rejected': -7.037499904632568, 'epoch': 0.05}
{'loss': 0.7029, 'grad_norm': 63.02373123168945, 'learning_rate': 2.7751196172248803e-08, 'rewards/chosen': -0.0015777588123455644, 'rewards/rejected': 0.013105010613799095, 'rewards/accuracies': 0.41874998807907104, 'rewards/margins': -0.014691161923110485, 'logps/chosen': -109.625, 'logps/rejected': -119.17500305175781, 'logits/chosen': -6.724999904632568, 'logits/rejected': -6.731249809265137, 'epoch': 0.07}
{'loss': 0.7095, 'grad_norm': 57.67646026611328, 'learning_rate': 3.7320574162679424e-08, 'rewards/chosen': -0.018898773938417435, 'rewards/rejected': 0.0074020386673510075, 'rewards/accuracies': 0.35624998807907104, 'rewards/margins': -0.02633972093462944, 'logps/chosen': -73.82499694824219, 'logps/rejected': -81.92500305175781, 'logits/chosen': -6.996874809265137, 'logits/rejected': -6.962500095367432, 'epoch': 0.1}
{'loss': 0.6862, 'grad_norm': 79.5589370727539, 'learning_rate': 4.688995215311005e-08, 'rewards/chosen': 0.01038360595703125, 'rewards/rejected': -0.01090087927877903, 'rewards/accuracies': 0.48124998807907104, 'rewards/margins': 0.02126159705221653, 'logps/chosen': -105.8499984741211, 'logps/rejected': -113.7750015258789, 'logits/chosen': -6.940625190734863, 'logits/rejected': -6.884375095367432, 'epoch': 0.12}
{'loss': 0.6884, 'grad_norm': 51.69246292114258, 'learning_rate': 5.645933014354066e-08, 'rewards/chosen': -0.009498787112534046, 'rewards/rejected': -0.02595062181353569, 'rewards/accuracies': 0.4437499940395355, 'rewards/margins': 0.01650390587747097, 'logps/chosen': -77.4749984741211, 'logps/rejected': -99.05000305175781, 'logits/chosen': -6.846875190734863, 'logits/rejected': -6.768750190734863, 'epoch': 0.14}
{'loss': 0.698, 'grad_norm': 42.77836227416992, 'learning_rate': 6.602870813397129e-08, 'rewards/chosen': 0.0042724609375, 'rewards/rejected': 0.0038658143021166325, 'rewards/accuracies': 0.4437499940395355, 'rewards/margins': 0.0003974914434365928, 'logps/chosen': -124.4749984741211, 'logps/rejected': -126.7249984741211, 'logits/chosen': -6.946875095367432, 'logits/rejected': -6.903124809265137, 'epoch': 0.17}
{'loss': 0.6825, 'grad_norm': 56.31784439086914, 'learning_rate': 7.559808612440191e-08, 'rewards/chosen': 0.01879424974322319, 'rewards/rejected': -0.0017303467029705644, 'rewards/accuracies': 0.5062500238418579, 'rewards/margins': 0.02054138109087944, 'logps/chosen': -84.94999694824219, 'logps/rejected': -97.7249984741211, 'logits/chosen': -6.909375190734863, 'logits/rejected': -6.846875190734863, 'epoch': 0.19}
{'loss': 0.6992, 'grad_norm': 49.54961395263672, 'learning_rate': 8.516746411483253e-08, 'rewards/chosen': -0.0059570311568677425, 'rewards/rejected': 0.0005397796630859375, 'rewards/accuracies': 0.44999998807907104, 'rewards/margins': -0.006488037295639515, 'logps/chosen': -76.3499984741211, 'logps/rejected': -91.55000305175781, 'logits/chosen': -6.981249809265137, 'logits/rejected': -6.837500095367432, 'epoch': 0.21}
{'loss': 0.6862, 'grad_norm': 51.40652847290039, 'learning_rate': 9.473684210526315e-08, 'rewards/chosen': 0.00423431396484375, 'rewards/rejected': -0.01847228966653347, 'rewards/accuracies': 0.5375000238418579, 'rewards/margins': 0.022705078125, 'logps/chosen': -81.94999694824219, 'logps/rejected': -90.2750015258789, 'logits/chosen': -7.134375095367432, 'logits/rejected': -7.074999809265137, 'epoch': 0.24}
{'loss': 0.6963, 'grad_norm': 44.942073822021484, 'learning_rate': 1.0430622009569377e-07, 'rewards/chosen': -0.00051116943359375, 'rewards/rejected': 0.00156402587890625, 'rewards/accuracies': 0.41874998807907104, 'rewards/margins': -0.0020515441428869963, 'logps/chosen': -102.57499694824219, 'logps/rejected': -105.17500305175781, 'logits/chosen': -6.965624809265137, 'logits/rejected': -6.778124809265137, 'epoch': 0.26}
{'loss': 0.6811, 'grad_norm': 41.7442626953125, 'learning_rate': 1.138755980861244e-07, 'rewards/chosen': 0.00966796837747097, 'rewards/rejected': -0.01701660081744194, 'rewards/accuracies': 0.4749999940395355, 'rewards/margins': 0.02669067308306694, 'logps/chosen': -109.1500015258789, 'logps/rejected': -117.80000305175781, 'logits/chosen': -6.806250095367432, 'logits/rejected': -6.762499809265137, 'epoch': 0.29}
{'loss': 0.6869, 'grad_norm': 52.97516632080078, 'learning_rate': 1.2344497607655502e-07, 'rewards/chosen': 0.037767790257930756, 'rewards/rejected': 0.001434326171875, 'rewards/accuracies': 0.5249999761581421, 'rewards/margins': 0.03624267503619194, 'logps/chosen': -168.10000610351562, 'logps/rejected': -168.3000030517578, 'logits/chosen': -6.834374904632568, 'logits/rejected': -6.728125095367432, 'epoch': 0.31}
{'loss': 0.6823, 'grad_norm': 54.44196319580078, 'learning_rate': 1.3301435406698566e-07, 'rewards/chosen': 0.03344116359949112, 'rewards/rejected': -0.0036819458473473787, 'rewards/accuracies': 0.581250011920929, 'rewards/margins': 0.03711547702550888, 'logps/chosen': -82.55000305175781, 'logps/rejected': -92.5250015258789, 'logits/chosen': -6.9375, 'logits/rejected': -6.868750095367432, 'epoch': 0.33}
{'loss': 0.6997, 'grad_norm': 49.40614700317383, 'learning_rate': 1.4258373205741624e-07, 'rewards/chosen': 0.04903564602136612, 'rewards/rejected': 0.01407775841653347, 'rewards/accuracies': 0.606249988079071, 'rewards/margins': 0.0350189208984375, 'logps/chosen': -115.75, 'logps/rejected': -114.4000015258789, 'logits/chosen': -6.862500190734863, 'logits/rejected': -6.878125190734863, 'epoch': 0.36}
{'loss': 0.663, 'grad_norm': 48.30611801147461, 'learning_rate': 1.5215311004784688e-07, 'rewards/chosen': 0.032935332506895065, 'rewards/rejected': -0.04241027683019638, 'rewards/accuracies': 0.625, 'rewards/margins': 0.07542724907398224, 'logps/chosen': -78.92500305175781, 'logps/rejected': -90.2249984741211, 'logits/chosen': -6.978125095367432, 'logits/rejected': -6.956250190734863, 'epoch': 0.38}
{'loss': 0.6399, 'grad_norm': 39.428279876708984, 'learning_rate': 1.617224880382775e-07, 'rewards/chosen': 0.07791747897863388, 'rewards/rejected': -0.045257568359375, 'rewards/accuracies': 0.7124999761581421, 'rewards/margins': 0.12321777641773224, 'logps/chosen': -75.69999694824219, 'logps/rejected': -76.0250015258789, 'logits/chosen': -7.134375095367432, 'logits/rejected': -7.165625095367432, 'epoch': 0.41}
{'loss': 0.6667, 'grad_norm': 63.21663284301758, 'learning_rate': 1.7129186602870813e-07, 'rewards/chosen': 0.04994506761431694, 'rewards/rejected': -0.0341796875, 'rewards/accuracies': 0.625, 'rewards/margins': 0.08409424126148224, 'logps/chosen': -83.9749984741211, 'logps/rejected': -107.8499984741211, 'logits/chosen': -6.893750190734863, 'logits/rejected': -6.959374904632568, 'epoch': 0.43}
{'loss': 0.6485, 'grad_norm': 49.95159912109375, 'learning_rate': 1.8086124401913874e-07, 'rewards/chosen': 0.07839278876781464, 'rewards/rejected': -0.054718017578125, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.13310547173023224, 'logps/chosen': -85.6500015258789, 'logps/rejected': -109.75, 'logits/chosen': -6.868750095367432, 'logits/rejected': -6.815625190734863, 'epoch': 0.45}
{'loss': 0.6304, 'grad_norm': 37.77731704711914, 'learning_rate': 1.9043062200956935e-07, 'rewards/chosen': 0.07184753566980362, 'rewards/rejected': -0.08400879055261612, 'rewards/accuracies': 0.706250011920929, 'rewards/margins': 0.15576171875, 'logps/chosen': -76.9000015258789, 'logps/rejected': -92.6500015258789, 'logits/chosen': -7.053124904632568, 'logits/rejected': -6.996874809265137, 'epoch': 0.48}
  warnings.warn(                               
{'eval_loss': 0.6068689823150635, 'eval_runtime': 81.0987, 'eval_samples_per_second': 11.751, 'eval_steps_per_second': 0.74, 'eval_rewards/chosen': 0.17922160029411316, 'eval_rewards/rejected': -0.10906100273132324, 'eval_rewards/accuracies': 0.781365692615509, 'eval_rewards/margins': 0.2881062924861908, 'eval_logps/chosen': -358.6333312988281, 'eval_logps/rejected': -158.54583740234375, 'eval_logits/chosen': -6.370312690734863, 'eval_logits/rejected': -6.8963541984558105, 'epoch': 0.5}
 33%|███▎      | 418/1257 [25:20<45:35,  3.26s//usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.5998, 'grad_norm': 42.872657775878906, 'learning_rate': 2e-07, 'rewards/chosen': 0.1312255859375, 'rewards/rejected': -0.10417480766773224, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.23554687201976776, 'logps/chosen': -78.05000305175781, 'logps/rejected': -96.80000305175781, 'logits/chosen': -7.006249904632568, 'logits/rejected': -6.724999904632568, 'epoch': 0.5}
{'loss': 0.6063, 'grad_norm': 36.552005767822266, 'learning_rate': 2.0956937799043063e-07, 'rewards/chosen': 0.117431640625, 'rewards/rejected': -0.09949340671300888, 'rewards/accuracies': 0.7250000238418579, 'rewards/margins': 0.216552734375, 'logps/chosen': -124.4000015258789, 'logps/rejected': -128.875, 'logits/chosen': -6.890625, 'logits/rejected': -6.912499904632568, 'epoch': 0.53}
{'loss': 0.5906, 'grad_norm': 52.846744537353516, 'learning_rate': 2.1913875598086124e-07, 'rewards/chosen': 0.13874511420726776, 'rewards/rejected': -0.12910155951976776, 'rewards/accuracies': 0.7250000238418579, 'rewards/margins': 0.2681640684604645, 'logps/chosen': -90.0, 'logps/rejected': -110.82499694824219, 'logits/chosen': -6.946875095367432, 'logits/rejected': -6.756249904632568, 'epoch': 0.55}
{'loss': 0.5909, 'grad_norm': 45.07136917114258, 'learning_rate': 2.2870813397129188e-07, 'rewards/chosen': 0.1320953369140625, 'rewards/rejected': -0.15039673447608948, 'rewards/accuracies': 0.7124999761581421, 'rewards/margins': 0.2826294004917145, 'logps/chosen': -83.44999694824219, 'logps/rejected': -101.5999984741211, 'logits/chosen': -7.181250095367432, 'logits/rejected': -6.918749809265137, 'epoch': 0.57}
{'loss': 0.5451, 'grad_norm': 35.82921600341797, 'learning_rate': 2.382775119617225e-07, 'rewards/chosen': 0.21923828125, 'rewards/rejected': -0.18349608778953552, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.4029296934604645, 'logps/chosen': -71.0, 'logps/rejected': -81.73750305175781, 'logits/chosen': -7.050000190734863, 'logits/rejected': -7.012499809265137, 'epoch': 0.6}
{'loss': 0.5702, 'grad_norm': 79.25953674316406, 'learning_rate': 2.478468899521531e-07, 'rewards/chosen': 0.16276855766773224, 'rewards/rejected': -0.18479004502296448, 'rewards/accuracies': 0.7250000238418579, 'rewards/margins': 0.3475585877895355, 'logps/chosen': -79.67500305175781, 'logps/rejected': -89.2750015258789, 'logits/chosen': -6.956250190734863, 'logits/rejected': -6.834374904632568, 'epoch': 0.62}
{'loss': 0.5311, 'grad_norm': 48.597923278808594, 'learning_rate': 2.574162679425837e-07, 'rewards/chosen': 0.20517578721046448, 'rewards/rejected': -0.280548095703125, 'rewards/accuracies': 0.768750011920929, 'rewards/margins': 0.4854492247104645, 'logps/chosen': -73.25, 'logps/rejected': -93.0, 'logits/chosen': -6.918749809265137, 'logits/rejected': -6.787499904632568, 'epoch': 0.64}
{'loss': 0.5658, 'grad_norm': 53.1495246887207, 'learning_rate': 2.669856459330143e-07, 'rewards/chosen': 0.16889648139476776, 'rewards/rejected': -0.2236328125, 'rewards/accuracies': 0.668749988079071, 'rewards/margins': 0.39238280057907104, 'logps/chosen': -80.55000305175781, 'logps/rejected': -100.5999984741211, 'logits/chosen': -6.987500190734863, 'logits/rejected': -6.881249904632568, 'epoch': 0.67}
{'loss': 0.4799, 'grad_norm': 49.96671676635742, 'learning_rate': 2.76555023923445e-07, 'rewards/chosen': 0.320068359375, 'rewards/rejected': -0.3592773377895355, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.6796875, 'logps/chosen': -84.125, 'logps/rejected': -87.57499694824219, 'logits/chosen': -7.293749809265137, 'logits/rejected': -7.199999809265137, 'epoch': 0.69}
{'loss': 0.541, 'grad_norm': 35.683597564697266, 'learning_rate': 2.861244019138756e-07, 'rewards/chosen': 0.22062988579273224, 'rewards/rejected': -0.28388673067092896, 'rewards/accuracies': 0.7562500238418579, 'rewards/margins': 0.5042968988418579, 'logps/chosen': -76.8499984741211, 'logps/rejected': -97.44999694824219, 'logits/chosen': -7.0, 'logits/rejected': -6.821875095367432, 'epoch': 0.72}
{'loss': 0.5267, 'grad_norm': 40.092491149902344, 'learning_rate': 2.956937799043062e-07, 'rewards/chosen': 0.21738281846046448, 'rewards/rejected': -0.33696287870407104, 'rewards/accuracies': 0.762499988079071, 'rewards/margins': 0.554394543170929, 'logps/chosen': -97.07499694824219, 'logps/rejected': -103.7750015258789, 'logits/chosen': -7.003125190734863, 'logits/rejected': -6.890625, 'epoch': 0.74}
{'loss': 0.4917, 'grad_norm': 41.1744499206543, 'learning_rate': 3.052631578947368e-07, 'rewards/chosen': 0.24777832627296448, 'rewards/rejected': -0.4423828125, 'rewards/accuracies': 0.762499988079071, 'rewards/margins': 0.6900390386581421, 'logps/chosen': -76.57499694824219, 'logps/rejected': -88.4749984741211, 'logits/chosen': -7.346875190734863, 'logits/rejected': -7.081250190734863, 'epoch': 0.76}
{'loss': 0.4473, 'grad_norm': 33.39152145385742, 'learning_rate': 3.148325358851675e-07, 'rewards/chosen': 0.2612548768520355, 'rewards/rejected': -0.493896484375, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 0.754687488079071, 'logps/chosen': -107.9749984741211, 'logps/rejected': -112.94999694824219, 'logits/chosen': -7.034375190734863, 'logits/rejected': -6.971875190734863, 'epoch': 0.79}
{'loss': 0.4591, 'grad_norm': 30.013349533081055, 'learning_rate': 3.2440191387559805e-07, 'rewards/chosen': 0.30634766817092896, 'rewards/rejected': -0.4927734434604645, 'rewards/accuracies': 0.7875000238418579, 'rewards/margins': 0.7992187738418579, 'logps/chosen': -71.875, 'logps/rejected': -89.4000015258789, 'logits/chosen': -7.418749809265137, 'logits/rejected': -7.165625095367432, 'epoch': 0.81}
{'loss': 0.4933, 'grad_norm': 42.41319274902344, 'learning_rate': 3.3397129186602866e-07, 'rewards/chosen': 0.23115234076976776, 'rewards/rejected': -0.550976574420929, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.782031238079071, 'logps/chosen': -86.17500305175781, 'logps/rejected': -99.9000015258789, 'logits/chosen': -7.328125, 'logits/rejected': -7.1875, 'epoch': 0.84}
{'loss': 0.4783, 'grad_norm': 37.073272705078125, 'learning_rate': 3.435406698564593e-07, 'rewards/chosen': 0.32573240995407104, 'rewards/rejected': -0.544140636920929, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.869140625, 'logps/chosen': -118.2249984741211, 'logps/rejected': -137.78750610351562, 'logits/chosen': -7.206250190734863, 'logits/rejected': -7.025000095367432, 'epoch': 0.86}
{'loss': 0.4056, 'grad_norm': 35.12616729736328, 'learning_rate': 3.5311004784688993e-07, 'rewards/chosen': 0.3667968809604645, 'rewards/rejected': -0.6595703363418579, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.0265624523162842, 'logps/chosen': -86.125, 'logps/rejected': -84.55000305175781, 'logits/chosen': -7.118750095367432, 'logits/rejected': -7.059374809265137, 'epoch': 0.88}
{'loss': 0.4138, 'grad_norm': 32.46837615966797, 'learning_rate': 3.6267942583732054e-07, 'rewards/chosen': 0.31010740995407104, 'rewards/rejected': -0.7291015386581421, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 1.039453148841858, 'logps/chosen': -74.5999984741211, 'logps/rejected': -91.9000015258789, 'logits/chosen': -7.224999904632568, 'logits/rejected': -7.074999809265137, 'epoch': 0.91}
{'loss': 0.3598, 'grad_norm': 26.545085906982422, 'learning_rate': 3.722488038277512e-07, 'rewards/chosen': 0.41357421875, 'rewards/rejected': -0.783203125, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 1.196874976158142, 'logps/chosen': -71.0250015258789, 'logps/rejected': -83.8499984741211, 'logits/chosen': -7.425000190734863, 'logits/rejected': -7.387499809265137, 'epoch': 0.93}
{'loss': 0.4296, 'grad_norm': 52.976104736328125, 'learning_rate': 3.818181818181818e-07, 'rewards/chosen': 0.24882812798023224, 'rewards/rejected': -0.8238281011581421, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 1.0730469226837158, 'logps/chosen': -73.125, 'logps/rejected': -90.125, 'logits/chosen': -7.490624904632568, 'logits/rejected': -7.215624809265137, 'epoch': 0.95}
{'loss': 0.4165, 'grad_norm': 41.68259048461914, 'learning_rate': 3.9138755980861243e-07, 'rewards/chosen': 0.21873168647289276, 'rewards/rejected': -0.958984375, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.1789062023162842, 'logps/chosen': -80.07499694824219, 'logps/rejected': -92.0999984741211, 'logits/chosen': -7.28125, 'logits/rejected': -7.175000190734863, 'epoch': 0.98}
  warnings.warn(                               
{'eval_loss': 0.4553671181201935, 'eval_runtime': 80.6563, 'eval_samples_per_second': 11.816, 'eval_steps_per_second': 0.744, 'eval_rewards/chosen': 0.3358464539051056, 'eval_rewards/rejected': -1.0985249280929565, 'eval_rewards/accuracies': 0.7961805462837219, 'eval_rewards/margins': 1.4346109628677368, 'eval_logps/chosen': -357.98333740234375, 'eval_logps/rejected': -163.4875030517578, 'eval_logits/chosen': -6.796354293823242, 'eval_logits/rejected': -7.189062595367432, 'epoch': 1.0}
 50%|████▉     | 627/1257 [37:55<35:52,  3.42s//usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.4235, 'grad_norm': 35.430912017822266, 'learning_rate': 3.999987381206723e-07, 'rewards/chosen': 0.31724852323532104, 'rewards/rejected': -1.234375, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.550195336341858, 'logps/chosen': -95.0, 'logps/rejected': -100.4749984741211, 'logits/chosen': -7.337500095367432, 'logits/rejected': -7.109375, 'epoch': 1.0}
{'loss': 0.3531, 'grad_norm': 26.079008102416992, 'learning_rate': 3.998473340082952e-07, 'rewards/chosen': 0.29931640625, 'rewards/rejected': -1.0476562976837158, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.347265601158142, 'logps/chosen': -112.5250015258789, 'logps/rejected': -128.125, 'logits/chosen': -7.415625095367432, 'logits/rejected': -7.234375, 'epoch': 1.03}
{'loss': 0.3739, 'grad_norm': 29.99326515197754, 'learning_rate': 3.9944379724837345e-07, 'rewards/chosen': 0.34687501192092896, 'rewards/rejected': -1.156640648841858, 'rewards/accuracies': 0.8374999761581421, 'rewards/margins': 1.50390625, 'logps/chosen': -76.82499694824219, 'logps/rejected': -97.42500305175781, 'logits/chosen': -7.418749809265137, 'logits/rejected': -7.262499809265137, 'epoch': 1.05}
{'loss': 0.3819, 'grad_norm': 61.01665496826172, 'learning_rate': 3.98788693569569e-07, 'rewards/chosen': 0.3238769471645355, 'rewards/rejected': -1.172265648841858, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 1.498437523841858, 'logps/chosen': -72.5999984741211, 'logps/rejected': -84.2249984741211, 'logits/chosen': -7.553124904632568, 'logits/rejected': -7.328125, 'epoch': 1.07}
{'loss': 0.3764, 'grad_norm': 51.467430114746094, 'learning_rate': 3.978829413787401e-07, 'rewards/chosen': 0.4288574159145355, 'rewards/rejected': -1.1380615234375, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 1.5675780773162842, 'logps/chosen': -136.375, 'logps/rejected': -145.5749969482422, 'logits/chosen': -7.606249809265137, 'logits/rejected': -7.440625190734863, 'epoch': 1.1}
{'loss': 0.3593, 'grad_norm': 42.330833435058594, 'learning_rate': 3.9672781047340214e-07, 'rewards/chosen': 0.31611329317092896, 'rewards/rejected': -1.4773437976837158, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.79296875, 'logps/chosen': -75.2750015258789, 'logps/rejected': -94.32499694824219, 'logits/chosen': -7.621874809265137, 'logits/rejected': -7.334374904632568, 'epoch': 1.12}
{'loss': 0.3833, 'grad_norm': 25.8663330078125, 'learning_rate': 3.95324920261566e-07, 'rewards/chosen': 0.21075439453125, 'rewards/rejected': -1.3992187976837158, 'rewards/accuracies': 0.8374999761581421, 'rewards/margins': 1.609375, 'logps/chosen': -80.0, 'logps/rejected': -110.80000305175781, 'logits/chosen': -7.715624809265137, 'logits/rejected': -7.321875095367432, 'epoch': 1.15}
{'loss': 0.3082, 'grad_norm': 33.898590087890625, 'learning_rate': 3.9367623749144775e-07, 'rewards/chosen': 0.2670654356479645, 'rewards/rejected': -1.514062523841858, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 1.778906226158142, 'logps/chosen': -75.3499984741211, 'logps/rejected': -82.44999694824219, 'logits/chosen': -7.675000190734863, 'logits/rejected': -7.690625190734863, 'epoch': 1.17}
{'loss': 0.3032, 'grad_norm': 36.07081604003906, 'learning_rate': 3.917840734942332e-07, 'rewards/chosen': 0.27894288301467896, 'rewards/rejected': -1.4246094226837158, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 1.7023437023162842, 'logps/chosen': -110.30000305175781, 'logps/rejected': -121.0250015258789, 'logits/chosen': -7.6875, 'logits/rejected': -7.459374904632568, 'epoch': 1.19}
{'loss': 0.3503, 'grad_norm': 53.87834548950195, 'learning_rate': 3.89651080943763e-07, 'rewards/chosen': 0.17178955674171448, 'rewards/rejected': -1.622656226158142, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7937500476837158, 'logps/chosen': -79.9749984741211, 'logps/rejected': -115.55000305175781, 'logits/chosen': -7.709374904632568, 'logits/rejected': -7.243750095367432, 'epoch': 1.22}
{'loss': 0.3178, 'grad_norm': 55.06425857543945, 'learning_rate': 3.872802501376797e-07, 'rewards/chosen': 0.07047118991613388, 'rewards/rejected': -1.7468750476837158, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 1.8203125, 'logps/chosen': -79.1500015258789, 'logps/rejected': -98.69999694824219, 'logits/chosen': -7.740624904632568, 'logits/rejected': -7.584374904632568, 'epoch': 1.24}
{'loss': 0.3018, 'grad_norm': 23.633052825927734, 'learning_rate': 3.846749048052527e-07, 'rewards/chosen': 0.04799804836511612, 'rewards/rejected': -1.7921874523162842, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 1.83984375, 'logps/chosen': -76.2249984741211, 'logps/rejected': -105.69999694824219, 'logits/chosen': -7.706250190734863, 'logits/rejected': -7.390625, 'epoch': 1.26}
{'loss': 0.3123, 'grad_norm': 236.16282653808594, 'learning_rate': 3.8183869744775487e-07, 'rewards/chosen': 0.05775146558880806, 'rewards/rejected': -1.736718773841858, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 1.795312523841858, 'logps/chosen': -78.4749984741211, 'logps/rejected': -97.92500305175781, 'logits/chosen': -7.659375190734863, 'logits/rejected': -7.428124904632568, 'epoch': 1.29}
{'loss': 0.403, 'grad_norm': 51.67305374145508, 'learning_rate': 3.787756042179271e-07, 'rewards/chosen': 0.10212402045726776, 'rewards/rejected': -1.7234375476837158, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.8250000476837158, 'logps/chosen': -78.30000305175781, 'logps/rejected': -92.7249984741211, 'logits/chosen': -7.765625, 'logits/rejected': -7.596875190734863, 'epoch': 1.31}
{'loss': 0.3376, 'grad_norm': 11.828125953674316, 'learning_rate': 3.7548991934570597e-07, 'rewards/chosen': 0.018829345703125, 'rewards/rejected': -1.911718726158142, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 1.9328124523162842, 'logps/chosen': -83.5999984741211, 'logps/rejected': -119.30000305175781, 'logits/chosen': -7.815625190734863, 'logits/rejected': -7.368750095367432, 'epoch': 1.34}
{'loss': 0.368, 'grad_norm': 38.202247619628906, 'learning_rate': 3.719862491180314e-07, 'rewards/chosen': 0.09018554538488388, 'rewards/rejected': -1.751562476158142, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 1.842187523841858, 'logps/chosen': -79.625, 'logps/rejected': -106.75, 'logits/chosen': -7.875, 'logits/rejected': -7.603125095367432, 'epoch': 1.36}
{'loss': 0.2954, 'grad_norm': 35.86140823364258, 'learning_rate': 3.6826950542117343e-07, 'rewards/chosen': 0.07078246772289276, 'rewards/rejected': -2.07421875, 'rewards/accuracies': 0.8374999761581421, 'rewards/margins': 2.143749952316284, 'logps/chosen': -76.0, 'logps/rejected': -105.0999984741211, 'logits/chosen': -7.890625, 'logits/rejected': -7.659375190734863, 'epoch': 1.38}
{'loss': 0.2782, 'grad_norm': 31.60578727722168, 'learning_rate': 3.6434489885463144e-07, 'rewards/chosen': 0.04975586012005806, 'rewards/rejected': -2.2171874046325684, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.2671875953674316, 'logps/chosen': -78.625, 'logps/rejected': -109.125, 'logits/chosen': -7.784375190734863, 'logits/rejected': -7.446875095367432, 'epoch': 1.41}
{'loss': 0.3041, 'grad_norm': 42.93376159667969, 'learning_rate': 3.6021793142625916e-07, 'rewards/chosen': 0.03153686597943306, 'rewards/rejected': -2.2601561546325684, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.2914061546325684, 'logps/chosen': -71.32499694824219, 'logps/rejected': -93.30000305175781, 'logits/chosen': -7.859375, 'logits/rejected': -7.540625095367432, 'epoch': 1.43}
{'loss': 0.3665, 'grad_norm': 46.94123458862305, 'learning_rate': 3.558943888388572e-07, 'rewards/chosen': 0.13056640326976776, 'rewards/rejected': -1.888281226158142, 'rewards/accuracies': 0.84375, 'rewards/margins': 2.01953125, 'logps/chosen': -74.625, 'logps/rejected': -89.5, 'logits/chosen': -7.881249904632568, 'logits/rejected': -7.596875190734863, 'epoch': 1.46}
{'loss': 0.3619, 'grad_norm': 25.57563018798828, 'learning_rate': 3.513803323790459e-07, 'rewards/chosen': -0.01821289025247097, 'rewards/rejected': -1.9734375476837158, 'rewards/accuracies': 0.8374999761581421, 'rewards/margins': 1.95703125, 'logps/chosen': -85.44999694824219, 'logps/rejected': -101.5999984741211, 'logits/chosen': -7.653124809265137, 'logits/rejected': -7.537499904632568, 'epoch': 1.48}
  warnings.warn(                               
{'eval_loss': 0.5451383590698242, 'eval_runtime': 80.9136, 'eval_samples_per_second': 11.778, 'eval_steps_per_second': 0.742, 'eval_rewards/chosen': 0.1466473937034607, 'eval_rewards/rejected': -2.2100422382354736, 'eval_rewards/accuracies': 0.7680555582046509, 'eval_rewards/margins': 2.3567912578582764, 'eval_logps/chosen': -359.01666259765625, 'eval_logps/rejected': -169.09584045410156, 'eval_logits/chosen': -7.209895610809326, 'eval_logits/rejected': -7.508854389190674, 'epoch': 1.5}
 67%|██████▋   | 836/1257 [50:36<22:25,  3.20s//usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.3823, 'grad_norm': 29.695730209350586, 'learning_rate': 3.466820904197903e-07, 'rewards/chosen': 0.10476074367761612, 'rewards/rejected': -1.8117187023162842, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.9171874523162842, 'logps/chosen': -135.02499389648438, 'logps/rejected': -146.35000610351562, 'logits/chosen': -7.712500095367432, 'logits/rejected': -7.4375, 'epoch': 1.5}
{'loss': 0.3053, 'grad_norm': 29.707489013671875, 'learning_rate': 3.418062495484899e-07, 'rewards/chosen': 0.2623046934604645, 'rewards/rejected': -1.9375, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.2015624046325684, 'logps/chosen': -134.1750030517578, 'logps/rejected': -152.5, 'logits/chosen': -7.787499904632568, 'logits/rejected': -7.540625095367432, 'epoch': 1.53}
{'loss': 0.2833, 'grad_norm': 13.283003807067871, 'learning_rate': 3.3675964533307044e-07, 'rewards/chosen': 0.11068115383386612, 'rewards/rejected': -2.3023438453674316, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.41015625, 'logps/chosen': -84.7750015258789, 'logps/rejected': -96.2750015258789, 'logits/chosen': -7.768750190734863, 'logits/rejected': -7.775000095367432, 'epoch': 1.55}
{'loss': 0.3441, 'grad_norm': 28.108596801757812, 'learning_rate': 3.315493527390239e-07, 'rewards/chosen': 0.04574279859662056, 'rewards/rejected': -2.19921875, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 2.2445311546325684, 'logps/chosen': -73.5, 'logps/rejected': -95.75, 'logits/chosen': -7.959374904632568, 'logits/rejected': -7.506249904632568, 'epoch': 1.58}
{'loss': 0.3093, 'grad_norm': 45.329776763916016, 'learning_rate': 3.2618267621083083e-07, 'rewards/chosen': 0.10837402194738388, 'rewards/rejected': -2.0445313453674316, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 2.151562452316284, 'logps/chosen': -64.8499984741211, 'logps/rejected': -84.94999694824219, 'logits/chosen': -8.006250381469727, 'logits/rejected': -7.681250095367432, 'epoch': 1.6}
{'loss': 0.3247, 'grad_norm': 52.76762008666992, 'learning_rate': 3.2066713943166967e-07, 'rewards/chosen': 0.13024291396141052, 'rewards/rejected': -2.12890625, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.2578125, 'logps/chosen': -78.4749984741211, 'logps/rejected': -82.25, 'logits/chosen': -7.837500095367432, 'logits/rejected': -7.671875, 'epoch': 1.62}
{'loss': 0.2629, 'grad_norm': 32.8275260925293, 'learning_rate': 3.1501047477576993e-07, 'rewards/chosen': 0.0516815185546875, 'rewards/rejected': -2.186718702316284, 'rewards/accuracies': 0.875, 'rewards/margins': 2.2406249046325684, 'logps/chosen': -79.67500305175781, 'logps/rejected': -102.1500015258789, 'logits/chosen': -7.940625190734863, 'logits/rejected': -7.709374904632568, 'epoch': 1.65}
{'loss': 0.2959, 'grad_norm': 40.299964904785156, 'learning_rate': 3.0922061246819646e-07, 'rewards/chosen': 0.02812499925494194, 'rewards/rejected': -2.395312547683716, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 2.4273438453674316, 'logps/chosen': -80.6500015258789, 'logps/rejected': -114.8499984741211, 'logits/chosen': -7.925000190734863, 'logits/rejected': -7.643750190734863, 'epoch': 1.67}
{'loss': 0.2776, 'grad_norm': 26.18232536315918, 'learning_rate': 3.033056694672604e-07, 'rewards/chosen': 0.11510010063648224, 'rewards/rejected': -2.2953124046325684, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.409374952316284, 'logps/chosen': -72.94999694824219, 'logps/rejected': -82.1500015258789, 'logits/chosen': -7.837500095367432, 'logits/rejected': -7.618750095367432, 'epoch': 1.69}
{'loss': 0.2669, 'grad_norm': 19.791345596313477, 'learning_rate': 2.9727393808514503e-07, 'rewards/chosen': 0.0966796875, 'rewards/rejected': -2.438281297683716, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.53515625, 'logps/chosen': -78.2750015258789, 'logps/rejected': -106.1500015258789, 'logits/chosen': -7.84375, 'logits/rejected': -7.596875190734863, 'epoch': 1.72}
{'loss': 0.3373, 'grad_norm': 23.822629928588867, 'learning_rate': 2.911338743626974e-07, 'rewards/chosen': -0.02584686316549778, 'rewards/rejected': -2.327343702316284, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.301562547683716, 'logps/chosen': -78.2249984741211, 'logps/rejected': -87.9000015258789, 'logits/chosen': -7.846875190734863, 'logits/rejected': -7.621874809265137, 'epoch': 1.74}
{'loss': 0.3088, 'grad_norm': 35.25035858154297, 'learning_rate': 2.848940862146858e-07, 'rewards/chosen': -0.07599487155675888, 'rewards/rejected': -2.3109374046325684, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.231250047683716, 'logps/chosen': -81.0999984741211, 'logps/rejected': -106.75, 'logits/chosen': -7.956250190734863, 'logits/rejected': -7.518750190734863, 'epoch': 1.77}
{'loss': 0.2885, 'grad_norm': 36.78181076049805, 'learning_rate': 2.785633213621402e-07, 'rewards/chosen': 0.11984863132238388, 'rewards/rejected': -2.360156297683716, 'rewards/accuracies': 0.875, 'rewards/margins': 2.481250047683716, 'logps/chosen': -114.5, 'logps/rejected': -142.35000610351562, 'logits/chosen': -7.768750190734863, 'logits/rejected': -7.474999904632568, 'epoch': 1.79}
{'loss': 0.3109, 'grad_norm': 16.15672492980957, 'learning_rate': 2.721504550686949e-07, 'rewards/chosen': 0.26472169160842896, 'rewards/rejected': -2.041015625, 'rewards/accuracies': 0.875, 'rewards/margins': 2.3046875, 'logps/chosen': -134.5, 'logps/rejected': -161.625, 'logits/chosen': -7.793749809265137, 'logits/rejected': -7.509375095367432, 'epoch': 1.81}
{'loss': 0.2807, 'grad_norm': 37.067230224609375, 'learning_rate': 2.656644776981262e-07, 'rewards/chosen': -0.004498290829360485, 'rewards/rejected': -2.387500047683716, 'rewards/accuracies': 0.875, 'rewards/margins': 2.382031202316284, 'logps/chosen': -77.5250015258789, 'logps/rejected': -104.55000305175781, 'logits/chosen': -7.931250095367432, 'logits/rejected': -7.553124904632568, 'epoch': 1.84}
{'loss': 0.3396, 'grad_norm': 38.45998764038086, 'learning_rate': 2.591144821105276e-07, 'rewards/chosen': -0.096923828125, 'rewards/rejected': -2.413281202316284, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.3148436546325684, 'logps/chosen': -84.0999984741211, 'logps/rejected': -93.7750015258789, 'logits/chosen': -7.837500095367432, 'logits/rejected': -7.612500190734863, 'epoch': 1.86}
{'loss': 0.3462, 'grad_norm': 126.81456756591797, 'learning_rate': 2.525096509147937e-07, 'rewards/chosen': 0.141998291015625, 'rewards/rejected': -2.2445311546325684, 'rewards/accuracies': 0.84375, 'rewards/margins': 2.3851561546325684, 'logps/chosen': -140.0, 'logps/rejected': -171.14999389648438, 'logits/chosen': -7.728125095367432, 'logits/rejected': -7.349999904632568, 'epoch': 1.89}
{'loss': 0.3418, 'grad_norm': 22.412975311279297, 'learning_rate': 2.458592435952818e-07, 'rewards/chosen': -0.03256835788488388, 'rewards/rejected': -2.44140625, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 2.409374952316284, 'logps/chosen': -85.57499694824219, 'logps/rejected': -90.30000305175781, 'logits/chosen': -7.78125, 'logits/rejected': -7.565625190734863, 'epoch': 1.91}
{'loss': 0.3199, 'grad_norm': 42.32160568237305, 'learning_rate': 2.3917258353070065e-07, 'rewards/chosen': -0.14924010634422302, 'rewards/rejected': -2.495312452316284, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.3421874046325684, 'logps/chosen': -78.7750015258789, 'logps/rejected': -108.19999694824219, 'logits/chosen': -7.900000095367432, 'logits/rejected': -7.568749904632568, 'epoch': 1.93}
{'loss': 0.2922, 'grad_norm': 33.69416427612305, 'learning_rate': 2.324590449234237e-07, 'rewards/chosen': 0.17257079482078552, 'rewards/rejected': -2.7085938453674316, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 2.8828125, 'logps/chosen': -125.9749984741211, 'logps/rejected': -148.85000610351562, 'logits/chosen': -7.834374904632568, 'logits/rejected': -7.515625, 'epoch': 1.96}
{'loss': 0.3558, 'grad_norm': 45.664100646972656, 'learning_rate': 2.2572803965755134e-07, 'rewards/chosen': 0.26557618379592896, 'rewards/rejected': -2.158398389816284, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.4234375953674316, 'logps/chosen': -147.27499389648438, 'logps/rejected': -155.60000610351562, 'logits/chosen': -7.953125, 'logits/rejected': -7.621874809265137, 'epoch': 1.98}
  warnings.warn(                               
{'eval_loss': 0.539171040058136, 'eval_runtime': 80.4449, 'eval_samples_per_second': 11.847, 'eval_steps_per_second': 0.746, 'eval_rewards/chosen': 0.28641000390052795, 'eval_rewards/rejected': -2.9486165046691895, 'eval_rewards/accuracies': 0.7792823910713196, 'eval_rewards/margins': 3.2335734367370605, 'eval_logps/chosen': -358.25, 'eval_logps/rejected': -172.7083282470703, 'eval_logits/chosen': -7.261979103088379, 'eval_logits/rejected': -7.5098958015441895, 'epoch': 2.0}
 83%|████████▎ | 1045/1257 [1:03:16<10:59,  3.1/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.2985, 'grad_norm': 35.89809799194336, 'learning_rate': 2.1898900410414613e-07, 'rewards/chosen': -0.07746581733226776, 'rewards/rejected': -2.6976561546325684, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.620312452316284, 'logps/chosen': -80.7249984741211, 'logps/rejected': -95.7249984741211, 'logits/chosen': -7.71875, 'logits/rejected': -7.537499904632568, 'epoch': 2.0}
{'loss': 0.2204, 'grad_norm': 31.136093139648438, 'learning_rate': 2.122513858921393e-07, 'rewards/chosen': 0.132232666015625, 'rewards/rejected': -2.3910155296325684, 'rewards/accuracies': 0.9437500238418579, 'rewards/margins': 2.5210938453674316, 'logps/chosen': -111.875, 'logps/rejected': -126.9000015258789, 'logits/chosen': -7.759375095367432, 'logits/rejected': -7.453125, 'epoch': 2.03}
{'loss': 0.2759, 'grad_norm': 93.82714080810547, 'learning_rate': 2.0552463066345438e-07, 'rewards/chosen': -0.20909424126148224, 'rewards/rejected': -2.754687547683716, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.547656297683716, 'logps/chosen': -81.42500305175781, 'logps/rejected': -99.55000305175781, 'logits/chosen': -7.824999809265137, 'logits/rejected': -7.646874904632568, 'epoch': 2.05}
{'loss': 0.3273, 'grad_norm': 13.449951171875, 'learning_rate': 1.9881816883091643e-07, 'rewards/chosen': 0.29859620332717896, 'rewards/rejected': -2.4828124046325684, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 2.7835936546325684, 'logps/chosen': -110.9749984741211, 'logps/rejected': -128.8000030517578, 'logits/chosen': -7.787499904632568, 'logits/rejected': -7.481249809265137, 'epoch': 2.08}
{'loss': 0.2957, 'grad_norm': 42.389217376708984, 'learning_rate': 1.921414023575116e-07, 'rewards/chosen': -0.03730468824505806, 'rewards/rejected': -2.5078125, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.46875, 'logps/chosen': -75.0, 'logps/rejected': -87.69999694824219, 'logits/chosen': -8.003125190734863, 'logits/rejected': -7.706250190734863, 'epoch': 2.1}
{'loss': 0.2901, 'grad_norm': 20.6026668548584, 'learning_rate': 1.855036915755309e-07, 'rewards/chosen': 0.010424804873764515, 'rewards/rejected': -2.7578125, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.765625, 'logps/chosen': -81.7249984741211, 'logps/rejected': -103.67500305175781, 'logits/chosen': -8.034375190734863, 'logits/rejected': -7.634375095367432, 'epoch': 2.12}
{'loss': 0.2437, 'grad_norm': 31.902076721191406, 'learning_rate': 1.7891434206407747e-07, 'rewards/chosen': 0.17199555039405823, 'rewards/rejected': -2.553906202316284, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 2.725781202316284, 'logps/chosen': -105.5, 'logps/rejected': -141.125, 'logits/chosen': -7.918749809265137, 'logits/rejected': -7.512499809265137, 'epoch': 2.15}
{'loss': 0.3041, 'grad_norm': 39.12208557128906, 'learning_rate': 1.7238259160333346e-07, 'rewards/chosen': -0.126953125, 'rewards/rejected': -2.7203125953674316, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.5921874046325684, 'logps/chosen': -80.5999984741211, 'logps/rejected': -109.80000305175781, 'logits/chosen': -7.840624809265137, 'logits/rejected': -7.446875095367432, 'epoch': 2.17}
{'loss': 0.2914, 'grad_norm': 30.256855010986328, 'learning_rate': 1.659175972238763e-07, 'rewards/chosen': -0.01864318922162056, 'rewards/rejected': -2.378124952316284, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.360156297683716, 'logps/chosen': -108.25, 'logps/rejected': -129.6750030517578, 'logits/chosen': -7.784375190734863, 'logits/rejected': -7.612500190734863, 'epoch': 2.2}
{'loss': 0.2124, 'grad_norm': 28.20296859741211, 'learning_rate': 1.5952842236919945e-07, 'rewards/chosen': 0.1414741575717926, 'rewards/rejected': -2.832812547683716, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.9749999046325684, 'logps/chosen': -80.17500305175781, 'logps/rejected': -97.9000015258789, 'logits/chosen': -7.996874809265137, 'logits/rejected': -7.856249809265137, 'epoch': 2.22}
{'loss': 0.2861, 'grad_norm': 38.35015869140625, 'learning_rate': 1.5322402418943604e-07, 'rewards/chosen': -0.02001953125, 'rewards/rejected': -2.8828125, 'rewards/accuracies': 0.875, 'rewards/margins': 2.864062547683716, 'logps/chosen': -89.6500015258789, 'logps/rejected': -118.4000015258789, 'logits/chosen': -8.196874618530273, 'logits/rejected': -7.846875190734863, 'epoch': 2.24}
{'loss': 0.2802, 'grad_norm': 29.049203872680664, 'learning_rate': 1.4701324098409703e-07, 'rewards/chosen': 0.11572723090648651, 'rewards/rejected': -2.749218702316284, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.8656249046325684, 'logps/chosen': -72.2750015258789, 'logps/rejected': -102.0999984741211, 'logits/chosen': -8.040624618530273, 'logits/rejected': -7.737500190734863, 'epoch': 2.27}
{'loss': 0.3059, 'grad_norm': 47.07881546020508, 'learning_rate': 1.409047798114302e-07, 'rewards/chosen': -0.19899901747703552, 'rewards/rejected': -2.514843702316284, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.317187547683716, 'logps/chosen': -72.2750015258789, 'logps/rejected': -93.57499694824219, 'logits/chosen': -8.190625190734863, 'logits/rejected': -7.637499809265137, 'epoch': 2.29}
{'loss': 0.2806, 'grad_norm': 19.475921630859375, 'learning_rate': 1.349072042817685e-07, 'rewards/chosen': 0.14987793564796448, 'rewards/rejected': -2.6304688453674316, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.7796874046325684, 'logps/chosen': -111.67500305175781, 'logps/rejected': -129.10000610351562, 'logits/chosen': -7.849999904632568, 'logits/rejected': -7.640625, 'epoch': 2.32}
{'loss': 0.2666, 'grad_norm': 25.33974266052246, 'learning_rate': 1.2902892255198288e-07, 'rewards/chosen': -0.02182617224752903, 'rewards/rejected': -2.78125, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.7578125, 'logps/chosen': -76.9000015258789, 'logps/rejected': -104.94999694824219, 'logits/chosen': -7.940625190734863, 'logits/rejected': -7.678124904632568, 'epoch': 2.34}
{'loss': 0.2046, 'grad_norm': 19.13742446899414, 'learning_rate': 1.232781755378684e-07, 'rewards/chosen': 0.11092529445886612, 'rewards/rejected': -2.9664063453674316, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 3.0765624046325684, 'logps/chosen': -75.80000305175781, 'logps/rejected': -89.5999984741211, 'logits/chosen': -7.800000190734863, 'logits/rejected': -7.578125, 'epoch': 2.36}
{'loss': 0.2766, 'grad_norm': 22.037904739379883, 'learning_rate': 1.1766302536099078e-07, 'rewards/chosen': -0.04188232496380806, 'rewards/rejected': -2.69140625, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.6468749046325684, 'logps/chosen': -83.55000305175781, 'logps/rejected': -101.69999694824219, 'logits/chosen': -7.956250190734863, 'logits/rejected': -7.6875, 'epoch': 2.39}
{'loss': 0.2566, 'grad_norm': 24.055097579956055, 'learning_rate': 1.121913440461884e-07, 'rewards/chosen': 0.05580444261431694, 'rewards/rejected': -2.8296875953674316, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.885937452316284, 'logps/chosen': -76.80000305175781, 'logps/rejected': -119.9000015258789, 'logits/chosen': -8.003125190734863, 'logits/rejected': -7.631249904632568, 'epoch': 2.41}
{'loss': 0.2548, 'grad_norm': 30.478857040405273, 'learning_rate': 1.068708024855768e-07, 'rewards/chosen': -0.12828369438648224, 'rewards/rejected': -2.9390625953674316, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.8125, 'logps/chosen': -84.5999984741211, 'logps/rejected': -109.5999984741211, 'logits/chosen': -7.915625095367432, 'logits/rejected': -7.621874809265137, 'epoch': 2.43}
{'loss': 0.2247, 'grad_norm': 14.059735298156738, 'learning_rate': 1.0170885968452543e-07, 'rewards/chosen': 0.30010682344436646, 'rewards/rejected': -2.5562500953674316, 'rewards/accuracies': 0.9375, 'rewards/margins': 2.859375, 'logps/chosen': -116.625, 'logps/rejected': -146.5500030517578, 'logits/chosen': -7.793749809265137, 'logits/rejected': -7.465624809265137, 'epoch': 2.46}
{'loss': 0.2213, 'grad_norm': 23.57790184020996, 'learning_rate': 9.671275230468437e-08, 'rewards/chosen': 0.05270995944738388, 'rewards/rejected': -2.848437547683716, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.8968749046325684, 'logps/chosen': -67.9000015258789, 'logps/rejected': -89.9000015258789, 'logits/chosen': -8.137499809265137, 'logits/rejected': -7.821875095367432, 'epoch': 2.48}
  warnings.warn(                               
{'eval_loss': 0.5382584929466248, 'eval_runtime': 80.5945, 'eval_samples_per_second': 11.825, 'eval_steps_per_second': 0.744, 'eval_rewards/chosen': 0.27108967304229736, 'eval_rewards/rejected': -3.313997507095337, 'eval_rewards/accuracies': 0.7857638597488403, 'eval_rewards/margins': 3.5849976539611816, 'eval_logps/chosen': -358.2166748046875, 'eval_logps/rejected': -174.45416259765625, 'eval_logits/chosen': -7.3182291984558105, 'eval_logits/rejected': -7.5447916984558105, 'epoch': 2.49}
100%|█████████▉| 1254/1257 [1:15:55<00:09,  3.0/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.2512, 'grad_norm': 10.60650634765625, 'learning_rate': 9.188948451872067e-08, 'rewards/chosen': 0.07338867336511612, 'rewards/rejected': -2.725781202316284, 'rewards/accuracies': 0.862500011920929, 'rewards/margins': 2.7992186546325684, 'logps/chosen': -109.625, 'logps/rejected': -146.0500030517578, 'logits/chosen': -8.021875381469727, 'logits/rejected': -7.606249809265137, 'epoch': 2.51}
{'loss': 0.2857, 'grad_norm': 39.047969818115234, 'learning_rate': 8.724581819098671e-08, 'rewards/chosen': 0.01742401160299778, 'rewards/rejected': -2.39453125, 'rewards/accuracies': 0.8687499761581421, 'rewards/margins': 2.4117188453674316, 'logps/chosen': -85.75, 'logps/rejected': -96.17500305175781, 'logits/chosen': -8.012499809265137, 'logits/rejected': -7.712500095367432, 'epoch': 2.53}
{'loss': 0.22, 'grad_norm': 28.26789665222168, 'learning_rate': 8.278826339788691e-08, 'rewards/chosen': 0.04033203050494194, 'rewards/rejected': -2.7828125953674316, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.823437452316284, 'logps/chosen': -120.05000305175781, 'logps/rejected': -150.64999389648438, 'logits/chosen': -7.793749809265137, 'logits/rejected': -7.471875190734863, 'epoch': 2.55}
{'loss': 0.2065, 'grad_norm': 15.919513702392578, 'learning_rate': 7.852306930123254e-08, 'rewards/chosen': -0.0341796875, 'rewards/rejected': -3.0687499046325684, 'rewards/accuracies': 0.893750011920929, 'rewards/margins': 3.0328125953674316, 'logps/chosen': -79.25, 'logps/rejected': -116.05000305175781, 'logits/chosen': -7.956250190734863, 'logits/rejected': -7.521874904632568, 'epoch': 2.58}
{'loss': 0.2796, 'grad_norm': 44.88750457763672, 'learning_rate': 7.445621538737983e-08, 'rewards/chosen': 0.42438966035842896, 'rewards/rejected': -2.46875, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.893749952316284, 'logps/chosen': -129.97500610351562, 'logps/rejected': -144.0500030517578, 'logits/chosen': -7.921875, 'logits/rejected': -7.559374809265137, 'epoch': 2.6}
{'loss': 0.2917, 'grad_norm': 29.05719566345215, 'learning_rate': 7.059340308443225e-08, 'rewards/chosen': -0.14583130180835724, 'rewards/rejected': -2.6624999046325684, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.515625, 'logps/chosen': -76.7249984741211, 'logps/rejected': -91.80000305175781, 'logits/chosen': -8.040624618530273, 'logits/rejected': -7.671875, 'epoch': 2.63}
{'loss': 0.2492, 'grad_norm': 36.98857498168945, 'learning_rate': 6.6940047769261e-08, 'rewards/chosen': 0.08046875149011612, 'rewards/rejected': -2.746875047683716, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.8265624046325684, 'logps/chosen': -132.5500030517578, 'logps/rejected': -139.89999389648438, 'logits/chosen': -7.828125, 'logits/rejected': -7.690625190734863, 'epoch': 2.65}
{'loss': 0.2871, 'grad_norm': 39.10936737060547, 'learning_rate': 6.35012711755471e-08, 'rewards/chosen': 0.24921874701976776, 'rewards/rejected': -2.539843797683716, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.793750047683716, 'logps/chosen': -139.89999389648438, 'logps/rejected': -172.35000610351562, 'logits/chosen': -7.978125095367432, 'logits/rejected': -7.625, 'epoch': 2.67}
{'loss': 0.2355, 'grad_norm': 79.06024169921875, 'learning_rate': 6.028189421349007e-08, 'rewards/chosen': 0.12758788466453552, 'rewards/rejected': -2.8179688453674316, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.94140625, 'logps/chosen': -98.17500305175781, 'logps/rejected': -116.7249984741211, 'logits/chosen': -7.893750190734863, 'logits/rejected': -7.5625, 'epoch': 2.7}
{'loss': 0.1754, 'grad_norm': 11.052360534667969, 'learning_rate': 5.728643021124882e-08, 'rewards/chosen': 0.03801269456744194, 'rewards/rejected': -2.9078125953674316, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 2.9468750953674316, 'logps/chosen': -67.2249984741211, 'logps/rejected': -93.92500305175781, 'logits/chosen': -8.021875381469727, 'logits/rejected': -7.721875190734863, 'epoch': 2.72}
{'loss': 0.2516, 'grad_norm': 25.344173431396484, 'learning_rate': 5.451907858758977e-08, 'rewards/chosen': -0.09365234524011612, 'rewards/rejected': -2.8414063453674316, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.7484374046325684, 'logps/chosen': -81.57499694824219, 'logps/rejected': -102.05000305175781, 'logits/chosen': -7.915625095367432, 'logits/rejected': -7.646874904632568, 'epoch': 2.74}
{'loss': 0.261, 'grad_norm': 36.821537017822266, 'learning_rate': 5.198371896461241e-08, 'rewards/chosen': -0.17075195908546448, 'rewards/rejected': -2.746875047683716, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.5765624046325684, 'logps/chosen': -78.375, 'logps/rejected': -91.7249984741211, 'logits/chosen': -7.971875190734863, 'logits/rejected': -7.734375, 'epoch': 2.77}
{'loss': 0.3457, 'grad_norm': 43.01566696166992, 'learning_rate': 4.968390572880652e-08, 'rewards/chosen': -0.17499999701976776, 'rewards/rejected': -2.88671875, 'rewards/accuracies': 0.856249988079071, 'rewards/margins': 2.711718797683716, 'logps/chosen': -87.30000305175781, 'logps/rejected': -106.19999694824219, 'logits/chosen': -7.928124904632568, 'logits/rejected': -7.787499904632568, 'epoch': 2.79}
{'loss': 0.1622, 'grad_norm': 19.255098342895508, 'learning_rate': 4.762286304806536e-08, 'rewards/chosen': 0.3212127685546875, 'rewards/rejected': -2.8812499046325684, 'rewards/accuracies': 0.956250011920929, 'rewards/margins': 3.203125, 'logps/chosen': -91.25, 'logps/rejected': -108.44999694824219, 'logits/chosen': -8.034375190734863, 'logits/rejected': -7.662499904632568, 'epoch': 2.82}
{'loss': 0.3177, 'grad_norm': 56.922237396240234, 'learning_rate': 4.5803480351641034e-08, 'rewards/chosen': 0.07755126804113388, 'rewards/rejected': -2.6328125, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.7132811546325684, 'logps/chosen': -111.8499984741211, 'logps/rejected': -133.125, 'logits/chosen': -7.893750190734863, 'logits/rejected': -7.653124809265137, 'epoch': 2.84}
{'loss': 0.2248, 'grad_norm': 20.0607967376709, 'learning_rate': 4.422830827937861e-08, 'rewards/chosen': -0.12202148139476776, 'rewards/rejected': -2.9312500953674316, 'rewards/accuracies': 0.925000011920929, 'rewards/margins': 2.809375047683716, 'logps/chosen': -88.1500015258789, 'logps/rejected': -107.2750015258789, 'logits/chosen': -7.896874904632568, 'logits/rejected': -7.5625, 'epoch': 2.86}
{'loss': 0.2688, 'grad_norm': 50.03322219848633, 'learning_rate': 4.2899555105907845e-08, 'rewards/chosen': -0.09535522758960724, 'rewards/rejected': -3.012500047683716, 'rewards/accuracies': 0.9125000238418579, 'rewards/margins': 2.913281202316284, 'logps/chosen': -79.1500015258789, 'logps/rejected': -111.05000305175781, 'logits/chosen': -8.175000190734863, 'logits/rejected': -7.809374809265137, 'epoch': 2.89}
{'loss': 0.2395, 'grad_norm': 19.387460708618164, 'learning_rate': 4.181908364480563e-08, 'rewards/chosen': -0.0928955078125, 'rewards/rejected': -3.004687547683716, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.9078125953674316, 'logps/chosen': -81.625, 'logps/rejected': -114.05000305175781, 'logits/chosen': -7.871874809265137, 'logits/rejected': -7.534375190734863, 'epoch': 2.91}
{'loss': 0.2473, 'grad_norm': 40.88595962524414, 'learning_rate': 4.09884086370693e-08, 'rewards/chosen': -0.12114868313074112, 'rewards/rejected': -2.8499999046325684, 'rewards/accuracies': 0.9125000238418579, 'rewards/margins': 2.7265625, 'logps/chosen': -75.2750015258789, 'logps/rejected': -100.57499694824219, 'logits/chosen': -7.893750190734863, 'logits/rejected': -7.684374809265137, 'epoch': 2.94}
{'loss': 0.2519, 'grad_norm': 14.844752311706543, 'learning_rate': 4.040869462756188e-08, 'rewards/chosen': -0.19855041801929474, 'rewards/rejected': -2.8109374046325684, 'rewards/accuracies': 0.887499988079071, 'rewards/margins': 2.608593702316284, 'logps/chosen': -75.05000305175781, 'logps/rejected': -101.57499694824219, 'logits/chosen': -7.868750095367432, 'logits/rejected': -7.465624809265137, 'epoch': 2.96}
{'loss': 0.2989, 'grad_norm': 59.25812530517578, 'learning_rate': 4.008075433240644e-08, 'rewards/chosen': -0.18294677138328552, 'rewards/rejected': -2.8656249046325684, 'rewards/accuracies': 0.8812500238418579, 'rewards/margins': 2.684375047683716, 'logps/chosen': -80.375, 'logps/rejected': -103.25, 'logits/chosen': -7.987500190734863, 'logits/rejected': -7.709374904632568, 'epoch': 2.98}
  warnings.warn(                               
{'eval_loss': 0.5461001992225647, 'eval_runtime': 81.0758, 'eval_samples_per_second': 11.754, 'eval_steps_per_second': 0.74, 'eval_rewards/chosen': 0.22236327826976776, 'eval_rewards/rejected': -3.4921224117279053, 'eval_rewards/accuracies': 0.7855323553085327, 'eval_rewards/margins': 3.7120728492736816, 'eval_logps/chosen': -358.6166687011719, 'eval_logps/rejected': -175.44583129882812, 'eval_logits/chosen': -7.3458333015441895, 'eval_logits/rejected': -7.565104007720947, 'epoch': 2.99}
100%|██████████| 1257/1257 [1:16:36<00:00,  3.66s/it]
{'train_runtime': 4602.4411, 'train_samples_per_second': 4.36, 'train_steps_per_second': 0.273, 'train_loss': 0.3925653383100232, 'epoch': 3.0}
Training complete
Saving model
