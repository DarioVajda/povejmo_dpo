cpu-bind=MASK - gn01, task  0  0 [3245375]: mask 0xffff0000ffff0000ffffffffffffffffffff0000ffff0000ffffffffffffffff set
*******STARTING********
--- Running on Node Rank: 0 ---
Total Nodes: 3
--- CUDA_VISIBLE_DEVICES for this srun task: 0,1,2,3 ---
GPUs per Node: 4
Master Address: gn01
Master Port: 29500
-------------------------------------------
accelerate launch     --config_file /ceph/hpc/data/s24o01-42-users/translation_optimization/trl/accelerate_config.yaml     --num_machines 3     --machine_rank 0     --main_process_ip gn01     --main_process_port 29500     --num_processes 12     --deepspeed_hostfile /ceph/hpc/data/s24o01-42-users/translation_optimization/trl/result_dir/hostfile_63118025     --deepspeed_multinode_launcher standard     --rdzv_backend static     --same_network     --mixed_precision bf16     "train_curriculum.py"     --rank=64 --learning_rate=1e-6 --total_epochs=3 --beta=0.1 --curriculum_stage=2
-------------------------------------------
[2025-06-12 21:08:06,366] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
W0612 21:08:07.830000 3245425 torch/distributed/run.py:792] 
W0612 21:08:07.830000 3245425 torch/distributed/run.py:792] *****************************************
W0612 21:08:07.830000 3245425 torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0612 21:08:07.830000 3245425 torch/distributed/run.py:792] *****************************************
[2025-06-12 21:08:56,279] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-12 21:08:56,312] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-12 21:08:56,320] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-12 21:08:56,331] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[load_data_curriculum.py]: Training data of type 'bad_lang_examples':    3489
[load_data_curriculum.py]: Training data of type 'short_examples':       699
[load_data_curriculum.py]: Training data of type 'choose_examples':      13379
[load_data_curriculum.py]: Training data of type 'bad_format_examples':  3148
[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *[load_data_curriculum.py]: *
[load_data_curriculum.py]: Evaluation data size: 953
[load_data_curriculum.py]: Curriculum stage 0 training data size: 4890
[load_data_curriculum.py]: Curriculum stage 1 training data size: 6689
[load_data_curriculum.py]: Curriculum stage 2 training data size: 6690
Namespace(rank=64, learning_rate=1e-06, total_epochs=3, beta=0.1, curriculum_stage=2)
1e-06
[load_data.py]: Training data of type 'bad_lang_examples':    5343
[load_data.py]: Training data of type 'short_examples':       699
Namespace(rank=64, learning_rate=1e-06, total_epochs=3, beta=0.1, curriculum_stage=2)
Namespace(rank=64, learning_rate=1e-06, total_epochs=3, beta=0.1, curriculum_stage=2)
[load_data.py]: Training data of type 'choose_examples':      1e-06
1e-06
13379
[load_data.py]: Training data of type 'bad_format_examples':  4806
[2025-06-12 21:09:00,884] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-06-12 21:09:01,015] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-06-12 21:09:01,033] [INFO] [comm.py:658:init_distributed] cdb=None
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][load_data.py]: Number of training examples: 24227
[load_data.py]: Number of validation examples: 953
Namespace(rank=64, learning_rate=1e-06, total_epochs=3, beta=0.1, curriculum_stage=2)
1e-06
World size: 12
Setting gradient accumulation steps to: 1
Created datasets
Train dataset size: 6690
Validation dataset size: 953
Steps per epoch: 418
Evaluate each 209 steps
[2025-06-12 21:09:02,800] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-06-12 21:09:02,805] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Set up DPO configuration
Loading model from: /ceph/hpc/data/s24o01-42-users/translation_optimization/trl/trained_models/Curriculum_DPO_models/GaMS-9B-DPO-Curriculum-1
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.45s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.43s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.45s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.38s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.68s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.61s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.62s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.56s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.57s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.55s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.55s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:16<00:05,  5.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.10s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.29s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.08s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.10s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.27s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.27s/it]

Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.97s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.17s/it]
Loaded model
Total Parameters: 9457.78M
Total Parameters: 9457.78M
Total Parameters: 9457.78M
Trainable Parameters (LoRA): 216.07M
Trainable Parameters (LoRA): 216.07M
Trainable Parameters (LoRA): 216.07M
Percentage of Trainable Params: 2.2846%
Percentage of Trainable Params: 2.2846%
Percentage of Trainable Params: 2.2846%
Total Parameters: 9457.78M
Trainable Parameters (LoRA): 216.07M[rank3]:[W612 21:09:25.747482611 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.

Percentage of Trainable Params: 2.2846%[rank2]:[W612 21:09:25.747972267 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.

Using LoRA and set up the model[rank1]:[W612 21:09:26.807936073 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.

Loaded tokenizer
Extracting prompt in train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Extracting prompt in train dataset:   0%|          | 10/6690 [00:00<01:54, 58.51 examples/s]Extracting prompt in train dataset:   7%|▋         | 470/6690 [00:00<00:02, 2109.21 examples/s]Extracting prompt in train dataset:  13%|█▎        | 860/6690 [00:00<00:02, 2800.57 examples/s]Extracting prompt in train dataset:  21%|██▏       | 1423/6690 [00:00<00:01, 3076.45 examples/s]Extracting prompt in train dataset:  28%|██▊       | 1847/6690 [00:00<00:01, 3415.06 examples/s]Extracting prompt in train dataset:  35%|███▍      | 2332/6690 [00:00<00:01, 3836.29 examples/s]Extracting prompt in train dataset:  43%|████▎     | 2866/6690 [00:00<00:00, 4280.00 examples/s]Extracting prompt in train dataset:  54%|█████▎    | 3580/6690 [00:00<00:00, 4454.65 examples/s]Extracting prompt in train dataset:  62%|██████▏   | 4117/6690 [00:01<00:00, 4697.92 examples/s]Extracting prompt in train dataset:  72%|███████▏  | 4835/6690 [00:01<00:00, 4718.21 examples/s]Extracting prompt in train dataset:  81%|████████  | 5400/6690 [00:01<00:00, 3504.93 examples/s]Extracting prompt in train dataset:  89%|████████▊ | 5934/6690 [00:01<00:00, 3882.34 examples/s]Extracting prompt in train dataset:  97%|█████████▋| 6473/6690 [00:01<00:00, 4216.47 examples/s]Extracting prompt in train dataset: 100%|██████████| 6690/6690 [00:01<00:00, 3741.43 examples/s]
Applying chat template to train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Applying chat template to train dataset:   4%|▍         | 296/6690 [00:00<00:02, 2929.23 examples/s]Applying chat template to train dataset:  11%|█         | 705/6690 [00:00<00:02, 2782.89 examples/s]Applying chat template to train dataset:  15%|█▌        | 1030/6690 [00:00<00:02, 2226.17 examples/s]Applying chat template to train dataset:  20%|██        | 1354/6690 [00:00<00:02, 1955.35 examples/s]Applying chat template to train dataset:  25%|██▌       | 1689/6690 [00:00<00:02, 2045.06 examples/s]Applying chat template to train dataset:  29%|██▉       | 1965/6690 [00:00<00:02, 2214.21 examples/s]Applying chat template to train dataset:  34%|███▎      | 2254/6690 [00:00<00:01, 2383.89 examples/s]Applying chat template to train dataset:  38%|███▊      | 2527/6690 [00:01<00:01, 2474.58 examples/s]Applying chat template to train dataset:  43%|████▎     | 2852/6690 [00:01<00:01, 2243.10 examples/s]Applying chat template to train dataset:  47%|████▋     | 3120/6690 [00:01<00:01, 2348.06 examples/s]Applying chat template to train dataset:  53%|█████▎    | 3524/6690 [00:01<00:01, 2462.27 examples/s]Applying chat template to train dataset:  57%|█████▋    | 3834/6690 [00:01<00:01, 2618.15 examples/s]Applying chat template to train dataset:  62%|██████▏   | 4142/6690 [00:01<00:00, 2734.82 examples/s]Applying chat template to train dataset:  67%|██████▋   | 4452/6690 [00:01<00:00, 2492.14 examples/s]Applying chat template to train dataset:  73%|███████▎  | 4864/6690 [00:02<00:00, 2576.02 examples/s]Applying chat template to train dataset:  77%|███████▋  | 5170/6690 [00:02<00:00, 2690.51 examples/s]Applying chat template to train dataset:  82%|████████▏ | 5494/6690 [00:02<00:00, 2344.57 examples/s]Applying chat template to train dataset:  87%|████████▋ | 5818/6690 [00:02<00:00, 2109.12 examples/s]Applying chat template to train dataset:  92%|█████████▏| 6130/6690 [00:02<00:00, 2323.97 examples/s]Applying chat template to train dataset:  96%|█████████▌| 6437/6690 [00:02<00:00, 2498.10 examples/s]Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:02<00:00, 2401.65 examples/s]
Tokenizing train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Tokenizing train dataset:   1%|          | 40/6690 [00:00<00:17, 382.15 examples/s]Tokenizing train dataset:   1%|▏         | 89/6690 [00:00<00:22, 299.99 examples/s]Tokenizing train dataset:   2%|▏         | 131/6690 [00:00<00:19, 335.46 examples/s]Tokenizing train dataset:   3%|▎         | 178/6690 [00:00<00:17, 377.63 examples/s]Tokenizing train dataset:   3%|▎         | 225/6690 [00:00<00:15, 405.15 examples/s]Tokenizing train dataset:   4%|▍         | 286/6690 [00:00<00:15, 401.84 examples/s]Tokenizing train dataset:   5%|▌         | 347/6690 [00:00<00:15, 399.52 examples/s]Tokenizing train dataset:   6%|▌         | 398/6690 [00:01<00:14, 422.17 examples/s]Tokenizing train dataset:   7%|▋         | 462/6690 [00:01<00:14, 420.56 examples/s]Tokenizing train dataset:   8%|▊         | 510/6690 [00:01<00:14, 428.85 examples/s]Tokenizing train dataset:   9%|▊         | 570/6690 [00:01<00:14, 416.43 examples/s]Tokenizing train dataset:   9%|▉         | 616/6690 [00:01<00:14, 425.25 examples/s]Tokenizing train dataset:  10%|█         | 686/6690 [00:01<00:13, 435.89 examples/s]Tokenizing train dataset:  11%|█         | 742/6690 [00:01<00:14, 412.85 examples/s]Tokenizing train dataset:  12%|█▏        | 793/6690 [00:02<00:18, 317.30 examples/s]Tokenizing train dataset:  13%|█▎        | 837/6690 [00:02<00:17, 339.77 examples/s]Tokenizing train dataset:  13%|█▎        | 878/6690 [00:02<00:16, 354.54 examples/s]Tokenizing train dataset:  14%|█▍        | 937/6690 [00:02<00:15, 364.41 examples/s]Tokenizing train dataset:  15%|█▍        | 976/6690 [00:02<00:15, 368.13 examples/s]Tokenizing train dataset:  15%|█▌        | 1021/6690 [00:02<00:14, 384.47 examples/s]Tokenizing train dataset:  16%|█▌        | 1074/6690 [00:02<00:18, 301.27 examples/s]Tokenizing train dataset:  17%|█▋        | 1117/6690 [00:03<00:19, 281.58 examples/s]Tokenizing train dataset:  17%|█▋        | 1166/6690 [00:03<00:19, 277.53 examples/s]Tokenizing train dataset:  18%|█▊        | 1212/6690 [00:03<00:20, 262.08 examples/s]Tokenizing train dataset:  19%|█▊        | 1248/6690 [00:03<00:19, 280.88 examples/s]Tokenizing train dataset:  19%|█▉        | 1290/6690 [00:03<00:17, 308.80 examples/s]Tokenizing train dataset:  20%|██        | 1340/6690 [00:03<00:17, 311.75 examples/s]Tokenizing train dataset:  21%|██        | 1379/6690 [00:03<00:16, 327.92 examples/s]Tokenizing train dataset:  21%|██▏       | 1427/6690 [00:04<00:16, 321.56 examples/s]Tokenizing train dataset:  22%|██▏       | 1466/6690 [00:04<00:15, 334.91 examples/s]Tokenizing train dataset:  23%|██▎       | 1510/6690 [00:04<00:14, 357.36 examples/s]Tokenizing train dataset:  23%|██▎       | 1552/6690 [00:04<00:14, 365.55 examples/s]Tokenizing train dataset:  24%|██▍       | 1608/6690 [00:04<00:13, 365.32 examples/s]Tokenizing train dataset:  25%|██▍       | 1647/6690 [00:04<00:13, 366.18 examples/s]Tokenizing train dataset:  25%|██▌       | 1704/6690 [00:04<00:13, 368.85 examples/s]Tokenizing train dataset:  26%|██▌       | 1750/6690 [00:04<00:12, 388.14 examples/s]Tokenizing train dataset:  27%|██▋       | 1807/6690 [00:05<00:12, 382.40 examples/s]Tokenizing train dataset:  28%|██▊       | 1849/6690 [00:05<00:12, 386.41 examples/s]Tokenizing train dataset:  28%|██▊       | 1900/6690 [00:05<00:15, 311.25 examples/s]Tokenizing train dataset:  29%|██▉       | 1940/6690 [00:05<00:14, 325.94 examples/s]Tokenizing train dataset:  30%|██▉       | 1981/6690 [00:05<00:16, 294.16 examples/s]Tokenizing train dataset:  30%|███       | 2022/6690 [00:05<00:14, 315.85 examples/s]Tokenizing train dataset:  31%|███       | 2073/6690 [00:05<00:14, 320.33 examples/s]Tokenizing train dataset:  32%|███▏      | 2112/6690 [00:06<00:13, 333.88 examples/s]Tokenizing train dataset:  32%|███▏      | 2154/6690 [00:06<00:12, 353.26 examples/s]Tokenizing train dataset:  33%|███▎      | 2217/6690 [00:06<00:11, 373.48 examples/s]Tokenizing train dataset:  34%|███▍      | 2274/6690 [00:06<00:11, 372.68 examples/s]Tokenizing train dataset:  35%|███▍      | 2333/6690 [00:06<00:11, 377.76 examples/s]Tokenizing train dataset:  36%|███▌      | 2381/6690 [00:06<00:14, 291.67 examples/s]Tokenizing train dataset:  36%|███▌      | 2425/6690 [00:07<00:15, 278.77 examples/s]Tokenizing train dataset:  37%|███▋      | 2470/6690 [00:07<00:13, 310.01 examples/s]Tokenizing train dataset:  38%|███▊      | 2518/6690 [00:07<00:13, 302.12 examples/s]Tokenizing train dataset:  38%|███▊      | 2571/6690 [00:07<00:13, 305.78 examples/s]Tokenizing train dataset:  39%|███▉      | 2610/6690 [00:07<00:12, 321.59 examples/s]Tokenizing train dataset:  40%|███▉      | 2653/6690 [00:07<00:13, 294.76 examples/s]Tokenizing train dataset:  40%|████      | 2695/6690 [00:07<00:12, 319.44 examples/s]Tokenizing train dataset:  41%|████      | 2730/6690 [00:07<00:12, 325.20 examples/s]Tokenizing train dataset:  41%|████▏     | 2774/6690 [00:08<00:12, 313.51 examples/s]Tokenizing train dataset:  42%|████▏     | 2818/6690 [00:08<00:12, 302.04 examples/s]Tokenizing train dataset:  43%|████▎     | 2865/6690 [00:08<00:11, 336.15 examples/s]Tokenizing train dataset:  43%|████▎     | 2908/6690 [00:08<00:10, 353.90 examples/s]Tokenizing train dataset:  44%|████▍     | 2960/6690 [00:08<00:11, 330.15 examples/s]Tokenizing train dataset:  45%|████▍     | 3009/6690 [00:08<00:10, 366.19 examples/s]Tokenizing train dataset:  46%|████▌     | 3062/6690 [00:08<00:10, 360.32 examples/s]Tokenizing train dataset:  46%|████▋     | 3109/6690 [00:09<00:09, 385.44 examples/s]Tokenizing train dataset:  47%|████▋     | 3170/6690 [00:09<00:09, 388.69 examples/s]Tokenizing train dataset:  48%|████▊     | 3216/6690 [00:09<00:12, 288.80 examples/s]Tokenizing train dataset:  49%|████▊     | 3258/6690 [00:09<00:10, 313.56 examples/s]Tokenizing train dataset:  49%|████▉     | 3294/6690 [00:09<00:10, 322.29 examples/s]Tokenizing train dataset:  50%|████▉     | 3340/6690 [00:09<00:10, 313.71 examples/s]Tokenizing train dataset:  51%|█████     | 3381/6690 [00:09<00:09, 332.79 examples/s]Tokenizing train dataset:  51%|█████     | 3421/6690 [00:10<00:12, 270.55 examples/s]Tokenizing train dataset:  52%|█████▏    | 3460/6690 [00:10<00:12, 260.46 examples/s]Tokenizing train dataset:  52%|█████▏    | 3506/6690 [00:10<00:10, 298.59 examples/s]Tokenizing train dataset:  53%|█████▎    | 3542/6690 [00:10<00:10, 311.48 examples/s]Tokenizing train dataset:  54%|█████▎    | 3590/6690 [00:10<00:09, 310.22 examples/s]Tokenizing train dataset:  54%|█████▍    | 3630/6690 [00:10<00:09, 328.22 examples/s]Tokenizing train dataset:  55%|█████▍    | 3674/6690 [00:10<00:10, 298.86 examples/s]Tokenizing train dataset:  55%|█████▌    | 3709/6690 [00:11<00:09, 307.30 examples/s]Tokenizing train dataset:  56%|█████▌    | 3747/6690 [00:11<00:09, 322.94 examples/s]Tokenizing train dataset:  57%|█████▋    | 3790/6690 [00:11<00:08, 347.94 examples/s]Tokenizing train dataset:  57%|█████▋    | 3846/6690 [00:11<00:08, 355.31 examples/s]Tokenizing train dataset:  58%|█████▊    | 3895/6690 [00:11<00:08, 343.35 examples/s]Tokenizing train dataset:  59%|█████▉    | 3940/6690 [00:11<00:07, 365.48 examples/s]Tokenizing train dataset:  60%|█████▉    | 3989/6690 [00:11<00:09, 296.52 examples/s]Tokenizing train dataset:  60%|██████    | 4035/6690 [00:12<00:09, 289.80 examples/s]Tokenizing train dataset:  61%|██████    | 4070/6690 [00:12<00:08, 299.36 examples/s]Tokenizing train dataset:  61%|██████▏   | 4110/6690 [00:12<00:08, 320.34 examples/s]Tokenizing train dataset:  62%|██████▏   | 4148/6690 [00:12<00:07, 330.72 examples/s]Tokenizing train dataset:  63%|██████▎   | 4195/6690 [00:12<00:06, 364.14 examples/s]Tokenizing train dataset:  63%|██████▎   | 4238/6690 [00:12<00:06, 376.15 examples/s]Tokenizing train dataset:  64%|██████▍   | 4281/6690 [00:12<00:08, 281.89 examples/s]Tokenizing train dataset:  65%|██████▍   | 4325/6690 [00:12<00:07, 314.49 examples/s]Tokenizing train dataset:  65%|██████▌   | 4364/6690 [00:13<00:09, 245.08 examples/s]Tokenizing train dataset:  66%|██████▌   | 4399/6690 [00:13<00:08, 264.31 examples/s]Tokenizing train dataset:  66%|██████▋   | 4444/6690 [00:13<00:07, 302.31 examples/s]Tokenizing train dataset:  67%|██████▋   | 4487/6690 [00:13<00:08, 271.19 examples/s]Tokenizing train dataset:  68%|██████▊   | 4529/6690 [00:13<00:07, 303.13 examples/s]Tokenizing train dataset:  68%|██████▊   | 4576/6690 [00:13<00:07, 301.93 examples/s]Tokenizing train dataset:  69%|██████▉   | 4631/6690 [00:14<00:06, 318.39 examples/s]Tokenizing train dataset:  70%|██████▉   | 4670/6690 [00:14<00:06, 331.20 examples/s]Tokenizing train dataset:  70%|███████   | 4712/6690 [00:14<00:05, 352.32 examples/s]Tokenizing train dataset:  71%|███████   | 4760/6690 [00:14<00:05, 338.99 examples/s]Tokenizing train dataset:  72%|███████▏  | 4818/6690 [00:14<00:05, 351.04 examples/s]Tokenizing train dataset:  73%|███████▎  | 4867/6690 [00:14<00:06, 289.62 examples/s]Tokenizing train dataset:  73%|███████▎  | 4908/6690 [00:14<00:06, 273.68 examples/s]Tokenizing train dataset:  74%|███████▍  | 4950/6690 [00:15<00:05, 301.71 examples/s]Tokenizing train dataset:  75%|███████▍  | 4998/6690 [00:15<00:05, 305.47 examples/s]Tokenizing train dataset:  75%|███████▌  | 5039/6690 [00:15<00:05, 286.77 examples/s]Tokenizing train dataset:  76%|███████▌  | 5079/6690 [00:15<00:05, 310.81 examples/s]Tokenizing train dataset:  76%|███████▋  | 5117/6690 [00:15<00:04, 324.82 examples/s]Tokenizing train dataset:  77%|███████▋  | 5162/6690 [00:15<00:05, 304.62 examples/s]Tokenizing train dataset:  78%|███████▊  | 5210/6690 [00:15<00:04, 303.64 examples/s]Tokenizing train dataset:  78%|███████▊  | 5249/6690 [00:15<00:04, 319.07 examples/s]Tokenizing train dataset:  79%|███████▉  | 5291/6690 [00:16<00:04, 338.32 examples/s]Tokenizing train dataset:  80%|███████▉  | 5329/6690 [00:16<00:03, 347.87 examples/s]Tokenizing train dataset:  80%|████████  | 5383/6690 [00:16<00:03, 333.35 examples/s]Tokenizing train dataset:  81%|████████▏ | 5436/6690 [00:16<00:03, 337.76 examples/s]Tokenizing train dataset:  82%|████████▏ | 5476/6690 [00:16<00:03, 348.53 examples/s]Tokenizing train dataset:  83%|████████▎ | 5525/6690 [00:16<00:03, 337.96 examples/s]Tokenizing train dataset:  83%|████████▎ | 5561/6690 [00:16<00:03, 342.34 examples/s]Tokenizing train dataset:  84%|████████▍ | 5617/6690 [00:17<00:03, 350.46 examples/s]Tokenizing train dataset:  85%|████████▍ | 5657/6690 [00:17<00:02, 357.55 examples/s]Tokenizing train dataset:  85%|████████▌ | 5707/6690 [00:17<00:02, 343.22 examples/s]Tokenizing train dataset:  86%|████████▌ | 5762/6690 [00:17<00:02, 344.02 examples/s]Tokenizing train dataset:  87%|████████▋ | 5805/6690 [00:17<00:02, 360.95 examples/s]Tokenizing train dataset:  87%|████████▋ | 5850/6690 [00:17<00:02, 336.11 examples/s]Tokenizing train dataset:  88%|████████▊ | 5912/6690 [00:17<00:02, 357.23 examples/s]Tokenizing train dataset:  89%|████████▉ | 5961/6690 [00:18<00:02, 343.66 examples/s]Tokenizing train dataset:  90%|████████▉ | 5998/6690 [00:18<00:01, 346.35 examples/s]Tokenizing train dataset:  90%|█████████ | 6046/6690 [00:18<00:01, 334.96 examples/s]Tokenizing train dataset:  91%|█████████ | 6101/6690 [00:18<00:01, 341.32 examples/s]Tokenizing train dataset:  92%|█████████▏| 6151/6690 [00:18<00:01, 373.83 examples/s]Tokenizing train dataset:  93%|█████████▎| 6208/6690 [00:18<00:01, 373.06 examples/s]Tokenizing train dataset:  94%|█████████▎| 6260/6690 [00:18<00:01, 291.47 examples/s]Tokenizing train dataset:  94%|█████████▍| 6306/6690 [00:19<00:01, 321.43 examples/s]Tokenizing train dataset:  95%|█████████▍| 6342/6690 [00:19<00:01, 328.03 examples/s]Tokenizing train dataset:  95%|█████████▌| 6383/6690 [00:19<00:01, 306.79 examples/s]Tokenizing train dataset:  96%|█████████▌| 6433/6690 [00:19<00:00, 304.57 examples/s]Tokenizing train dataset:  97%|█████████▋| 6478/6690 [00:19<00:00, 259.96 examples/s]Tokenizing train dataset:  97%|█████████▋| 6513/6690 [00:19<00:00, 276.15 examples/s]Tokenizing train dataset:  98%|█████████▊| 6555/6690 [00:20<00:00, 224.60 examples/s]Tokenizing train dataset:  99%|█████████▊| 6595/6690 [00:20<00:00, 256.12 examples/s]Tokenizing train dataset:  99%|█████████▉| 6633/6690 [00:20<00:00, 241.27 examples/s]Tokenizing train dataset: 100%|█████████▉| 6666/6690 [00:20<00:00, 258.80 examples/s]Tokenizing train dataset: 100%|██████████| 6690/6690 [00:20<00:00, 325.27 examples/s]
[rank0]:[W612 21:09:53.496581528 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
Extracting prompt in train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Extracting prompt in train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Extracting prompt in eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Extracting prompt in train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Extracting prompt in train dataset:   8%|▊         | 560/6690 [00:00<00:01, 5492.84 examples/s]Extracting prompt in train dataset:   8%|▊         | 550/6690 [00:00<00:01, 5433.47 examples/s]Extracting prompt in eval dataset:  60%|█████▉    | 570/953 [00:00<00:00, 5623.52 examples/s]Extracting prompt in train dataset:   8%|▊         | 550/6690 [00:00<00:01, 5425.34 examples/s]Extracting prompt in train dataset:  17%|█▋        | 1126/6690 [00:00<00:01, 3559.81 examples/s]Extracting prompt in eval dataset: 100%|██████████| 953/953 [00:00<00:00, 5306.45 examples/s]
Extracting prompt in train dataset:  19%|█▉        | 1270/6690 [00:00<00:01, 4962.14 examples/s]Extracting prompt in train dataset:  23%|██▎       | 1530/6690 [00:00<00:01, 3712.94 examples/s]Extracting prompt in train dataset:  19%|█▉        | 1296/6690 [00:00<00:01, 5101.88 examples/s]Extracting prompt in train dataset:  29%|██▉       | 1952/6690 [00:00<00:01, 3879.81 examples/s]Extracting prompt in train dataset:  29%|██▉       | 1970/6690 [00:00<00:00, 4793.83 examples/s]Extracting prompt in train dataset:  31%|███       | 2090/6690 [00:00<00:00, 5176.80 examples/s]Extracting prompt in train dataset:  38%|███▊      | 2513/6690 [00:00<00:01, 3820.07 examples/s]Extracting prompt in train dataset:  40%|████      | 2680/6690 [00:00<00:00, 4749.88 examples/s]Extracting prompt in train dataset:  44%|████▍     | 2940/6690 [00:00<00:00, 3939.64 examples/s]Extracting prompt in train dataset:  40%|███▉      | 2650/6690 [00:00<00:00, 4395.44 examples/s]Applying chat template to eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Extracting prompt in train dataset:  48%|████▊     | 3210/6690 [00:00<00:00, 4898.78 examples/s]Extracting prompt in train dataset:  52%|█████▏    | 3460/6690 [00:00<00:00, 4294.89 examples/s]Extracting prompt in train dataset:  47%|████▋     | 3170/6690 [00:00<00:00, 4609.63 examples/s]Applying chat template to eval dataset:  33%|███▎      | 315/953 [00:00<00:00, 3122.06 examples/s]Extracting prompt in train dataset:  56%|█████▌    | 3758/6690 [00:00<00:00, 5054.43 examples/s]Extracting prompt in train dataset:  60%|█████▉    | 3990/6690 [00:00<00:00, 4580.17 examples/s]Extracting prompt in train dataset:  55%|█████▌    | 3689/6690 [00:00<00:00, 4769.01 examples/s]Applying chat template to eval dataset:  81%|████████  | 774/953 [00:00<00:00, 3072.69 examples/s]Extracting prompt in train dataset:  67%|██████▋   | 4501/6690 [00:01<00:00, 4734.60 examples/s]Extracting prompt in train dataset:  65%|██████▍   | 4330/6690 [00:00<00:00, 4379.63 examples/s]Extracting prompt in train dataset:  63%|██████▎   | 4190/6690 [00:00<00:00, 4836.43 examples/s]Extracting prompt in train dataset:  75%|███████▌  | 5030/6690 [00:01<00:00, 4886.28 examples/s]Extracting prompt in train dataset:  72%|███████▏  | 4810/6690 [00:01<00:00, 4465.05 examples/s]Extracting prompt in train dataset:  74%|███████▍  | 4970/6690 [00:01<00:00, 4948.03 examples/s]Applying chat template to eval dataset: 100%|██████████| 953/953 [00:00<00:00, 1846.71 examples/s]
Extracting prompt in train dataset:  84%|████████▍ | 5610/6690 [00:01<00:00, 3587.02 examples/s]Extracting prompt in train dataset:  81%|████████  | 5388/6690 [00:01<00:00, 3413.13 examples/s]Extracting prompt in train dataset:  83%|████████▎ | 5550/6690 [00:01<00:00, 4017.86 examples/s]Extracting prompt in train dataset:  92%|█████████▏| 6160/6690 [00:01<00:00, 4010.54 examples/s]Extracting prompt in train dataset:  88%|████████▊ | 5920/6690 [00:01<00:00, 3813.63 examples/s]Extracting prompt in train dataset:  91%|█████████ | 6070/6690 [00:01<00:00, 4277.48 examples/s]Extracting prompt in train dataset: 100%|██████████| 6690/6690 [00:01<00:00, 3744.51 examples/s]Extracting prompt in train dataset: 100%|██████████| 6690/6690 [00:01<00:00, 3980.32 examples/s]
Extracting prompt in train dataset:  97%|█████████▋| 6497/6690 [00:01<00:00, 3621.79 examples/s]Extracting prompt in train dataset:  99%|█████████▉| 6650/6690 [00:01<00:00, 3882.67 examples/s]Tokenizing eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Extracting prompt in train dataset: 100%|██████████| 6690/6690 [00:01<00:00, 4189.48 examples/s]
Extracting prompt in train dataset: 100%|██████████| 6690/6690 [00:01<00:00, 3918.16 examples/s]
Tokenizing eval dataset:   3%|▎         | 33/953 [00:00<00:02, 319.28 examples/s]Applying chat template to train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Tokenizing eval dataset:   8%|▊         | 75/953 [00:00<00:04, 218.49 examples/s]Applying chat template to train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Applying chat template to train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Applying chat template to train dataset:   4%|▍         | 284/6690 [00:00<00:02, 2809.91 examples/s]Tokenizing eval dataset:  11%|█         | 103/953 [00:00<00:04, 202.24 examples/s]Applying chat template to train dataset:   4%|▍         | 290/6690 [00:00<00:02, 2870.78 examples/s]Applying chat template to train dataset:   4%|▍         | 291/6690 [00:00<00:02, 2876.07 examples/s]Applying chat template to train dataset:  10%|█         | 686/6690 [00:00<00:02, 2712.52 examples/s]Tokenizing eval dataset:  14%|█▍        | 138/953 [00:00<00:03, 211.24 examples/s]Applying chat template to train dataset:   9%|▉         | 611/6690 [00:00<00:03, 1748.26 examples/s]Applying chat template to train dataset:   9%|▉         | 610/6690 [00:00<00:03, 1922.57 examples/s]Applying chat template to train dataset:  15%|█▍        | 1000/6690 [00:00<00:02, 2160.90 examples/s]Applying chat template to train dataset:  13%|█▎        | 853/6690 [00:00<00:02, 1963.92 examples/s]Tokenizing eval dataset:  17%|█▋        | 164/953 [00:00<00:04, 165.25 examples/s]Applying chat template to train dataset:  14%|█▎        | 915/6690 [00:00<00:02, 2309.57 examples/s]Applying chat template to train dataset:  20%|█▉        | 1316/6690 [00:00<00:02, 1919.36 examples/s]Applying chat template to train dataset:  18%|█▊        | 1173/6690 [00:00<00:03, 1735.54 examples/s]Applying chat template to train dataset:  18%|█▊        | 1232/6690 [00:00<00:02, 2045.49 examples/s]Tokenizing eval dataset:  20%|█▉        | 188/953 [00:01<00:05, 147.46 examples/s]Applying chat template to train dataset:  24%|██▍       | 1610/6690 [00:00<00:02, 2170.25 examples/s]Applying chat template to train dataset:  22%|██▏       | 1478/6690 [00:00<00:02, 2062.60 examples/s]Applying chat template to train dataset:  23%|██▎       | 1538/6690 [00:00<00:02, 2318.74 examples/s]Tokenizing eval dataset:  23%|██▎       | 215/953 [00:01<00:04, 169.89 examples/s]Tokenizing eval dataset:  25%|██▌       | 242/953 [00:01<00:04, 166.41 examples/s]Applying chat template to train dataset:  29%|██▊       | 1923/6690 [00:01<00:02, 1640.95 examples/s]Applying chat template to train dataset:  27%|██▋       | 1799/6690 [00:00<00:02, 1769.58 examples/s]Applying chat template to train dataset:  28%|██▊       | 1857/6690 [00:00<00:02, 1896.35 examples/s]Tokenizing eval dataset:  30%|███       | 288/953 [00:01<00:02, 227.85 examples/s]Applying chat template to train dataset:  33%|███▎      | 2201/6690 [00:01<00:02, 1869.88 examples/s]Applying chat template to train dataset:  31%|███       | 2056/6690 [00:01<00:02, 1943.40 examples/s]Applying chat template to train dataset:  32%|███▏      | 2115/6690 [00:01<00:02, 2051.63 examples/s]Tokenizing eval dataset:  36%|███▌      | 341/953 [00:01<00:02, 296.24 examples/s]Applying chat template to train dataset:  38%|███▊      | 2509/6690 [00:01<00:02, 1897.35 examples/s]Applying chat template to train dataset:  35%|███▌      | 2374/6690 [00:01<00:02, 1941.72 examples/s]Tokenizing eval dataset:  41%|████      | 391/953 [00:01<00:01, 344.89 examples/s]Applying chat template to train dataset:  36%|███▋      | 2430/6690 [00:01<00:02, 1977.19 examples/s]Applying chat template to train dataset:  42%|████▏     | 2822/6690 [00:01<00:02, 1713.75 examples/s]Applying chat template to train dataset:  40%|████      | 2696/6690 [00:01<00:02, 1542.45 examples/s]Applying chat template to train dataset:  46%|████▌     | 3069/6690 [00:01<00:01, 1861.69 examples/s]Tokenizing eval dataset:  49%|████▉     | 466/953 [00:01<00:01, 293.96 examples/s]Applying chat template to train dataset:  41%|████      | 2750/6690 [00:01<00:02, 1534.46 examples/s]Applying chat template to train dataset:  45%|████▍     | 3002/6690 [00:01<00:02, 1820.12 examples/s]Applying chat template to train dataset:  49%|████▉     | 3300/6690 [00:01<00:01, 1959.36 examples/s]Tokenizing eval dataset:  55%|█████▌    | 527/953 [00:02<00:01, 321.92 examples/s]Applying chat template to train dataset:  46%|████▌     | 3070/6690 [00:01<00:02, 1671.16 examples/s]Applying chat template to train dataset:  49%|████▉     | 3307/6690 [00:01<00:01, 2074.89 examples/s]Applying chat template to train dataset:  55%|█████▍    | 3657/6690 [00:01<00:01, 2092.03 examples/s]Tokenizing eval dataset:  62%|██████▏   | 592/953 [00:02<00:00, 386.62 examples/s]Applying chat template to train dataset:  50%|█████     | 3346/6690 [00:01<00:01, 1878.33 examples/s]Applying chat template to train dataset:  58%|█████▊    | 3894/6690 [00:01<00:01, 2155.70 examples/s]Tokenizing eval dataset:  67%|██████▋   | 639/953 [00:02<00:00, 402.19 examples/s]Applying chat template to train dataset:  54%|█████▍    | 3626/6690 [00:01<00:01, 1971.58 examples/s]Applying chat template to train dataset:  55%|█████▍    | 3664/6690 [00:01<00:01, 1915.12 examples/s]Applying chat template to train dataset:  62%|██████▏   | 4170/6690 [00:02<00:01, 2306.25 examples/s]Tokenizing eval dataset:  72%|███████▏  | 684/953 [00:02<00:00, 411.32 examples/s]Applying chat template to train dataset:  58%|█████▊    | 3852/6690 [00:02<00:01, 2032.07 examples/s]Applying chat template to train dataset:  59%|█████▉    | 3947/6690 [00:02<00:01, 2110.29 examples/s]Tokenizing eval dataset:  77%|███████▋  | 730/953 [00:02<00:00, 418.89 examples/s]Applying chat template to train dataset:  68%|██████▊   | 4544/6690 [00:02<00:00, 2358.94 examples/s]Applying chat template to train dataset:  63%|██████▎   | 4223/6690 [00:02<00:01, 2170.23 examples/s]Applying chat template to train dataset:  64%|██████▍   | 4269/6690 [00:02<00:01, 1739.86 examples/s]Tokenizing eval dataset:  82%|████████▏ | 783/953 [00:02<00:00, 257.41 examples/s]Applying chat template to train dataset:  73%|███████▎  | 4857/6690 [00:02<00:01, 1374.97 examples/s]Applying chat template to train dataset:  68%|██████▊   | 4527/6690 [00:02<00:01, 1325.21 examples/s]Applying chat template to train dataset:  68%|██████▊   | 4570/6690 [00:02<00:01, 1450.11 examples/s]Tokenizing eval dataset:  88%|████████▊ | 842/953 [00:03<00:00, 289.52 examples/s]Applying chat template to train dataset:  77%|███████▋  | 5166/6690 [00:02<00:01, 1512.45 examples/s]Tokenizing eval dataset:  92%|█████████▏| 881/953 [00:03<00:00, 305.07 examples/s]Applying chat template to train dataset:  72%|███████▏  | 4850/6690 [00:02<00:01, 1498.71 examples/s]Applying chat template to train dataset:  73%|███████▎  | 4890/6690 [00:02<00:01, 1607.57 examples/s]Applying chat template to train dataset:  82%|████████▏ | 5477/6690 [00:02<00:00, 1563.54 examples/s]Tokenizing eval dataset:  98%|█████████▊| 933/953 [00:03<00:00, 285.68 examples/s]Applying chat template to train dataset:  77%|███████▋  | 5171/6690 [00:02<00:01, 1515.06 examples/s]Applying chat template to train dataset:  78%|███████▊  | 5209/6690 [00:02<00:00, 1528.24 examples/s]Applying chat template to train dataset:  86%|████████▌ | 5757/6690 [00:03<00:00, 1782.47 examples/s]Tokenizing eval dataset: 100%|██████████| 953/953 [00:03<00:00, 272.59 examples/s]
Applying chat template to train dataset:  82%|████████▏ | 5492/6690 [00:03<00:00, 1554.09 examples/s]Applying chat template to train dataset:  83%|████████▎ | 5530/6690 [00:03<00:00, 1606.52 examples/s]Applying chat template to train dataset:  91%|█████████ | 6069/6690 [00:03<00:00, 1863.24 examples/s]Applying chat template to train dataset:  87%|████████▋ | 5797/6690 [00:03<00:00, 1813.18 examples/s]Applying chat template to train dataset:  87%|████████▋ | 5790/6690 [00:03<00:00, 1784.25 examples/s]Applying chat template to train dataset:  95%|█████████▌| 6382/6690 [00:03<00:00, 1746.68 examples/s]Applying chat template to train dataset:  91%|█████████▏| 6121/6690 [00:03<00:00, 1870.44 examples/s]Applying chat template to train dataset:  91%|█████████▏| 6110/6690 [00:03<00:00, 1877.51 examples/s]Applying chat template to train dataset:  99%|█████████▉| 6638/6690 [00:03<00:00, 1904.72 examples/s]Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:03<00:00, 1876.40 examples/s]
Applying chat template to train dataset:  96%|█████████▌| 6414/6690 [00:03<00:00, 2083.87 examples/s]Applying chat template to train dataset:  96%|█████████▌| 6403/6690 [00:03<00:00, 2095.87 examples/s]Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:03<00:00, 1762.63 examples/s]Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:03<00:00, 1776.26 examples/s]
Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:03<00:00, 1586.54 examples/s]Applying chat template to train dataset: 100%|██████████| 6690/6690 [00:03<00:00, 1760.99 examples/s]
Tokenizing train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Tokenizing train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Tokenizing train dataset:   1%|          | 44/6690 [00:00<00:15, 420.10 examples/s]Tokenizing train dataset:   0%|          | 0/6690 [00:00<?, ? examples/s]Tokenizing train dataset:   1%|          | 44/6690 [00:00<00:15, 421.81 examples/s]Tokenizing train dataset:   1%|▏         | 90/6690 [00:00<00:19, 331.90 examples/s]Tokenizing train dataset:   1%|          | 44/6690 [00:00<00:15, 422.00 examples/s]Tokenizing train dataset:   2%|▏         | 103/6690 [00:00<00:16, 392.17 examples/s]Tokenizing train dataset:   2%|▏         | 130/6690 [00:00<00:23, 276.15 examples/s]Tokenizing train dataset:   1%|▏         | 93/6690 [00:00<00:18, 353.64 examples/s]Tokenizing train dataset:   2%|▏         | 166/6690 [00:00<00:16, 398.88 examples/s]Tokenizing train dataset:   3%|▎         | 178/6690 [00:00<00:39, 166.89 examples/s]Tokenizing train dataset:   2%|▏         | 140/6690 [00:00<00:41, 159.71 examples/s]Tokenizing train dataset:   3%|▎         | 210/6690 [00:00<00:32, 201.15 examples/s]Tokenizing train dataset:   3%|▎         | 209/6690 [00:00<00:33, 191.54 examples/s]Tokenizing train dataset:   3%|▎         | 168/6690 [00:00<00:37, 172.05 examples/s]Tokenizing train dataset:   4%|▎         | 236/6690 [00:01<00:32, 197.95 examples/s]Tokenizing train dataset:   4%|▍         | 259/6690 [00:01<00:28, 222.58 examples/s]Tokenizing train dataset:   3%|▎         | 196/6690 [00:01<00:38, 170.72 examples/s]Tokenizing train dataset:   4%|▍         | 260/6690 [00:01<00:33, 189.47 examples/s]Tokenizing train dataset:   4%|▍         | 300/6690 [00:01<00:29, 214.67 examples/s]Tokenizing train dataset:   3%|▎         | 221/6690 [00:01<00:37, 172.57 examples/s]Tokenizing train dataset:   4%|▍         | 284/6690 [00:01<00:34, 184.13 examples/s]Tokenizing train dataset:   5%|▌         | 335/6690 [00:01<00:26, 237.94 examples/s]Tokenizing train dataset:   4%|▎         | 245/6690 [00:01<00:34, 184.54 examples/s]Tokenizing train dataset:   6%|▌         | 383/6690 [00:01<00:22, 285.88 examples/s]Tokenizing train dataset:   5%|▍         | 326/6690 [00:01<00:30, 210.92 examples/s]Tokenizing train dataset:   4%|▍         | 288/6690 [00:01<00:26, 237.93 examples/s]Tokenizing train dataset:   6%|▋         | 429/6690 [00:01<00:27, 227.85 examples/s]Tokenizing train dataset:   5%|▌         | 349/6690 [00:01<00:41, 151.78 examples/s]Tokenizing train dataset:   5%|▌         | 336/6690 [00:01<00:32, 195.31 examples/s]Tokenizing train dataset:   7%|▋         | 473/6690 [00:01<00:23, 264.86 examples/s]Tokenizing train dataset:   6%|▌         | 392/6690 [00:01<00:31, 201.67 examples/s]Tokenizing train dataset:   5%|▌         | 366/6690 [00:01<00:38, 163.80 examples/s]Tokenizing train dataset:   8%|▊         | 517/6690 [00:02<00:29, 208.61 examples/s]Tokenizing train dataset:   7%|▋         | 440/6690 [00:02<00:35, 178.20 examples/s]Tokenizing train dataset:   6%|▌         | 410/6690 [00:02<00:29, 210.33 examples/s]Tokenizing train dataset:   8%|▊         | 544/6690 [00:02<00:28, 218.20 examples/s]Tokenizing train dataset:   7%|▋         | 465/6690 [00:02<00:33, 185.12 examples/s]Tokenizing train dataset:   9%|▉         | 587/6690 [00:02<00:23, 255.46 examples/s]Tokenizing train dataset:   7%|▋         | 464/6690 [00:02<00:26, 231.20 examples/s]Tokenizing train dataset:   8%|▊         | 509/6690 [00:02<00:26, 232.22 examples/s]Tokenizing train dataset:   9%|▉         | 618/6690 [00:02<00:22, 265.99 examples/s]Tokenizing train dataset:   8%|▊         | 514/6690 [00:02<00:25, 238.75 examples/s]Tokenizing train dataset:  10%|▉         | 653/6690 [00:02<00:21, 284.18 examples/s]Tokenizing train dataset:   8%|▊         | 559/6690 [00:02<00:26, 233.13 examples/s]Tokenizing train dataset:   8%|▊         | 551/6690 [00:02<00:23, 262.59 examples/s]Tokenizing train dataset:  10%|█         | 690/6690 [00:02<00:19, 303.89 examples/s]Tokenizing train dataset:   9%|▉         | 605/6690 [00:02<00:22, 275.54 examples/s]Tokenizing train dataset:   9%|▊         | 581/6690 [00:02<00:24, 250.15 examples/s]Tokenizing train dataset:  11%|█         | 741/6690 [00:02<00:20, 283.84 examples/s]Tokenizing train dataset:  10%|▉         | 652/6690 [00:02<00:22, 265.98 examples/s]Tokenizing train dataset:   9%|▉         | 632/6690 [00:02<00:22, 264.66 examples/s]Tokenizing train dataset:  12%|█▏        | 792/6690 [00:03<00:21, 278.38 examples/s]Tokenizing train dataset:  10%|█         | 701/6690 [00:03<00:22, 266.42 examples/s]Tokenizing train dataset:  12%|█▏        | 828/6690 [00:03<00:19, 294.58 examples/s]Tokenizing train dataset:  10%|█         | 681/6690 [00:03<00:22, 261.31 examples/s]Tokenizing train dataset:  11%|█         | 747/6690 [00:03<00:19, 303.17 examples/s]Tokenizing train dataset:  13%|█▎        | 866/6690 [00:03<00:18, 311.96 examples/s]Tokenizing train dataset:  11%|█         | 727/6690 [00:03<00:19, 301.18 examples/s]Tokenizing train dataset:  12%|█▏        | 792/6690 [00:03<00:17, 332.18 examples/s]Tokenizing train dataset:  11%|█▏        | 766/6690 [00:03<00:18, 318.64 examples/s]Tokenizing train dataset:  14%|█▎        | 916/6690 [00:03<00:18, 313.56 examples/s]Tokenizing train dataset:  13%|█▎        | 848/6690 [00:03<00:17, 342.73 examples/s]Tokenizing train dataset:  12%|█▏        | 803/6690 [00:03<00:17, 329.46 examples/s]Tokenizing train dataset:  14%|█▍        | 957/6690 [00:03<00:17, 334.82 examples/s]Tokenizing train dataset:  13%|█▎        | 888/6690 [00:03<00:16, 352.50 examples/s]Tokenizing train dataset:  13%|█▎        | 859/6690 [00:03<00:16, 343.07 examples/s]Tokenizing train dataset:  15%|█▍        | 992/6690 [00:03<00:16, 337.41 examples/s]Tokenizing train dataset:  14%|█▍        | 947/6690 [00:03<00:15, 362.81 examples/s]Tokenizing train dataset:  13%|█▎        | 903/6690 [00:03<00:20, 283.44 examples/s]Tokenizing train dataset:  15%|█▌        | 1035/6690 [00:04<00:27, 205.65 examples/s]Tokenizing train dataset:  15%|█▍        | 990/6690 [00:04<00:23, 240.28 examples/s]Tokenizing train dataset:  14%|█▍        | 950/6690 [00:03<00:21, 265.66 examples/s]Tokenizing train dataset:  16%|█▌        | 1081/6690 [00:04<00:22, 248.47 examples/s]Tokenizing train dataset:  15%|█▌        | 1036/6690 [00:04<00:22, 251.02 examples/s]Tokenizing train dataset:  15%|█▍        | 997/6690 [00:04<00:20, 275.94 examples/s]Tokenizing train dataset:  17%|█▋        | 1119/6690 [00:04<00:20, 273.31 examples/s]Tokenizing train dataset:  16%|█▌        | 1082/6690 [00:04<00:19, 288.46 examples/s]Tokenizing train dataset:  16%|█▌        | 1043/6690 [00:04<00:18, 312.18 examples/s]Tokenizing train dataset:  18%|█▊        | 1173/6690 [00:04<00:18, 295.34 examples/s]Tokenizing train dataset:  17%|█▋        | 1119/6690 [00:04<00:18, 304.92 examples/s]Tokenizing train dataset:  16%|█▋        | 1089/6690 [00:04<00:16, 343.26 examples/s]Tokenizing train dataset:  18%|█▊        | 1212/6690 [00:04<00:17, 313.52 examples/s]Tokenizing train dataset:  18%|█▊        | 1178/6690 [00:04<00:16, 328.02 examples/s]Tokenizing train dataset:  17%|█▋        | 1136/6690 [00:04<00:17, 312.40 examples/s]Tokenizing train dataset:  19%|█▊        | 1254/6690 [00:04<00:19, 285.66 examples/s]Tokenizing train dataset:  18%|█▊        | 1175/6690 [00:04<00:16, 329.23 examples/s]Tokenizing train dataset:  18%|█▊        | 1219/6690 [00:04<00:17, 309.55 examples/s]Tokenizing train dataset:  19%|█▉        | 1297/6690 [00:04<00:19, 277.46 examples/s]Tokenizing train dataset:  18%|█▊        | 1224/6690 [00:04<00:16, 322.66 examples/s]Tokenizing train dataset:  19%|█▉        | 1264/6690 [00:05<00:19, 271.39 examples/s]Tokenizing train dataset:  20%|██        | 1340/6690 [00:04<00:17, 309.96 examples/s]Tokenizing train dataset:  19%|█▉        | 1269/6690 [00:04<00:15, 348.63 examples/s]Tokenizing train dataset:  20%|█▉        | 1311/6690 [00:05<00:20, 264.52 examples/s]Tokenizing train dataset:  21%|██        | 1385/6690 [00:05<00:20, 254.42 examples/s]Tokenizing train dataset:  20%|█▉        | 1321/6690 [00:05<00:18, 295.16 examples/s]Tokenizing train dataset:  20%|██        | 1359/6690 [00:05<00:17, 304.69 examples/s]Tokenizing train dataset:  21%|██▏       | 1423/6690 [00:05<00:23, 219.85 examples/s]Tokenizing train dataset:  20%|██        | 1369/6690 [00:05<00:20, 257.65 examples/s]Tokenizing train dataset:  21%|██        | 1396/6690 [00:05<00:20, 253.80 examples/s]Tokenizing train dataset:  22%|██▏       | 1460/6690 [00:05<00:21, 243.92 examples/s]Tokenizing train dataset:  21%|██        | 1407/6690 [00:05<00:18, 278.58 examples/s]Tokenizing train dataset:  21%|██▏       | 1434/6690 [00:05<00:18, 277.29 examples/s]Tokenizing train dataset:  23%|██▎       | 1507/6690 [00:05<00:20, 252.75 examples/s]Tokenizing train dataset:  22%|██▏       | 1452/6690 [00:05<00:19, 264.35 examples/s]Tokenizing train dataset:  22%|██▏       | 1475/6690 [00:05<00:21, 247.85 examples/s]Tokenizing train dataset:  23%|██▎       | 1551/6690 [00:05<00:17, 287.72 examples/s]Tokenizing train dataset:  22%|██▏       | 1493/6690 [00:05<00:17, 291.49 examples/s]Tokenizing train dataset:  23%|██▎       | 1524/6690 [00:05<00:17, 296.48 examples/s]Tokenizing train dataset:  23%|██▎       | 1546/6690 [00:05<00:14, 343.64 examples/s]Tokenizing train dataset:  24%|██▍       | 1601/6690 [00:05<00:17, 298.79 examples/s]Tokenizing train dataset:  23%|██▎       | 1563/6690 [00:06<00:16, 313.10 examples/s]Tokenizing train dataset:  24%|██▍       | 1603/6690 [00:05<00:14, 354.64 examples/s]Tokenizing train dataset:  25%|██▍       | 1650/6690 [00:06<00:16, 304.27 examples/s]Tokenizing train dataset:  24%|██▍       | 1605/6690 [00:06<00:17, 297.12 examples/s]Tokenizing train dataset:  25%|██▍       | 1649/6690 [00:06<00:18, 272.14 examples/s]Tokenizing train dataset:  25%|██▌       | 1695/6690 [00:06<00:19, 253.28 examples/s]Tokenizing train dataset:  25%|██▍       | 1649/6690 [00:06<00:20, 245.01 examples/s]Tokenizing train dataset:  25%|██▌       | 1693/6690 [00:06<00:16, 303.43 examples/s]Tokenizing train dataset:  26%|██▌       | 1739/6690 [00:06<00:17, 286.06 examples/s]Tokenizing train dataset:  25%|██▌       | 1700/6690 [00:06<00:18, 266.65 examples/s]Tokenizing train dataset:  26%|██▌       | 1732/6690 [00:06<00:15, 321.56 examples/s]Tokenizing train dataset:  27%|██▋       | 1791/6690 [00:06<00:16, 300.53 examples/s]Tokenizing train dataset:  27%|██▋       | 1831/6690 [00:06<00:15, 319.73 examples/s]Tokenizing train dataset:  26%|██▌       | 1749/6690 [00:06<00:19, 257.60 examples/s]Tokenizing train dataset:  27%|██▋       | 1779/6690 [00:06<00:16, 300.17 examples/s]Tokenizing train dataset:  28%|██▊       | 1886/6690 [00:06<00:14, 330.39 examples/s]Tokenizing train dataset:  27%|██▋       | 1789/6690 [00:06<00:19, 248.71 examples/s]Tokenizing train dataset:  27%|██▋       | 1825/6690 [00:06<00:16, 287.73 examples/s]Tokenizing train dataset:  27%|██▋       | 1831/6690 [00:07<00:17, 281.16 examples/s]Tokenizing train dataset:  28%|██▊       | 1864/6690 [00:06<00:15, 305.91 examples/s]Tokenizing train dataset:  29%|██▉       | 1942/6690 [00:07<00:14, 337.70 examples/s]Tokenizing train dataset:  28%|██▊       | 1900/6690 [00:07<00:15, 310.91 examples/s]Tokenizing train dataset:  28%|██▊       | 1881/6690 [00:07<00:16, 294.42 examples/s]Tokenizing train dataset:  30%|██▉       | 1995/6690 [00:07<00:13, 336.56 examples/s]Tokenizing train dataset:  29%|██▉       | 1939/6690 [00:07<00:14, 328.44 examples/s]Tokenizing train dataset:  29%|██▉       | 1931/6690 [00:07<00:15, 303.51 examples/s]Tokenizing train dataset:  30%|██▉       | 1979/6690 [00:07<00:13, 341.98 examples/s]Tokenizing train dataset:  31%|███       | 2044/6690 [00:07<00:14, 330.32 examples/s]Tokenizing train dataset:  30%|██▉       | 1976/6690 [00:07<00:18, 251.16 examples/s]Tokenizing train dataset:  30%|███       | 2023/6690 [00:07<00:17, 267.00 examples/s]Tokenizing train dataset:  31%|███       | 2087/6690 [00:07<00:16, 277.10 examples/s]Tokenizing train dataset:  30%|███       | 2010/6690 [00:07<00:17, 266.29 examples/s]Tokenizing train dataset:  31%|███       | 2063/6690 [00:07<00:15, 293.54 examples/s]Tokenizing train dataset:  32%|███▏      | 2128/6690 [00:07<00:15, 301.48 examples/s]Tokenizing train dataset:  31%|███       | 2041/6690 [00:07<00:16, 274.42 examples/s]Tokenizing train dataset:  31%|███▏      | 2099/6690 [00:07<00:14, 306.87 examples/s]Tokenizing train dataset:  33%|███▎      | 2182/6690 [00:07<00:14, 316.25 examples/s]Tokenizing train dataset:  31%|███       | 2076/6690 [00:07<00:15, 291.55 examples/s]Tokenizing train dataset:  32%|███▏      | 2135/6690 [00:07<00:14, 317.99 examples/s]Tokenizing train dataset:  33%|███▎      | 2220/6690 [00:07<00:13, 326.89 examples/s]Tokenizing train dataset:  32%|███▏      | 2125/6690 [00:08<00:15, 297.62 examples/s]Tokenizing train dataset:  33%|███▎      | 2192/6690 [00:07<00:13, 338.27 examples/s]Tokenizing train dataset:  34%|███▎      | 2256/6690 [00:08<00:13, 333.38 examples/s]Tokenizing train dataset:  32%|███▏      | 2170/6690 [00:08<00:13, 330.25 examples/s]Tokenizing train dataset:  33%|███▎      | 2237/6690 [00:08<00:12, 364.71 examples/s]Tokenizing train dataset:  34%|███▍      | 2300/6690 [00:08<00:14, 308.39 examples/s]Tokenizing train dataset:  33%|███▎      | 2211/6690 [00:08<00:12, 348.05 examples/s]Tokenizing train dataset:  34%|███▍      | 2281/6690 [00:08<00:15, 286.17 examples/s]Tokenizing train dataset:  35%|███▌      | 2347/6690 [00:08<00:15, 287.68 examples/s]Tokenizing train dataset:  34%|███▎      | 2256/6690 [00:08<00:14, 314.46 examples/s]Tokenizing train dataset:  35%|███▍      | 2319/6690 [00:08<00:14, 306.13 examples/s]Tokenizing train dataset:  36%|███▌      | 2390/6690 [00:08<00:13, 318.22 examples/s]Tokenizing train dataset:  34%|███▍      | 2308/6690 [00:08<00:13, 322.44 examples/s]Tokenizing train dataset:  35%|███▌      | 2361/6690 [00:08<00:13, 330.92 examples/s]Tokenizing train dataset:  36%|███▋      | 2428/6690 [00:08<00:12, 328.44 examples/s]Tokenizing train dataset:  35%|███▌      | 2352/6690 [00:08<00:12, 346.42 examples/s]Tokenizing train dataset:  36%|███▌      | 2403/6690 [00:08<00:12, 352.52 examples/s]Tokenizing train dataset:  37%|███▋      | 2471/6690 [00:08<00:12, 350.43 examples/s]Tokenizing train dataset:  36%|███▌      | 2393/6690 [00:08<00:11, 360.77 examples/s]Tokenizing train dataset:  38%|███▊      | 2510/6690 [00:08<00:11, 359.81 examples/s]Tokenizing train dataset:  37%|███▋      | 2469/6690 [00:08<00:11, 380.12 examples/s]Tokenizing train dataset:  38%|███▊      | 2552/6690 [00:08<00:11, 372.48 examples/s]Tokenizing train dataset:  37%|███▋      | 2447/6690 [00:09<00:11, 358.97 examples/s]Tokenizing train dataset:  38%|███▊      | 2524/6690 [00:08<00:11, 372.66 examples/s]Tokenizing train dataset:  39%|███▉      | 2604/6690 [00:09<00:11, 359.58 examples/s]Tokenizing train dataset:  37%|███▋      | 2502/6690 [00:09<00:11, 359.23 examples/s]Tokenizing train dataset:  39%|███▊      | 2589/6690 [00:09<00:10, 385.19 examples/s]Tokenizing train dataset:  40%|███▉      | 2645/6690 [00:09<00:12, 323.25 examples/s]Tokenizing train dataset:  38%|███▊      | 2559/6690 [00:09<00:11, 359.57 examples/s]Tokenizing train dataset:  39%|███▉      | 2629/6690 [00:09<00:10, 384.37 examples/s]Tokenizing train dataset:  40%|████      | 2681/6690 [00:09<00:12, 329.24 examples/s]Tokenizing train dataset:  39%|███▉      | 2604/6690 [00:09<00:10, 378.51 examples/s]Tokenizing train dataset:  40%|████      | 2690/6690 [00:09<00:10, 388.52 examples/s]Tokenizing train dataset:  41%|████      | 2722/6690 [00:09<00:13, 284.91 examples/s]Tokenizing train dataset:  40%|███▉      | 2645/6690 [00:09<00:12, 312.49 examples/s]Tokenizing train dataset:  41%|████      | 2736/6690 [00:09<00:10, 360.40 examples/s]Tokenizing train dataset:  41%|████▏     | 2760/6690 [00:09<00:13, 302.25 examples/s]Tokenizing train dataset:  40%|████      | 2684/6690 [00:09<00:12, 327.41 examples/s]Tokenizing train dataset:  42%|████▏     | 2787/6690 [00:09<00:11, 349.46 examples/s]Tokenizing train dataset:  42%|████▏     | 2802/6690 [00:09<00:15, 255.70 examples/s]Tokenizing train dataset:  41%|████      | 2727/6690 [00:10<00:18, 208.85 examples/s]Tokenizing train dataset:  42%|████▏     | 2833/6690 [00:09<00:16, 237.23 examples/s]Tokenizing train dataset:  43%|████▎     | 2844/6690 [00:10<00:16, 229.19 examples/s]Tokenizing train dataset:  41%|████      | 2758/6690 [00:10<00:17, 224.74 examples/s]Tokenizing train dataset:  43%|████▎     | 2875/6690 [00:10<00:14, 266.20 examples/s]Tokenizing train dataset:  44%|████▎     | 2914/6690 [00:10<00:13, 288.69 examples/s]Tokenizing train dataset:  43%|████▎     | 2887/6690 [00:10<00:16, 223.86 examples/s]Tokenizing train dataset:  42%|████▏     | 2800/6690 [00:10<00:16, 233.61 examples/s]Tokenizing train dataset:  44%|████▎     | 2916/6690 [00:10<00:17, 220.71 examples/s]Tokenizing train dataset:  44%|████▍     | 2963/6690 [00:10<00:13, 286.29 examples/s]Tokenizing train dataset:  42%|████▏     | 2840/6690 [00:10<00:17, 219.61 examples/s]Tokenizing train dataset:  43%|████▎     | 2871/6690 [00:10<00:16, 235.34 examples/s]Tokenizing train dataset:  44%|████▍     | 2963/6690 [00:10<00:16, 223.54 examples/s]Tokenizing train dataset:  45%|████▌     | 3015/6690 [00:10<00:12, 288.09 examples/s]Tokenizing train dataset:  43%|████▎     | 2901/6690 [00:10<00:15, 248.35 examples/s]Tokenizing train dataset:  45%|████▍     | 2991/6690 [00:10<00:15, 233.29 examples/s]Tokenizing train dataset:  46%|████▌     | 3069/6690 [00:10<00:11, 303.05 examples/s]Tokenizing train dataset:  45%|████▌     | 3018/6690 [00:10<00:15, 239.38 examples/s]Tokenizing train dataset:  44%|████▍     | 2952/6690 [00:10<00:13, 272.11 examples/s]Tokenizing train dataset:  46%|████▋     | 3105/6690 [00:10<00:11, 312.58 examples/s]Tokenizing train dataset:  46%|████▌     | 3066/6690 [00:10<00:12, 292.11 examples/s]Tokenizing train dataset:  45%|████▍     | 3003/6690 [00:11<00:12, 289.60 examples/s]Tokenizing train dataset:  47%|████▋     | 3112/6690 [00:11<00:10, 330.00 examples/s]Tokenizing train dataset:  47%|████▋     | 3160/6690 [00:10<00:10, 326.78 examples/s]Tokenizing train dataset:  46%|████▌     | 3051/6690 [00:11<00:12, 285.41 examples/s]Tokenizing train dataset:  47%|████▋     | 3151/6690 [00:11<00:12, 286.60 examples/s]Tokenizing train dataset:  48%|████▊     | 3208/6690 [00:11<00:11, 307.98 examples/s]Tokenizing train dataset:  46%|████▌     | 3094/6690 [00:11<00:11, 315.64 examples/s]Tokenizing train dataset:  48%|████▊     | 3242/6690 [00:11<00:11, 311.82 examples/s]Tokenizing train dataset:  48%|████▊     | 3203/6690 [00:11<00:11, 303.92 examples/s]Tokenizing train dataset:  49%|████▉     | 3283/6690 [00:11<00:10, 331.30 examples/s]Tokenizing train dataset:  47%|████▋     | 3139/6690 [00:11<00:11, 308.99 examples/s]Tokenizing train dataset:  49%|████▊     | 3251/6690 [00:11<00:11, 295.82 examples/s]Tokenizing train dataset:  48%|████▊     | 3180/6690 [00:11<00:10, 330.81 examples/s]Tokenizing train dataset:  50%|████▉     | 3338/6690 [00:11<00:09, 339.58 examples/s]Tokenizing train dataset:  49%|████▉     | 3296/6690 [00:11<00:12, 274.87 examples/s]Tokenizing train dataset:  48%|████▊     | 3228/6690 [00:11<00:11, 299.00 examples/s]Tokenizing train dataset:  51%|█████     | 3381/6690 [00:11<00:10, 305.81 examples/s]Tokenizing train dataset:  50%|████▉     | 3342/6690 [00:11<00:11, 281.47 examples/s]Tokenizing train dataset:  49%|████▉     | 3280/6690 [00:11<00:11, 308.92 examples/s]Tokenizing train dataset:  51%|█████     | 3421/6690 [00:11<00:11, 284.39 examples/s]Tokenizing train dataset:  51%|█████     | 3379/6690 [00:11<00:11, 296.10 examples/s]Tokenizing train dataset:  50%|████▉     | 3313/6690 [00:12<00:10, 309.40 examples/s]Tokenizing train dataset:  52%|█████▏    | 3457/6690 [00:11<00:10, 300.65 examples/s]Tokenizing train dataset:  51%|█████     | 3411/6690 [00:12<00:10, 300.14 examples/s]Tokenizing train dataset:  50%|█████     | 3353/6690 [00:12<00:10, 328.80 examples/s]Tokenizing train dataset:  52%|█████▏    | 3503/6690 [00:12<00:09, 336.33 examples/s]Tokenizing train dataset:  52%|█████▏    | 3448/6690 [00:12<00:12, 261.18 examples/s]Tokenizing train dataset:  51%|█████     | 3390/6690 [00:12<00:11, 280.24 examples/s]Tokenizing train dataset:  53%|█████▎    | 3543/6690 [00:12<00:11, 274.63 examples/s]Tokenizing train dataset:  52%|█████▏    | 3485/6690 [00:12<00:11, 283.59 examples/s]Tokenizing train dataset:  51%|█████     | 3421/6690 [00:12<00:11, 285.50 examples/s]Tokenizing train dataset:  53%|█████▎    | 3575/6690 [00:12<00:10, 283.30 examples/s]Tokenizing train dataset:  53%|█████▎    | 3531/6690 [00:12<00:11, 285.96 examples/s]Tokenizing train dataset:  54%|█████▍    | 3610/6690 [00:12<00:10, 296.27 examples/s]Tokenizing train dataset:  52%|█████▏    | 3470/6690 [00:12<00:10, 293.87 examples/s]Tokenizing train dataset:  53%|█████▎    | 3575/6690 [00:12<00:10, 286.00 examples/s]Tokenizing train dataset:  55%|█████▍    | 3663/6690 [00:12<00:09, 313.38 examples/s]Tokenizing train dataset:  53%|█████▎    | 3515/6690 [00:12<00:12, 249.90 examples/s]Tokenizing train dataset:  54%|█████▍    | 3613/6690 [00:12<00:12, 241.29 examples/s]Tokenizing train dataset:  55%|█████▌    | 3703/6690 [00:12<00:12, 239.01 examples/s]Tokenizing train dataset:  53%|█████▎    | 3553/6690 [00:13<00:13, 234.60 examples/s]Tokenizing train dataset:  55%|█████▍    | 3655/6690 [00:12<00:10, 276.69 examples/s]Tokenizing train dataset:  55%|█████▌    | 3689/6690 [00:13<00:10, 289.31 examples/s]Tokenizing train dataset:  56%|█████▌    | 3749/6690 [00:13<00:11, 252.89 examples/s]Tokenizing train dataset:  54%|█████▎    | 3591/6690 [00:13<00:13, 236.30 examples/s]Tokenizing train dataset:  57%|█████▋    | 3781/6690 [00:13<00:10, 265.39 examples/s]Tokenizing train dataset:  54%|█████▍    | 3620/6690 [00:13<00:12, 245.78 examples/s]Tokenizing train dataset:  56%|█████▌    | 3725/6690 [00:13<00:10, 272.53 examples/s]Tokenizing train dataset:  57%|█████▋    | 3812/6690 [00:13<00:10, 274.09 examples/s]Tokenizing train dataset:  55%|█████▍    | 3657/6690 [00:13<00:11, 272.33 examples/s]Tokenizing train dataset:  56%|█████▋    | 3764/6690 [00:13<00:09, 298.16 examples/s]Tokenizing train dataset:  58%|█████▊    | 3851/6690 [00:13<00:09, 299.09 examples/s]Tokenizing train dataset:  55%|█████▌    | 3688/6690 [00:13<00:10, 280.79 examples/s]Tokenizing train dataset:  57%|█████▋    | 3804/6690 [00:13<00:09, 319.55 examples/s]Tokenizing train dataset:  58%|█████▊    | 3898/6690 [00:13<00:08, 340.22 examples/s]Tokenizing train dataset:  56%|█████▌    | 3720/6690 [00:13<00:10, 281.84 examples/s]Tokenizing train dataset:  57%|█████▋    | 3845/6690 [00:13<00:08, 340.06 examples/s]Tokenizing train dataset:  59%|█████▉    | 3950/6690 [00:13<00:08, 338.00 examples/s]Tokenizing train dataset:  56%|█████▋    | 3769/6690 [00:13<00:09, 296.32 examples/s]Tokenizing train dataset:  58%|█████▊    | 3906/6690 [00:13<00:07, 361.65 examples/s]Tokenizing train dataset:  60%|█████▉    | 3994/6690 [00:13<00:07, 358.16 examples/s]Tokenizing train dataset:  57%|█████▋    | 3803/6690 [00:13<00:09, 305.58 examples/s]Tokenizing train dataset:  59%|█████▉    | 3952/6690 [00:13<00:08, 335.06 examples/s]Tokenizing train dataset:  60%|██████    | 4040/6690 [00:13<00:09, 273.05 examples/s]Tokenizing train dataset:  58%|█████▊    | 3850/6690 [00:14<00:11, 244.83 examples/s]Tokenizing train dataset:  60%|█████▉    | 4001/6690 [00:14<00:08, 305.91 examples/s]Tokenizing train dataset:  61%|██████    | 4080/6690 [00:14<00:08, 296.09 examples/s]Tokenizing train dataset:  58%|█████▊    | 3890/6690 [00:14<00:10, 273.39 examples/s]Tokenizing train dataset:  60%|██████    | 4040/6690 [00:14<00:09, 286.18 examples/s]Tokenizing train dataset:  62%|██████▏   | 4131/6690 [00:14<00:09, 282.98 examples/s]Tokenizing train dataset:  59%|█████▉    | 3938/6690 [00:14<00:10, 256.89 examples/s]Tokenizing train dataset:  61%|██████    | 4085/6690 [00:14<00:09, 287.06 examples/s]Tokenizing train dataset:  62%|██████▏   | 4173/6690 [00:14<00:08, 307.13 examples/s]Tokenizing train dataset:  59%|█████▉    | 3976/6690 [00:14<00:09, 280.25 examples/s]Tokenizing train dataset:  62%|██████▏   | 4126/6690 [00:14<00:08, 309.24 examples/s]Tokenizing train dataset:  63%|██████▎   | 4215/6690 [00:14<00:07, 331.45 examples/s]Tokenizing train dataset:  60%|██████    | 4020/6690 [00:14<00:08, 315.50 examples/s]Tokenizing train dataset:  62%|██████▏   | 4172/6690 [00:14<00:07, 340.64 examples/s]Tokenizing train dataset:  64%|██████▎   | 4257/6690 [00:14<00:06, 349.99 examples/s]Tokenizing train dataset:  63%|██████▎   | 4211/6690 [00:14<00:07, 348.68 examples/s]Tokenizing train dataset:  61%|██████    | 4069/6690 [00:14<00:08, 316.41 examples/s]Tokenizing train dataset:  64%|██████▎   | 4252/6690 [00:14<00:06, 361.89 examples/s]Tokenizing train dataset:  64%|██████▍   | 4313/6690 [00:14<00:06, 355.11 examples/s]Tokenizing train dataset:  61%|██████▏   | 4111/6690 [00:15<00:09, 266.65 examples/s]Tokenizing train dataset:  64%|██████▍   | 4293/6690 [00:14<00:07, 309.50 examples/s]Tokenizing train dataset:  65%|██████▌   | 4358/6690 [00:14<00:07, 309.79 examples/s]Tokenizing train dataset:  62%|██████▏   | 4158/6690 [00:15<00:13, 181.12 examples/s]Tokenizing train dataset:  65%|██████▍   | 4340/6690 [00:15<00:13, 175.87 examples/s]Tokenizing train dataset:  66%|██████▌   | 4399/6690 [00:15<00:13, 171.60 examples/s]Tokenizing train dataset:  63%|██████▎   | 4205/6690 [00:15<00:12, 196.55 examples/s]Tokenizing train dataset:  65%|██████▌   | 4370/6690 [00:15<00:12, 192.45 examples/s]Tokenizing train dataset:  66%|██████▌   | 4430/6690 [00:15<00:11, 190.71 examples/s]Tokenizing train dataset:  63%|██████▎   | 4246/6690 [00:15<00:10, 229.08 examples/s]Tokenizing train dataset:  66%|██████▌   | 4409/6690 [00:15<00:10, 226.39 examples/s]Tokenizing train dataset:  67%|██████▋   | 4472/6690 [00:15<00:09, 227.66 examples/s]Tokenizing train dataset:  64%|██████▍   | 4280/6690 [00:15<00:09, 246.81 examples/s]Tokenizing train dataset:  67%|██████▋   | 4504/6690 [00:15<00:08, 243.39 examples/s]Tokenizing train dataset:  67%|██████▋   | 4457/6690 [00:15<00:09, 247.23 examples/s]Tokenizing train dataset:  65%|██████▍   | 4325/6690 [00:15<00:08, 287.21 examples/s]Tokenizing train dataset:  68%|██████▊   | 4538/6690 [00:15<00:08, 264.01 examples/s]Tokenizing train dataset:  67%|██████▋   | 4495/6690 [00:15<00:08, 270.49 examples/s]Tokenizing train dataset:  65%|██████▌   | 4362/6690 [00:16<00:07, 301.31 examples/s]Tokenizing train dataset:  69%|██████▊   | 4585/6690 [00:16<00:08, 256.33 examples/s]Tokenizing train dataset:  68%|██████▊   | 4540/6690 [00:16<00:08, 244.45 examples/s]Tokenizing train dataset:  66%|██████▌   | 4403/6690 [00:16<00:10, 223.69 examples/s]Tokenizing train dataset:  69%|██████▉   | 4638/6690 [00:16<00:08, 238.81 examples/s]Tokenizing train dataset:  69%|██████▊   | 4585/6690 [00:16<00:09, 230.70 examples/s]Tokenizing train dataset:  67%|██████▋   | 4450/6690 [00:16<00:09, 236.80 examples/s]Tokenizing train dataset:  70%|██████▉   | 4675/6690 [00:16<00:07, 262.28 examples/s]Tokenizing train dataset:  69%|██████▉   | 4635/6690 [00:16<00:08, 230.36 examples/s]Tokenizing train dataset:  67%|██████▋   | 4490/6690 [00:16<00:10, 208.06 examples/s]Tokenizing train dataset:  70%|██████▉   | 4661/6690 [00:16<00:09, 216.04 examples/s]Tokenizing train dataset:  71%|███████   | 4722/6690 [00:16<00:09, 201.95 examples/s]Tokenizing train dataset:  68%|██████▊   | 4527/6690 [00:16<00:09, 234.11 examples/s]Tokenizing train dataset:  70%|███████   | 4700/6690 [00:16<00:08, 246.53 examples/s]Tokenizing train dataset:  68%|██████▊   | 4557/6690 [00:17<00:08, 246.41 examples/s]Tokenizing train dataset:  71%|███████   | 4760/6690 [00:16<00:08, 229.64 examples/s]Tokenizing train dataset:  71%|███████   | 4728/6690 [00:16<00:07, 252.67 examples/s]Tokenizing train dataset:  69%|██████▊   | 4594/6690 [00:17<00:07, 273.31 examples/s]Tokenizing train dataset:  72%|███████▏  | 4791/6690 [00:16<00:07, 243.91 examples/s]Tokenizing train dataset:  71%|███████   | 4764/6690 [00:17<00:06, 275.63 examples/s]Tokenizing train dataset:  69%|██████▉   | 4641/6690 [00:17<00:06, 316.97 examples/s]Tokenizing train dataset:  72%|███████▏  | 4839/6690 [00:17<00:06, 292.95 examples/s]Tokenizing train dataset:  72%|███████▏  | 4795/6690 [00:17<00:06, 279.57 examples/s]Tokenizing train dataset:  70%|███████   | 4686/6690 [00:17<00:06, 304.84 examples/s]Tokenizing train dataset:  72%|███████▏  | 4825/6690 [00:17<00:06, 282.75 examples/s]Tokenizing train dataset:  73%|███████▎  | 4885/6690 [00:17<00:06, 284.77 examples/s]Tokenizing train dataset:  71%|███████   | 4734/6690 [00:17<00:09, 210.34 examples/s]Tokenizing train dataset:  73%|███████▎  | 4870/6690 [00:17<00:09, 191.14 examples/s]Tokenizing train dataset:  74%|███████▎  | 4928/6690 [00:17<00:08, 198.41 examples/s]Tokenizing train dataset:  71%|███████▏  | 4770/6690 [00:17<00:08, 235.06 examples/s]Tokenizing train dataset:  73%|███████▎  | 4906/6690 [00:17<00:08, 221.34 examples/s]Tokenizing train dataset:  74%|███████▍  | 4972/6690 [00:17<00:07, 235.70 examples/s]Tokenizing train dataset:  74%|███████▍  | 4935/6690 [00:17<00:07, 233.59 examples/s]Tokenizing train dataset:  75%|███████▍  | 5008/6690 [00:17<00:06, 258.79 examples/s]Tokenizing train dataset:  72%|███████▏  | 4819/6690 [00:18<00:07, 255.67 examples/s]Tokenizing train dataset:  74%|███████▍  | 4974/6690 [00:17<00:06, 266.54 examples/s]Tokenizing train dataset:  75%|███████▌  | 5046/6690 [00:17<00:05, 282.26 examples/s]Tokenizing train dataset:  73%|███████▎  | 4862/6690 [00:18<00:06, 289.08 examples/s]Tokenizing train dataset:  75%|███████▍  | 5010/6690 [00:18<00:05, 287.45 examples/s]Tokenizing train dataset:  73%|███████▎  | 4901/6690 [00:18<00:05, 307.50 examples/s]Tokenizing train dataset:  76%|███████▌  | 5098/6690 [00:18<00:05, 301.39 examples/s]Tokenizing train dataset:  75%|███████▌  | 5050/6690 [00:18<00:07, 228.21 examples/s]Tokenizing train dataset:  74%|███████▍  | 4942/6690 [00:18<00:06, 268.60 examples/s]Tokenizing train dataset:  77%|███████▋  | 5141/6690 [00:18<00:05, 265.50 examples/s]Tokenizing train dataset:  76%|███████▌  | 5090/6690 [00:18<00:06, 261.90 examples/s]Tokenizing train dataset:  74%|███████▍  | 4980/6690 [00:18<00:05, 288.31 examples/s]Tokenizing train dataset:  77%|███████▋  | 5184/6690 [00:18<00:05, 298.12 examples/s]Tokenizing train dataset:  75%|███████▍  | 5015/6690 [00:18<00:05, 300.34 examples/s]Tokenizing train dataset:  77%|███████▋  | 5140/6690 [00:18<00:05, 279.86 examples/s]Tokenizing train dataset:  78%|███████▊  | 5238/6690 [00:18<00:04, 314.57 examples/s]Tokenizing train dataset:  76%|███████▌  | 5056/6690 [00:18<00:06, 267.06 examples/s]Tokenizing train dataset:  78%|███████▊  | 5187/6690 [00:18<00:05, 286.98 examples/s]Tokenizing train dataset:  79%|███████▉  | 5287/6690 [00:18<00:04, 315.11 examples/s]Tokenizing train dataset:  76%|███████▌  | 5092/6690 [00:18<00:05, 285.95 examples/s]Tokenizing train dataset:  78%|███████▊  | 5227/6690 [00:18<00:04, 309.02 examples/s]Tokenizing train dataset:  80%|███████▉  | 5326/6690 [00:18<00:04, 328.29 examples/s]Tokenizing train dataset:  77%|███████▋  | 5130/6690 [00:19<00:05, 304.12 examples/s]Tokenizing train dataset:  79%|███████▊  | 5263/6690 [00:18<00:04, 318.51 examples/s]Tokenizing train dataset:  80%|████████  | 5380/6690 [00:18<00:04, 301.54 examples/s]Tokenizing train dataset:  77%|███████▋  | 5179/6690 [00:19<00:05, 296.30 examples/s]Tokenizing train dataset:  81%|████████  | 5421/6690 [00:19<00:03, 323.96 examples/s]Tokenizing train dataset:  79%|███████▉  | 5305/6690 [00:19<00:05, 260.93 examples/s]Tokenizing train dataset:  78%|███████▊  | 5214/6690 [00:19<00:04, 307.79 examples/s]Tokenizing train dataset:  82%|████████▏ | 5465/6690 [00:19<00:03, 346.87 examples/s]Tokenizing train dataset:  79%|███████▊  | 5253/6690 [00:19<00:04, 326.40 examples/s]Tokenizing train dataset:  80%|████████  | 5354/6690 [00:19<00:04, 276.03 examples/s]Tokenizing train dataset:  79%|███████▉  | 5288/6690 [00:19<00:04, 328.41 examples/s]Tokenizing train dataset:  83%|████████▎ | 5520/6690 [00:19<00:03, 348.50 examples/s]Tokenizing train dataset:  81%|████████  | 5400/6690 [00:19<00:04, 310.65 examples/s]Tokenizing train dataset:  80%|███████▉  | 5329/6690 [00:19<00:04, 287.26 examples/s]Tokenizing train dataset:  83%|████████▎ | 5566/6690 [00:19<00:03, 296.26 examples/s]Tokenizing train dataset:  81%|████████▏ | 5440/6690 [00:19<00:04, 259.01 examples/s]Tokenizing train dataset:  80%|████████  | 5360/6690 [00:19<00:04, 290.38 examples/s]Tokenizing train dataset:  84%|████████▎ | 5600/6690 [00:19<00:03, 303.79 examples/s]Tokenizing train dataset:  82%|████████▏ | 5474/6690 [00:19<00:04, 274.72 examples/s]Tokenizing train dataset:  81%|████████  | 5400/6690 [00:19<00:04, 315.18 examples/s]Tokenizing train dataset:  84%|████████▍ | 5643/6690 [00:19<00:03, 332.16 examples/s]Tokenizing train dataset:  82%|████████▏ | 5516/6690 [00:19<00:03, 306.11 examples/s]Tokenizing train dataset:  81%|████████▏ | 5437/6690 [00:20<00:03, 326.79 examples/s]Tokenizing train dataset:  85%|████████▌ | 5695/6690 [00:19<00:02, 333.56 examples/s]Tokenizing train dataset:  83%|████████▎ | 5556/6690 [00:20<00:03, 287.69 examples/s]Tokenizing train dataset:  82%|████████▏ | 5497/6690 [00:20<00:03, 345.63 examples/s]Tokenizing train dataset:  86%|████████▌ | 5750/6690 [00:20<00:02, 343.07 examples/s]Tokenizing train dataset:  84%|████████▍ | 5604/6690 [00:20<00:03, 295.72 examples/s]Tokenizing train dataset:  83%|████████▎ | 5543/6690 [00:20<00:03, 329.17 examples/s]Tokenizing train dataset:  84%|████████▍ | 5645/6690 [00:20<00:03, 318.37 examples/s]Tokenizing train dataset:  87%|████████▋ | 5804/6690 [00:20<00:02, 345.27 examples/s]Tokenizing train dataset:  84%|████████▎ | 5587/6690 [00:20<00:03, 315.03 examples/s]Tokenizing train dataset:  85%|████████▍ | 5684/6690 [00:20<00:03, 330.75 examples/s]Tokenizing train dataset:  87%|████████▋ | 5843/6690 [00:20<00:02, 302.07 examples/s]Tokenizing train dataset:  84%|████████▍ | 5642/6690 [00:20<00:03, 326.41 examples/s]Tokenizing train dataset:  86%|████████▌ | 5729/6690 [00:20<00:03, 269.15 examples/s]Tokenizing train dataset:  88%|████████▊ | 5890/6690 [00:20<00:04, 192.96 examples/s]Tokenizing train dataset:  85%|████████▍ | 5684/6690 [00:21<00:04, 204.10 examples/s]Tokenizing train dataset:  86%|████████▌ | 5770/6690 [00:20<00:04, 198.21 examples/s]Tokenizing train dataset:  89%|████████▊ | 5926/6690 [00:20<00:03, 217.39 examples/s]Tokenizing train dataset:  85%|████████▌ | 5714/6690 [00:21<00:04, 217.32 examples/s]Tokenizing train dataset:  87%|████████▋ | 5796/6690 [00:21<00:04, 206.98 examples/s]Tokenizing train dataset:  89%|████████▉ | 5967/6690 [00:21<00:02, 250.53 examples/s]Tokenizing train dataset:  86%|████████▌ | 5750/6690 [00:21<00:03, 242.24 examples/s]Tokenizing train dataset:  87%|████████▋ | 5822/6690 [00:21<00:04, 216.07 examples/s]Tokenizing train dataset:  90%|████████▉ | 6013/6690 [00:21<00:02, 254.44 examples/s]Tokenizing train dataset:  87%|████████▋ | 5791/6690 [00:21<00:03, 249.09 examples/s]Tokenizing train dataset:  88%|████████▊ | 5861/6690 [00:21<00:03, 227.72 examples/s]Tokenizing train dataset:  91%|█████████ | 6060/6690 [00:21<00:02, 259.40 examples/s]Tokenizing train dataset:  87%|████████▋ | 5831/6690 [00:21<00:03, 240.95 examples/s]Tokenizing train dataset:  88%|████████▊ | 5912/6690 [00:21<00:03, 249.44 examples/s]Tokenizing train dataset:  91%|█████████ | 6090/6690 [00:21<00:02, 262.89 examples/s]Tokenizing train dataset:  89%|████████▉ | 5951/6690 [00:21<00:02, 250.09 examples/s]Tokenizing train dataset:  88%|████████▊ | 5870/6690 [00:21<00:03, 242.13 examples/s]Tokenizing train dataset:  91%|█████████▏| 6120/6690 [00:21<00:02, 258.52 examples/s]Tokenizing train dataset:  89%|████████▉ | 5984/6690 [00:21<00:02, 266.33 examples/s]Tokenizing train dataset:  88%|████████▊ | 5915/6690 [00:21<00:02, 282.02 examples/s]Tokenizing train dataset:  92%|█████████▏| 6157/6690 [00:21<00:01, 281.96 examples/s]Tokenizing train dataset:  90%|████████▉ | 6019/6690 [00:21<00:02, 283.38 examples/s]Tokenizing train dataset:  89%|████████▉ | 5958/6690 [00:22<00:03, 210.24 examples/s]Tokenizing train dataset:  93%|█████████▎| 6200/6690 [00:22<00:02, 195.37 examples/s]Tokenizing train dataset:  91%|█████████ | 6061/6690 [00:22<00:03, 202.77 examples/s]Tokenizing train dataset:  90%|████████▉ | 6004/6690 [00:22<00:02, 232.03 examples/s]Tokenizing train dataset:  93%|█████████▎| 6231/6690 [00:22<00:02, 213.93 examples/s]Tokenizing train dataset:  91%|█████████ | 6095/6690 [00:22<00:02, 226.17 examples/s]Tokenizing train dataset:  90%|█████████ | 6038/6690 [00:22<00:02, 251.28 examples/s]Tokenizing train dataset:  94%|█████████▎| 6265/6690 [00:22<00:01, 237.63 examples/s]Tokenizing train dataset:  92%|█████████▏| 6134/6690 [00:22<00:02, 258.34 examples/s]Tokenizing train dataset:  91%|█████████ | 6081/6690 [00:22<00:02, 287.85 examples/s]Tokenizing train dataset:  94%|█████████▍| 6298/6690 [00:22<00:01, 257.42 examples/s]Tokenizing train dataset:  92%|█████████▏| 6185/6690 [00:22<00:01, 281.00 examples/s]Tokenizing train dataset:  95%|█████████▍| 6332/6690 [00:22<00:01, 275.26 examples/s]Tokenizing train dataset:  92%|█████████▏| 6133/6690 [00:22<00:01, 302.94 examples/s]Tokenizing train dataset:  93%|█████████▎| 6223/6690 [00:22<00:01, 266.07 examples/s]Tokenizing train dataset:  95%|█████████▌| 6375/6690 [00:22<00:01, 248.03 examples/s]Tokenizing train dataset:  92%|█████████▏| 6175/6690 [00:22<00:01, 261.90 examples/s]Tokenizing train dataset:  94%|█████████▍| 6273/6690 [00:22<00:01, 280.48 examples/s]Tokenizing train dataset:  96%|█████████▌| 6425/6690 [00:22<00:00, 268.92 examples/s]Tokenizing train dataset:  93%|█████████▎| 6216/6690 [00:23<00:01, 251.77 examples/s]Tokenizing train dataset:  94%|█████████▍| 6316/6690 [00:23<00:01, 268.33 examples/s]Tokenizing train dataset:  97%|█████████▋| 6470/6690 [00:23<00:00, 224.37 examples/s]Tokenizing train dataset:  93%|█████████▎| 6249/6690 [00:23<00:02, 208.29 examples/s]Tokenizing train dataset:  95%|█████████▍| 6353/6690 [00:23<00:01, 240.39 examples/s]Tokenizing train dataset:  97%|█████████▋| 6511/6690 [00:23<00:00, 257.20 examples/s]Tokenizing train dataset:  95%|█████████▌| 6385/6690 [00:23<00:01, 253.77 examples/s]Tokenizing train dataset:  94%|█████████▍| 6283/6690 [00:23<00:01, 231.57 examples/s]Tokenizing train dataset:  98%|█████████▊| 6546/6690 [00:23<00:00, 275.75 examples/s]Tokenizing train dataset:  94%|█████████▍| 6313/6690 [00:23<00:01, 241.36 examples/s]Tokenizing train dataset:  96%|█████████▌| 6431/6690 [00:23<00:00, 298.25 examples/s]Tokenizing train dataset:  98%|█████████▊| 6588/6690 [00:23<00:00, 306.79 examples/s]Tokenizing train dataset:  95%|█████████▍| 6347/6690 [00:23<00:01, 260.74 examples/s]Tokenizing train dataset:  97%|█████████▋| 6476/6690 [00:23<00:00, 294.92 examples/s]Tokenizing train dataset:  95%|█████████▌| 6377/6690 [00:23<00:01, 268.91 examples/s]Tokenizing train dataset:  99%|█████████▉| 6643/6690 [00:23<00:00, 322.87 examples/s]Tokenizing train dataset:  97%|█████████▋| 6508/6690 [00:23<00:00, 297.41 examples/s]Tokenizing train dataset: 100%|█████████▉| 6680/6690 [00:23<00:00, 331.72 examples/s]Tokenizing train dataset:  96%|█████████▌| 6430/6690 [00:23<00:00, 292.88 examples/s]Tokenizing train dataset:  98%|█████████▊| 6540/6690 [00:23<00:00, 299.96 examples/s]Tokenizing train dataset: 100%|██████████| 6690/6690 [00:23<00:00, 281.96 examples/s]
Tokenizing train dataset:  97%|█████████▋| 6468/6690 [00:23<00:00, 309.56 examples/s]Tokenizing train dataset:  98%|█████████▊| 6575/6690 [00:23<00:00, 311.34 examples/s]Tokenizing train dataset:  97%|█████████▋| 6508/6690 [00:24<00:00, 328.30 examples/s]Tokenizing train dataset:  99%|█████████▉| 6625/6690 [00:24<00:00, 315.40 examples/s]Tokenizing train dataset:  98%|█████████▊| 6550/6690 [00:24<00:00, 285.19 examples/s]Tokenizing train dataset: 100%|█████████▉| 6664/6690 [00:24<00:00, 253.40 examples/s]Tokenizing train dataset:  98%|█████████▊| 6586/6690 [00:24<00:00, 298.96 examples/s]Tokenizing train dataset: 100%|██████████| 6690/6690 [00:24<00:00, 274.16 examples/s]
Tokenizing train dataset:  99%|█████████▉| 6623/6690 [00:24<00:00, 265.00 examples/s]Tokenizing train dataset: 100%|█████████▉| 6663/6690 [00:24<00:00, 215.52 examples/s]Tokenizing train dataset: 100%|██████████| 6690/6690 [00:24<00:00, 268.50 examples/s]
Extracting prompt in eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Extracting prompt in eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Extracting prompt in eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
Extracting prompt in eval dataset:  58%|█████▊    | 550/953 [00:00<00:00, 5424.69 examples/s]Extracting prompt in eval dataset:  58%|█████▊    | 550/953 [00:00<00:00, 5377.24 examples/s]Extracting prompt in eval dataset:  57%|█████▋    | 540/953 [00:00<00:00, 5335.37 examples/s]/bin/sh: 1: scontrol: not found
Extracting prompt in eval dataset: 100%|██████████| 953/953 [00:00<00:00, 2648.25 examples/s]
Extracting prompt in eval dataset: 100%|██████████| 953/953 [00:00<00:00, 2684.78 examples/s]
[codecarbon WARNING @ 21:10:29] Error running `scontrol show job $SLURM_JOB_ID` to count SLURM-available cpus. Using the machine's cpu count.
Extracting prompt in eval dataset: 100%|██████████| 953/953 [00:00<00:00, 2659.50 examples/s][codecarbon INFO @ 21:10:29] [setup] RAM Tracking...

/bin/sh: 1: scontrol: not found
[codecarbon WARNING @ 21:10:29] Error running `scontrol show job $SLURM_JOB_ID` to retrieve SLURM-available RAM.Using the machine's total RAM.
[codecarbon INFO @ 21:10:29] [setup] CPU Tracking...
[codecarbon WARNING @ 21:10:29] No CPU tracking mode found. Falling back on CPU constant mode. 
 Linux OS detected: Please ensure RAPL files exist at \sys\class\powercap\intel-rapl to measure CPU

Applying chat template to eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Applying chat template to eval dataset:  33%|███▎      | 312/953 [00:00<00:00, 3089.44 examples/s]Applying chat template to eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Applying chat template to eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Applying chat template to eval dataset:  78%|███████▊  | 745/953 [00:00<00:00, 2948.18 examples/s]Applying chat template to eval dataset:  31%|███▏      | 298/953 [00:00<00:00, 2944.86 examples/s]Applying chat template to eval dataset:  32%|███▏      | 308/953 [00:00<00:00, 3032.58 examples/s]Applying chat template to eval dataset:  64%|██████▍   | 613/953 [00:00<00:00, 2138.87 examples/s]Applying chat template to eval dataset:  66%|██████▋   | 632/953 [00:00<00:00, 2377.79 examples/s]Applying chat template to eval dataset: 100%|██████████| 953/953 [00:00<00:00, 1605.94 examples/s]
Applying chat template to eval dataset:  97%|█████████▋| 927/953 [00:00<00:00, 1530.65 examples/s]Applying chat template to eval dataset: 100%|██████████| 953/953 [00:00<00:00, 1713.94 examples/s]Applying chat template to eval dataset: 100%|██████████| 953/953 [00:00<00:00, 1548.26 examples/s]
Applying chat template to eval dataset: 100%|██████████| 953/953 [00:00<00:00, 1752.35 examples/s]
[codecarbon INFO @ 21:10:30] CPU Model on constant consumption mode: AMD EPYC 7H12 64-Core Processor
Tokenizing eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s][codecarbon INFO @ 21:10:30] [setup] GPU Tracking...
[codecarbon INFO @ 21:10:30] Tracking Nvidia GPU via pynvml
[codecarbon INFO @ 21:10:30] >>> Tracker's metadata:
[codecarbon INFO @ 21:10:30]   Platform system: Linux-5.15.112-1.el8.vega.x86_64-x86_64-with-glibc2.35
Tokenizing eval dataset:   4%|▎         | 34/953 [00:00<00:02, 324.39 examples/s][codecarbon INFO @ 21:10:30]   Python version: 3.10.12
[codecarbon INFO @ 21:10:30]   CodeCarbon version: 2.8.3
[codecarbon INFO @ 21:10:30]   Available RAM : 503.683 GB
[codecarbon INFO @ 21:10:30]   CPU count: 256
[codecarbon INFO @ 21:10:30]   CPU model: AMD EPYC 7H12 64-Core Processor
[codecarbon INFO @ 21:10:30]   GPU count: 4
[codecarbon INFO @ 21:10:30]   GPU model: 4 x NVIDIA A100-SXM4-40GB BUT only tracking these GPU ids : [0, 1, 2, 3]
Tokenizing eval dataset:   8%|▊         | 80/953 [00:00<00:03, 229.44 examples/s]Tokenizing eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Tokenizing eval dataset:   0%|          | 0/953 [00:00<?, ? examples/s]Tokenizing eval dataset:  12%|█▏        | 118/953 [00:00<00:03, 236.36 examples/s]Tokenizing eval dataset:   3%|▎         | 30/953 [00:00<00:03, 283.80 examples/s]Tokenizing eval dataset:   3%|▎         | 30/953 [00:00<00:03, 287.68 examples/s]Tokenizing eval dataset:  16%|█▌        | 149/953 [00:00<00:03, 222.82 examples/s]Tokenizing eval dataset:   6%|▋         | 61/953 [00:00<00:04, 222.68 examples/s]Tokenizing eval dataset:  18%|█▊        | 175/953 [00:00<00:03, 198.87 examples/s]Tokenizing eval dataset:  10%|▉         | 91/953 [00:00<00:04, 199.28 examples/s]Tokenizing eval dataset:   7%|▋         | 68/953 [00:00<00:05, 166.70 examples/s]Tokenizing eval dataset:   9%|▉         | 90/953 [00:00<00:04, 176.82 examples/s]Tokenizing eval dataset:  21%|██▏       | 204/953 [00:00<00:03, 195.06 examples/s]Tokenizing eval dataset:  13%|█▎        | 121/953 [00:00<00:04, 193.56 examples/s]Tokenizing eval dataset:  12%|█▏        | 110/953 [00:00<00:04, 182.26 examples/s]Tokenizing eval dataset:  26%|██▋       | 252/953 [00:01<00:03, 216.88 examples/s]Tokenizing eval dataset:  30%|███       | 290/953 [00:01<00:03, 218.00 examples/s]Tokenizing eval dataset:  15%|█▌        | 147/953 [00:00<00:06, 127.10 examples/s]Tokenizing eval dataset:  14%|█▍        | 135/953 [00:00<00:06, 126.32 examples/s]Tokenizing eval dataset:  37%|███▋      | 349/953 [00:01<00:02, 295.57 examples/s]Tokenizing eval dataset:  18%|█▊        | 168/953 [00:01<00:05, 141.00 examples/s]Tokenizing eval dataset:  16%|█▋        | 156/953 [00:01<00:05, 141.91 examples/s]Tokenizing eval dataset:  41%|████▏     | 394/953 [00:01<00:01, 329.65 examples/s]Tokenizing eval dataset:  20%|██        | 195/953 [00:01<00:05, 149.20 examples/s]Tokenizing eval dataset:  19%|█▉        | 182/953 [00:01<00:05, 149.56 examples/s]Tokenizing eval dataset:  46%|████▌     | 440/953 [00:01<00:01, 359.75 examples/s]Tokenizing eval dataset:  24%|██▎       | 224/953 [00:01<00:04, 176.87 examples/s]Tokenizing eval dataset:  22%|██▏       | 205/953 [00:01<00:04, 164.20 examples/s]Tokenizing eval dataset:  53%|█████▎    | 505/953 [00:01<00:01, 431.07 examples/s]Tokenizing eval dataset:  27%|██▋       | 254/953 [00:01<00:04, 173.01 examples/s]Tokenizing eval dataset:  60%|█████▉    | 570/953 [00:01<00:01, 366.64 examples/s]Tokenizing eval dataset:  26%|██▌       | 250/953 [00:01<00:04, 173.85 examples/s]Tokenizing eval dataset:  32%|███▏      | 306/953 [00:01<00:02, 247.30 examples/s]Tokenizing eval dataset:  67%|██████▋   | 640/953 [00:02<00:00, 392.60 examples/s]Tokenizing eval dataset:  30%|██▉       | 284/953 [00:01<00:03, 181.10 examples/s]Tokenizing eval dataset:  36%|███▌      | 339/953 [00:01<00:02, 212.53 examples/s]Tokenizing eval dataset:  33%|███▎      | 313/953 [00:01<00:03, 201.15 examples/s]Tokenizing eval dataset:  74%|███████▍  | 707/953 [00:02<00:00, 406.38 examples/s]Tokenizing eval dataset:  38%|███▊      | 366/953 [00:01<00:03, 194.31 examples/s]Tokenizing eval dataset:  36%|███▋      | 346/953 [00:01<00:03, 195.93 examples/s]Tokenizing eval dataset:  44%|████▍     | 419/953 [00:02<00:02, 263.26 examples/s]Tokenizing eval dataset:  80%|████████  | 767/953 [00:02<00:00, 354.74 examples/s]Tokenizing eval dataset:  41%|████      | 389/953 [00:02<00:02, 245.24 examples/s]Tokenizing eval dataset:  50%|█████     | 478/953 [00:02<00:01, 337.56 examples/s]Tokenizing eval dataset:  45%|████▌     | 432/953 [00:02<00:01, 286.56 examples/s]Tokenizing eval dataset:  87%|████████▋ | 826/953 [00:02<00:00, 360.50 examples/s]Tokenizing eval dataset:  52%|█████▏    | 491/953 [00:02<00:01, 360.29 examples/s]Tokenizing eval dataset:  58%|█████▊    | 550/953 [00:02<00:01, 381.77 examples/s]Tokenizing eval dataset:  93%|█████████▎| 882/953 [00:02<00:00, 361.15 examples/s]Tokenizing eval dataset:  58%|█████▊    | 556/953 [00:02<00:01, 287.31 examples/s]Tokenizing eval dataset:  64%|██████▍   | 613/953 [00:02<00:01, 290.92 examples/s]Tokenizing eval dataset:  98%|█████████▊| 937/953 [00:03<00:00, 279.13 examples/s]Tokenizing eval dataset:  63%|██████▎   | 605/953 [00:02<00:01, 326.77 examples/s]Tokenizing eval dataset:  71%|███████   | 672/953 [00:02<00:00, 301.14 examples/s]Tokenizing eval dataset: 100%|██████████| 953/953 [00:03<00:00, 293.33 examples/s]
Tokenizing eval dataset:  69%|██████▉   | 660/953 [00:02<00:00, 310.21 examples/s]Tokenizing eval dataset:  76%|███████▌  | 725/953 [00:02<00:00, 340.24 examples/s]No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
[codecarbon INFO @ 21:10:34] Saving emissions data to file /ceph/hpc/data/s24o01-42-users/translation_optimization/trl/training_run/curriculum-2_r-64_lr-1e-06_b-0.1/emissions.csv
Set up DPO trainer
Tokenizing eval dataset:  75%|███████▌  | 715/953 [00:03<00:00, 287.40 examples/s]Tokenizing eval dataset:  82%|████████▏ | 779/953 [00:03<00:00, 300.66 examples/s]Tokenizing eval dataset:  81%|████████  | 774/953 [00:03<00:00, 311.61 examples/s]Tokenizing eval dataset:  87%|████████▋ | 826/953 [00:03<00:00, 294.82 examples/s]Tokenizing eval dataset:  85%|████████▍ | 810/953 [00:03<00:00, 316.75 examples/s]Tokenizing eval dataset:  91%|█████████ | 866/953 [00:03<00:00, 313.46 examples/s]Tokenizing eval dataset:  90%|████████▉ | 856/953 [00:03<00:00, 342.57 examples/s]Tokenizing eval dataset:  95%|█████████▌| 907/953 [00:03<00:00, 331.66 examples/s]Tokenizing eval dataset:  95%|█████████▍| 905/953 [00:03<00:00, 246.72 examples/s]Tokenizing eval dataset: 100%|██████████| 953/953 [00:03<00:00, 235.93 examples/s]Tokenizing eval dataset: 100%|██████████| 953/953 [00:03<00:00, 244.41 examples/s]
Tokenizing eval dataset:  98%|█████████▊| 936/953 [00:03<00:00, 256.35 examples/s]No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
Tokenizing eval dataset: 100%|██████████| 953/953 [00:04<00:00, 237.18 examples/s]
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
Installed CUDA version 12.1 does not match the version torch was compiled with 12.4 but since the APIs are compatible, accepting this combination
Using /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
Installed CUDA version 12.1 does not match the version torch was compiled with 12.4 but since the APIs are compatible, accepting this combinationEmitting ninja build file /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124/cpu_adam/build.ninja...

Using /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module cpu_adam...
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.914079427719116 seconds
Time to load cpu_adam op: 2.775757074356079 seconds
Installed CUDA version 12.1 does not match the version torch was compiled with 12.4 but since the APIs are compatible, accepting this combination
Using /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
Emitting ninja build file /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)Installed CUDA version 12.1 does not match the version torch was compiled with 12.4 but since the APIs are compatible, accepting this combination

Using /ceph/hpc/home/dv70648/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
ninja: no work to do.
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.7063488960266113 seconds
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.7004027366638184 seconds
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
500 response executing GraphQL.
{"error":"googleapi: Error 503: Visibility check was unavailable. Please retry the request and contact support if the problem persists, backendError"}
wandb: ERROR Error while calling W&B API: googleapi: Error 503: Visibility check was unavailable. Please retry the request and contact support if the problem persists, backendError (<Response [500]>)
wandb: Currently logged in as: vajdadario (slolama) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: creating run
/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
wandb: ERROR Run initialization has timed out after 90.0 sec. Please try increasing the timeout with the `init_timeout` setting: `wandb.init(settings=wandb.Settings(init_timeout=120))`.
Traceback (most recent call last):
  File "/usr/lib/python3.10/asyncio/locks.py", line 214, in wait
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/asyncio/tasks.py", line 456, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/handles.py", line 141, in wait_async
    await asyncio.wait_for(evt.wait(), timeout=timeout)
  File "/usr/lib/python3.10/asyncio/tasks.py", line 458, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 946, in init
    result = wait_with_progress(
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 23, in wait_with_progress
    return wait_all_with_progress(
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 86, in wait_all_with_progress
    return asyncio_compat.run(progress_loop_with_timeout)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 30, in run
    return future.result()
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 458, in result
    return self.__get_result()
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 74, in run
    return asyncio.run(self._run_or_cancel(fn))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 98, in _run_or_cancel
    return fn_task.result()
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 81, in progress_loop_with_timeout
    return await _wait_handles_async(
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 129, in _wait_handles_async
    async with asyncio_compat.open_task_group() as task_group:
  File "/usr/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 190, in open_task_group
    await task_group._wait_all()
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 159, in _wait_all
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 127, in wait_single
    results[index] = await handle.wait_async(timeout=timeout)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/handles.py", line 150, in wait_async
    raise TimeoutError(
TimeoutError: Timed out waiting for response on palf9wfwmq7b

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ceph/hpc/data/s24o01-42-users/translation_optimization/trl/train_curriculum.py", line 235, in <module>
    main(get_train_data(CURRICULUM_STAGE), val_data, args.rank, args.learning_rate, args.total_epochs, args.beta, CURRICULUM_STAGE)
  File "/ceph/hpc/data/s24o01-42-users/translation_optimization/trl/train_curriculum.py", line 211, in main
    dpo_trainer.train()
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2469, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer_callback.py", line 506, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer_callback.py", line 556, in call_event
    result = getattr(callback, event)(
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 930, in on_train_begin
    self.setup(args, state, model, **kwargs)
  File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 857, in setup
    self._wandb.init(
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 1485, in init
    wandb._sentry.reraise(e)
  File "/usr/local/lib/python3.10/dist-packages/wandb/analytics/sentry.py", line 156, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 1471, in init
    return wi.init(run_settings, run_config)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 959, in init
    raise CommError(
wandb.errors.errors.CommError: Run initialization has timed out after 90.0 sec. Please try increasing the timeout with the `init_timeout` setting: `wandb.init(settings=wandb.Settings(init_timeout=120))`.
[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/lib/python3.10/asyncio/locks.py", line 214, in wait
[rank0]:     await fut
[rank0]: asyncio.exceptions.CancelledError

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/lib/python3.10/asyncio/tasks.py", line 456, in wait_for
[rank0]:     return fut.result()
[rank0]: asyncio.exceptions.CancelledError

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/handles.py", line 141, in wait_async
[rank0]:     await asyncio.wait_for(evt.wait(), timeout=timeout)
[rank0]:   File "/usr/lib/python3.10/asyncio/tasks.py", line 458, in wait_for
[rank0]:     raise exceptions.TimeoutError() from exc
[rank0]: asyncio.exceptions.TimeoutError

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 946, in init
[rank0]:     result = wait_with_progress(
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 23, in wait_with_progress
[rank0]:     return wait_all_with_progress(
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 86, in wait_all_with_progress
[rank0]:     return asyncio_compat.run(progress_loop_with_timeout)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 30, in run
[rank0]:     return future.result()
[rank0]:   File "/usr/lib/python3.10/concurrent/futures/_base.py", line 458, in result
[rank0]:     return self.__get_result()
[rank0]:   File "/usr/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
[rank0]:     raise self._exception
[rank0]:   File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
[rank0]:     result = self.fn(*self.args, **self.kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 74, in run
[rank0]:     return asyncio.run(self._run_or_cancel(fn))
[rank0]:   File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
[rank0]:     return loop.run_until_complete(main)
[rank0]:   File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
[rank0]:     return future.result()
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 98, in _run_or_cancel
[rank0]:     return fn_task.result()
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 81, in progress_loop_with_timeout
[rank0]:     return await _wait_handles_async(
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 129, in _wait_handles_async
[rank0]:     async with asyncio_compat.open_task_group() as task_group:
[rank0]:   File "/usr/lib/python3.10/contextlib.py", line 206, in __aexit__
[rank0]:     await anext(self.gen)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 190, in open_task_group
[rank0]:     await task_group._wait_all()
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/asyncio_compat.py", line 159, in _wait_all
[rank0]:     raise exc
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/wait_with_progress.py", line 127, in wait_single
[rank0]:     results[index] = await handle.wait_async(timeout=timeout)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/mailbox/handles.py", line 150, in wait_async
[rank0]:     raise TimeoutError(
[rank0]: TimeoutError: Timed out waiting for response on palf9wfwmq7b

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/ceph/hpc/data/s24o01-42-users/translation_optimization/trl/train_curriculum.py", line 235, in <module>
[rank0]:     main(get_train_data(CURRICULUM_STAGE), val_data, args.rank, args.learning_rate, args.total_epochs, args.beta, CURRICULUM_STAGE)
[rank0]:   File "/ceph/hpc/data/s24o01-42-users/translation_optimization/trl/train_curriculum.py", line 211, in main
[rank0]:     dpo_trainer.train()
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2469, in _inner_training_loop
[rank0]:     self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer_callback.py", line 506, in on_train_begin
[rank0]:     return self.call_event("on_train_begin", args, state, control)
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/trainer_callback.py", line 556, in call_event
[rank0]:     result = getattr(callback, event)(
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 930, in on_train_begin
[rank0]:     self.setup(args, state, model, **kwargs)
[rank0]:   File "/ceph/hpc/home/dv70648/.local/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 857, in setup
[rank0]:     self._wandb.init(
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 1485, in init
[rank0]:     wandb._sentry.reraise(e)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/analytics/sentry.py", line 156, in reraise
[rank0]:     raise exc.with_traceback(sys.exc_info()[2])
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 1471, in init
[rank0]:     return wi.init(run_settings, run_config)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 959, in init
[rank0]:     raise CommError(
[rank0]: wandb.errors.errors.CommError: Run initialization has timed out after 90.0 sec. Please try increasing the timeout with the `init_timeout` setting: `wandb.init(settings=wandb.Settings(init_timeout=120))`.
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mCurriculum-2-DPO_r-64_lr-1e-06_e-3_b-0.1[0m at: [34m[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250612_211118-koeafl1m/logs[0m
[rank0]:[W612 21:12:49.400783894 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0612 21:12:53.313000 3245425 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3245610 closing signal SIGTERM
W0612 21:12:53.358000 3245425 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3245611 closing signal SIGTERM
W0612 21:12:53.374000 3245425 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3245612 closing signal SIGTERM
E0612 21:12:54.148000 3245425 torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 3245609) of binary: /usr/bin/python3
Traceback (most recent call last):
  File "/usr/local/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/usr/local/lib/python3.10/dist-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py", line 1182, in launch_command
    deepspeed_launcher(args)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/commands/launch.py", line 861, in deepspeed_launcher
    distrib_run.run(args)
  File "/usr/local/lib/python3.10/dist-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/usr/local/lib/python3.10/dist-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/usr/local/lib/python3.10/dist-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train_curriculum.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-12_21:12:53
  host      : pm5-nod00.vega.pri
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3245609)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
